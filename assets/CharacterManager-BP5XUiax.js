import{e as b,d as M,r as h,j as a,C as I,L as n}from"./index-DpMysQw2.js";import{T as m,a as x}from"./Textarea-D4OujlAH.js";function P({currentChat:r}){var o;const{t:c}=b(),{updateChat:p}=M(),[t,g]=h.useState({characterName:r.characterName??"",characterInitialPrompt:r.characterInitialPrompt??"",characterInitialMessage:((o=r.characterInitialMessage)==null?void 0:o.join(`

`))??"",characterImage:r.characterImage??"",backgroundImage:r.backgroundImage??""}),[d,l]=h.useState(!1);h.useEffect(()=>{var s;const e={characterName:r.characterName??"",characterInitialPrompt:r.characterInitialPrompt??"",characterInitialMessage:((s=r.characterInitialMessage)==null?void 0:s.join(`

`))??"",characterImage:r.characterImage??"",backgroundImage:r.backgroundImage??""};g(e),l(!1)},[r]);const i=(e,s)=>{g(v=>({...v,[e]:s})),l(!0)},j=async()=>{const e={characterName:t.characterName,characterInitialPrompt:t.characterInitialPrompt,characterInitialMessage:t.characterInitialMessage?t.characterInitialMessage.split(`

`).map(s=>s.trim()).filter(Boolean):void 0,characterImage:t.characterImage,backgroundImage:t.backgroundImage};await p(r.id,e),l(!1)},u=()=>{var e;g({characterName:r.characterName??"",characterInitialPrompt:r.characterInitialPrompt??"",characterInitialMessage:((e=r.characterInitialMessage)==null?void 0:e.join(`

`))??"",characterImage:r.characterImage??"",backgroundImage:r.backgroundImage??""}),l(!1)};return a.jsxs("div",{className:"space-y-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:c("characterManager.title")}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(I,{onClick:j,disabled:!d,children:c("common.save")}),d&&a.jsx(I,{variant:"gray",onClick:u,children:c("common.discard")})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterName",children:c("characterManager.characterName")}),a.jsx(m,{id:"characterName",type:"text",value:t.characterName,onChange:e=>i("characterName",e.target.value),placeholder:c("characterManager.characterNamePlaceholder")})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"backgroundImage",children:c("characterManager.backgroundImage")}),a.jsx(m,{id:"backgroundImage",type:"url",value:t.backgroundImage,onChange:e=>i("backgroundImage",e.target.value),placeholder:c("characterManager.backgroundImagePlaceholder")})]}),t.backgroundImage&&a.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:`${t.backgroundImage}?size=${new Date().getTime()}`,alt:c("characterManager.backgroundPreview"),className:"mx-auto h-42 w-auto object-cover rounded-lg"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:c("characterManager.backgroundPreview")})]})}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterImage",children:c("characterManager.characterImage")}),a.jsx(m,{id:"characterImage",type:"url",value:t.characterImage,onChange:e=>i("characterImage",e.target.value),placeholder:c("characterManager.characterImagePlaceholder")})]}),t.characterImage&&a.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:`${t.characterImage}?size=${new Date().getTime()}`,alt:t.characterName||"Character preview",className:"mx-auto h-42 w-auto object-cover rounded-lg"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:c("characterManager.characterPreview")})]})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterInitialPrompt",children:c("characterManager.initialPrompt")}),a.jsx(x,{id:"characterInitialPrompt",value:t.characterInitialPrompt,onChange:e=>i("characterInitialPrompt",e.target.value),placeholder:c("characterManager.initialPromptPlaceholder"),rows:7})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterInitialMessage",children:c("characterManager.initialMessage")}),a.jsx(x,{id:"characterInitialMessage",value:t.characterInitialMessage,onChange:e=>i("characterInitialMessage",e.target.value),placeholder:c("characterManager.initialMessagePlaceholder"),rows:7})]})]})]})]})}export{P as default};
