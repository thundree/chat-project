const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CharacterSelect-BKEZXnOf.js","assets/index-MtxQISxx.js","assets/index-VCnQzXPu.css","assets/AlertModal-NggDLZI1.js","assets/MessageList-iFxNbxM_.js","assets/ChatConfiguration-Ddk6zxZo.js"])))=>i.map(i=>d[i]);
var cl=Object.defineProperty;var dl=(t,e,n)=>e in t?cl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var so=(t,e,n)=>dl(t,typeof e!="symbol"?e+"":e,n);import{r as J,u as lr,a as ur,j as K,c as fl,b as hl,g as ro,t as Vt,D as xn,G as Pi,l as ml,d as pl,e as gl,C as $t,f as yl,_ as En}from"./index-MtxQISxx.js";const jn=J.forwardRef((t,e)=>{var r;const n=lr(),{title:i,...o}=ur(t,(r=n.props)==null?void 0:r.tabItem);return K.jsx("div",{ref:e,...o})});jn.displayName="TabItem";const _l=fl({base:"flex flex-col gap-2",tablist:{base:"flex text-center",variant:{default:"flex-wrap border-b border-gray-200 dark:border-gray-700",underline:"-mb-px flex-wrap border-b border-gray-200 dark:border-gray-700",pills:"flex-wrap space-x-2 text-sm font-medium text-gray-500 dark:text-gray-400",fullWidth:"grid w-full grid-flow-col divide-x divide-gray-200 rounded-none text-sm font-medium shadow dark:divide-gray-700 dark:text-gray-400"},tabitem:{base:"flex items-center justify-center rounded-t-lg p-4 text-sm font-medium first:ml-0 focus:outline-none disabled:cursor-not-allowed disabled:text-gray-400 disabled:dark:text-gray-500",variant:{default:{base:"rounded-t-lg",active:{on:"bg-gray-100 text-primary-600 dark:bg-gray-800 dark:text-primary-500",off:"text-gray-500 hover:bg-gray-50 hover:text-gray-600 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300"}},underline:{base:"rounded-t-lg",active:{on:"rounded-t-lg border-b-2 border-primary-600 text-primary-600 dark:border-primary-500 dark:text-primary-500",off:"border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300"}},pills:{base:"",active:{on:"rounded-lg bg-primary-600 text-white",off:"rounded-lg hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-white"}},fullWidth:{base:"ml-0 flex w-full rounded-none first:ml-0",active:{on:"rounded-none bg-gray-100 p-4 text-gray-900 dark:bg-gray-700 dark:text-white",off:"rounded-none bg-white hover:bg-gray-50 hover:text-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-white"}}},icon:"mr-2 h-5 w-5"}},tabitemcontainer:{base:"",variant:{default:"",underline:"",pills:"",fullWidth:""}},tabpanel:"py-3"}),cr=J.forwardRef((t,e)=>{var M,D;const n=lr(),i=hl([_l,(M=n.theme)==null?void 0:M.tabs,t.theme],[ro(n.clearTheme,"tabs"),t.clearTheme],[ro(n.applyTheme,"tabs"),t.applyTheme]),{children:o,className:r,onActiveTabChange:l,variant:u="default",...d}=ur(t,(D=n.props)==null?void 0:D.tabs),c=J.useId(),f=J.useMemo(()=>J.Children.map(J.Children.toArray(o),({props:A})=>A),[o]),h=J.useRef([]),[m,p]=J.useState(Math.max(0,f.findIndex(A=>A.active))),[g,y]=J.useState(-1);function v(A){p(A),l&&l(A)}function x({target:A}){v(A),y(A)}function C({event:A,target:U}){A.key==="ArrowLeft"&&y(Math.max(0,g-1)),A.key==="ArrowRight"&&y(Math.min(f.length-1,g+1)),A.key==="Enter"&&(v(U),y(U))}const w=i.tablist.tabitem.variant[u],T=i.tabitemcontainer.variant[u];return J.useEffect(()=>{var A;(A=h.current[g])==null||A.focus()},[g]),J.useImperativeHandle(e,()=>({setActiveTab:v})),K.jsxs("div",{className:Vt(i.base,r),children:[K.jsx("div",{"aria-label":"Tabs",role:"tablist",className:Vt(i.tablist.base,i.tablist.variant[u],r),...d,children:f.map((A,U)=>K.jsxs("button",{type:"button","aria-controls":`${c}-tabpanel-${U}`,"aria-selected":U===m,className:Vt(i.tablist.tabitem.base,w.base,U===m&&w.active.on,U!==m&&!A.disabled&&w.active.off),disabled:A.disabled,id:`${c}-tab-${U}`,onClick:()=>x({target:U}),onKeyDown:R=>C({event:R,target:U}),ref:R=>{h.current[U]=R},role:"tab",tabIndex:U===g?0:-1,style:{zIndex:U===g?2:1},children:[A.icon&&K.jsx(A.icon,{className:i.tablist.tabitem.icon}),A.title]},U))}),K.jsx("div",{className:Vt(i.tabitemcontainer.base,T),children:f.map((A,U)=>K.jsx("div",{"aria-labelledby":`${c}-tab-${U}`,className:i.tabpanel,hidden:U!==m,id:`${c}-tabpanel-${U}`,role:"tabpanel",tabIndex:0,children:A.children},U))})]})});cr.displayName="Tabs";function V(t,e,n,i,o){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function _(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)}let dr=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return dr=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^n()&15>>+i/4).toString(16))};function ei(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const ti=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class L extends Error{}class oe extends L{constructor(e,n,i,o){super(`${oe.makeMessage(e,n,i)}`),this.status=e,this.headers=o,this.requestID=o==null?void 0:o.get("x-request-id"),this.error=n;const r=n;this.code=r==null?void 0:r.code,this.param=r==null?void 0:r.param,this.type=r==null?void 0:r.type}static makeMessage(e,n,i){const o=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,i,o){if(!e||!o)return new In({message:i,cause:ti(n)});const r=n==null?void 0:n.error;return e===400?new fr(e,r,i,o):e===401?new hr(e,r,i,o):e===403?new mr(e,r,i,o):e===404?new pr(e,r,i,o):e===409?new gr(e,r,i,o):e===422?new yr(e,r,i,o):e===429?new _r(e,r,i,o):e>=500?new vr(e,r,i,o):new oe(e,r,i,o)}}class me extends oe{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class In extends oe{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class ki extends In{constructor({message:e}={}){super({message:e??"Request timed out."})}}class fr extends oe{}class hr extends oe{}class mr extends oe{}class pr extends oe{}class gr extends oe{}class yr extends oe{}class _r extends oe{}class vr extends oe{}class Cr extends L{constructor(){super("Could not parse response content as the length limit was reached")}}class Tr extends L{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}const vl=/^[a-z][a-z0-9+.-]*:/i,Cl=t=>vl.test(t);let ue=t=>(ue=Array.isArray,ue(t)),ao=ue;function Tl(t){return typeof t!="object"?{}:t??{}}function wl(t){if(!t)return!0;for(const e in t)return!1;return!0}function Sl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gn(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const Al=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new L(`${t} must be an integer`);if(e<0)throw new L(`${t} must be a positive integer`);return e},xl=t=>{try{return JSON.parse(t)}catch{return}},kt=t=>new Promise(e=>setTimeout(e,t)),Xe="5.5.1",El=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Il(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Ml=()=>{var n;const t=Il();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":uo(Deno.build.os),"X-Stainless-Arch":lo(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":uo(globalThis.process.platform??"unknown"),"X-Stainless-Arch":lo(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=Rl();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Rl(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const i=n.exec(navigator.userAgent);if(i){const o=i[1]||0,r=i[2]||0,l=i[3]||0;return{browser:e,version:`${o}.${r}.${l}`}}}return null}const lo=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",uo=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let co;const Pl=()=>co??(co=Ml());function kl(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function wr(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function Sr(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return wr({start(){},async pull(n){const{done:i,value:o}=await e.next();i?n.close():n.enqueue(o)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function Ar(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Nl(t){var i,o;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((o=(i=t[Symbol.asyncIterator]()).return)==null?void 0:o.call(i));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const bl=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),xr="RFC3986",Er=t=>String(t),fo={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:Er},Dl="RFC1738";let ni=(t,e)=>(ni=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),ni(t,e));const ve=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),qn=1024,Fl=(t,e,n,i,o)=>{if(t.length===0)return t;let r=t;if(typeof t=="symbol"?r=Symbol.prototype.toString.call(t):typeof t!="string"&&(r=String(t)),n==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});let l="";for(let u=0;u<r.length;u+=qn){const d=r.length>=qn?r.slice(u,u+qn):r,c=[];for(let f=0;f<d.length;++f){let h=d.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||o===Dl&&(h===40||h===41)){c[c.length]=d.charAt(f);continue}if(h<128){c[c.length]=ve[h];continue}if(h<2048){c[c.length]=ve[192|h>>6]+ve[128|h&63];continue}if(h<55296||h>=57344){c[c.length]=ve[224|h>>12]+ve[128|h>>6&63]+ve[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|d.charCodeAt(f)&1023),c[c.length]=ve[240|h>>18]+ve[128|h>>12&63]+ve[128|h>>6&63]+ve[128|h&63]}l+=c.join("")}return l};function Ll(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function ho(t,e){if(ue(t)){const n=[];for(let i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)}const Ir={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Mr=function(t,e){Array.prototype.push.apply(t,ue(e)?e:[e])};let mo;const te={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Fl,encodeValuesOnly:!1,format:xr,formatter:Er,indices:!1,serializeDate(t){return(mo??(mo=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function Ul(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Jn={};function Rr(t,e,n,i,o,r,l,u,d,c,f,h,m,p,g,y,v,x){let C=t,w=x,T=0,M=!1;for(;(w=w.get(Jn))!==void 0&&!M;){const N=w.get(t);if(T+=1,typeof N<"u"){if(N===T)throw new RangeError("Cyclic object value");M=!0}typeof w.get(Jn)>"u"&&(T=0)}if(typeof c=="function"?C=c(e,C):C instanceof Date?C=m==null?void 0:m(C):n==="comma"&&ue(C)&&(C=ho(C,function(N){return N instanceof Date?m==null?void 0:m(N):N})),C===null){if(r)return d&&!y?d(e,te.encoder,v,"key",p):e;C=""}if(Ul(C)||Ll(C)){if(d){const N=y?e:d(e,te.encoder,v,"key",p);return[(g==null?void 0:g(N))+"="+(g==null?void 0:g(d(C,te.encoder,v,"value",p)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(C)))]}const D=[];if(typeof C>"u")return D;let A;if(n==="comma"&&ue(C))y&&d&&(C=ho(C,d)),A=[{value:C.length>0?C.join(",")||null:void 0}];else if(ue(c))A=c;else{const N=Object.keys(C);A=f?N.sort(f):N}const U=u?String(e).replace(/\./g,"%2E"):String(e),R=i&&ue(C)&&C.length===1?U+"[]":U;if(o&&ue(C)&&C.length===0)return R+"[]";for(let N=0;N<A.length;++N){const O=A[N],ge=typeof O=="object"&&typeof O.value<"u"?O.value:C[O];if(l&&ge===null)continue;const Pe=h&&u?O.replace(/\./g,"%2E"):O,ce=ue(C)?typeof n=="function"?n(R,Pe):R:R+(h?"."+Pe:"["+Pe+"]");x.set(t,T);const ke=new WeakMap;ke.set(Jn,x),Mr(D,Rr(ge,ce,n,i,o,r,l,u,n==="comma"&&y&&ue(C)?null:d,c,f,h,m,p,g,y,v,ke))}return D}function Vl(t=te){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||te.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=xr;if(typeof t.format<"u"){if(!ni(fo,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const i=fo[n];let o=te.filter;(typeof t.filter=="function"||ue(t.filter))&&(o=t.filter);let r;if(t.arrayFormat&&t.arrayFormat in Ir?r=t.arrayFormat:"indices"in t?r=t.indices?"indices":"repeat":r=te.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const l=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:te.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:te.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:te.allowEmptyArrays,arrayFormat:r,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:te.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?te.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:te.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:te.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:te.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:te.encodeValuesOnly,filter:o,format:n,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:te.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:te.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:te.strictNullHandling}}function $l(t,e={}){let n=t;const i=Vl(e);let o,r;typeof i.filter=="function"?(r=i.filter,n=r("",n)):ue(i.filter)&&(r=i.filter,o=r);const l=[];if(typeof n!="object"||n===null)return"";const u=Ir[i.arrayFormat],d=u==="comma"&&i.commaRoundTrip;o||(o=Object.keys(n)),i.sort&&o.sort(i.sort);const c=new WeakMap;for(let m=0;m<o.length;++m){const p=o[m];i.skipNulls&&n[p]===null||Mr(l,Rr(n[p],p,u,d,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}const f=l.join(i.delimiter);let h=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),f.length>0?h+f:""}function Bl(t){let e=0;for(const o of t)e+=o.length;const n=new Uint8Array(e);let i=0;for(const o of t)n.set(o,i),i+=o.length;return n}let po;function Ni(t){let e;return(po??(e=new globalThis.TextEncoder,po=e.encode.bind(e)))(t)}let go;function yo(t){let e;return(go??(e=new globalThis.TextDecoder,go=e.decode.bind(e)))(t)}var de,fe;class Mn{constructor(){de.set(this,void 0),fe.set(this,void 0),V(this,de,new Uint8Array),V(this,fe,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Ni(e):e;V(this,de,Bl([_(this,de,"f"),n]));const i=[];let o;for(;(o=Ol(_(this,de,"f"),_(this,fe,"f")))!=null;){if(o.carriage&&_(this,fe,"f")==null){V(this,fe,o.index);continue}if(_(this,fe,"f")!=null&&(o.index!==_(this,fe,"f")+1||o.carriage)){i.push(yo(_(this,de,"f").subarray(0,_(this,fe,"f")-1))),V(this,de,_(this,de,"f").subarray(_(this,fe,"f"))),V(this,fe,null);continue}const r=_(this,fe,"f")!==null?o.preceding-1:o.preceding,l=yo(_(this,de,"f").subarray(0,r));i.push(l),V(this,de,_(this,de,"f").subarray(o.index)),V(this,fe,null)}return i}flush(){return _(this,de,"f").length?this.decode(`
`):[]}}de=new WeakMap,fe=new WeakMap;Mn.NEWLINE_CHARS=new Set([`
`,"\r"]);Mn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Ol(t,e){for(let o=e??0;o<t.length;o++){if(t[o]===10)return{preceding:o,index:o+1,carriage:!1};if(t[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function Gl(t){for(let i=0;i<t.length-1;i++){if(t[i]===10&&t[i+1]===10||t[i]===13&&t[i+1]===13)return i+2;if(t[i]===13&&t[i+1]===10&&i+3<t.length&&t[i+2]===13&&t[i+3]===10)return i+4}return-1}class Te{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let i=!1;async function*o(){if(i)throw new L("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let r=!1;try{for await(const l of ql(e,n))if(!r){if(l.data.startsWith("[DONE]")){r=!0;continue}if(l.event===null||l.event.startsWith("response.")||l.event.startsWith("transcript.")){let u;try{u=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(u&&u.error)throw new oe(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(l.event=="error")throw new oe(void 0,u.error,u.message,void 0);yield{event:l.event,data:u}}}r=!0}catch(l){if(ei(l))return;throw l}finally{r||n.abort()}}return new Te(o,n)}static fromReadableStream(e,n){let i=!1;async function*o(){const l=new Mn,u=Ar(e);for await(const d of u)for(const c of l.decode(d))yield c;for(const d of l.flush())yield d}async function*r(){if(i)throw new L("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let l=!1;try{for await(const u of o())l||u&&(yield JSON.parse(u));l=!0}catch(u){if(ei(u))return;throw u}finally{l||n.abort()}}return new Te(r,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],i=this.iterator(),o=r=>({next:()=>{if(r.length===0){const l=i.next();e.push(l),n.push(l)}return r.shift()}});return[new Te(()=>o(e),this.controller),new Te(()=>o(n),this.controller)]}toReadableStream(){const e=this;let n;return wr({async start(){n=e[Symbol.asyncIterator]()},async pull(i){try{const{value:o,done:r}=await n.next();if(r)return i.close();const l=Ni(JSON.stringify(o)+`
`);i.enqueue(l)}catch(o){i.error(o)}},async cancel(){var i;await((i=n.return)==null?void 0:i.call(n))}})}}async function*ql(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new L("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new L("Attempted to iterate over a response with no body");const n=new Hl,i=new Mn,o=Ar(t.body);for await(const r of Jl(o))for(const l of i.decode(r)){const u=n.decode(l);u&&(yield u)}for(const r of i.flush()){const l=n.decode(r);l&&(yield l)}}async function*Jl(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const i=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Ni(n):n;let o=new Uint8Array(e.length+i.length);o.set(e),o.set(i,e.length),e=o;let r;for(;(r=Gl(e))!==-1;)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}class Hl{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,i,o]=Wl(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function Wl(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const un={off:0,error:200,warn:300,info:400,debug:500},_o=(t,e,n)=>{if(t){if(Sl(un,t))return t;se(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(un))}`)}};function pt(){}function Bt(t,e,n){return!e||un[t]>un[n]?pt:e[t].bind(e)}const Kl={error:pt,warn:pt,info:pt,debug:pt};let vo=new WeakMap;function se(t){const e=t.logger,n=t.logLevel??"off";if(!e)return Kl;const i=vo.get(e);if(i&&i[0]===n)return i[1];const o={error:Bt("error",e,n),warn:Bt("warn",e,n),info:Bt("info",e,n),debug:Bt("debug",e,n)};return vo.set(e,[n,o]),o}const Be=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);async function Pr(t,e){const{response:n,requestLogID:i,retryOfRequestLogID:o,startTime:r}=e,l=await(async()=>{var h;if(e.options.stream)return se(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller):Te.fromSSEResponse(n,e.controller);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const u=n.headers.get("content-type"),d=(h=u==null?void 0:u.split(";")[0])==null?void 0:h.trim();if((d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))){const m=await n.json();return kr(m,n)}return await n.text()})();return se(t).debug(`[${i}] response parsed`,Be({retryOfRequestLogID:o,url:n.url,status:n.status,body:l,durationMs:Date.now()-r})),l}function kr(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var gt;class Rn extends Promise{constructor(e,n,i=Pr){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=i,gt.set(this,void 0),V(this,gt,e)}_thenUnwrap(e){return new Rn(_(this,gt,"f"),this.responsePromise,async(n,i)=>kr(e(await this.parseResponse(n,i),i),i.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(_(this,gt,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}gt=new WeakMap;var Ot;class Nr{constructor(e,n,i,o){Ot.set(this,void 0),V(this,Ot,e),this.options=o,this.response=n,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new L("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await _(this,Ot,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ot=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Yl extends Rn{constructor(e,n,i){super(e,n,async(o,r)=>new i(o,r.response,await Pr(o,r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class Pn extends Nr{constructor(e,n,i,o){super(e,n,i,o),this.data=i.data||[],this.object=i.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Q extends Nr{constructor(e,n,i,o){super(e,n,i,o),this.data=i.data||[],this.has_more=i.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var i;const e=this.getPaginatedItems(),n=(i=e[e.length-1])==null?void 0:i.id;return n?{...this.options,query:{...Tl(this.options.query),after:n}}:null}}const br=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function xt(t,e,n){return br(),new File(t,e??"unknown_file",n)}function Zt(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Dr=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Je=async(t,e)=>({...t,body:await zl(t.body,e)}),Co=new WeakMap;function Zl(t){const e=typeof t=="function"?t:t.fetch,n=Co.get(e);if(n)return n;const i=(async()=>{try{const o="Response"in e?e.Response:(await e("data:,")).constructor,r=new FormData;return r.toString()!==await new o(r).text()}catch{return!0}})();return Co.set(e,i),i}const zl=async(t,e)=>{if(!await Zl(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([i,o])=>ii(n,i,o))),n},Xl=t=>t instanceof Blob&&"name"in t,ii=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,xt([await n.blob()],Zt(n)));else if(Dr(n))t.append(e,xt([await new Response(Sr(n)).blob()],Zt(n)));else if(Xl(n))t.append(e,n,Zt(n));else if(Array.isArray(n))await Promise.all(n.map(i=>ii(t,e+"[]",i)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([i,o])=>ii(t,`${e}[${i}]`,o)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},Fr=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Ql=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Fr(t),jl=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function eu(t,e,n){if(br(),t=await t,Ql(t))return t instanceof File?t:xt([await t.arrayBuffer()],t.name);if(jl(t)){const o=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),xt(await oi(o),e,n)}const i=await oi(t);if(e||(e=Zt(t)),!(n!=null&&n.type)){const o=i.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof o=="string"&&(n={...n,type:o})}return xt(i,e,n)}async function oi(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Fr(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(Dr(t))for await(const i of t)e.push(...await oi(i));else{const i=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${i?`; constructor: ${i}`:""}${tu(t)}`)}return e}function tu(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class B{constructor(e){this._client=e}}function Lr(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const nu=(t=Lr)=>function(n,...i){if(n.length===1)return n[0];let o=!1;const r=n.reduce((f,h,m)=>(/[?#]/.test(h)&&(o=!0),f+h+(m===i.length?"":(o?encodeURIComponent:t)(String(i[m])))),""),l=r.split(/[?#]/,1)[0],u=[],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=d.exec(l))!==null;)u.push({start:c.index,length:c[0].length});if(u.length>0){let f=0;const h=u.reduce((m,p)=>{const g=" ".repeat(p.start-f),y="^".repeat(p.length);return f=p.start+p.length,m+g+y},"");throw new L(`Path parameters result in path with invalid segments:
${r}
${h}`)}return r},E=nu(Lr);let Ur=class extends B{list(e,n={},i){return this._client.getAPIList(E`/chat/completions/${e}/messages`,Q,{query:n,...i})}};function iu(t){return typeof t.parse=="function"}const cn=t=>(t==null?void 0:t.role)==="assistant",Vr=t=>(t==null?void 0:t.role)==="tool";var si,zt,Xt,yt,_t,Qt,vt,Ie,Ct,dn,fn,Qe,$r;class bi{constructor(){si.add(this),this.controller=new AbortController,zt.set(this,void 0),Xt.set(this,()=>{}),yt.set(this,()=>{}),_t.set(this,void 0),Qt.set(this,()=>{}),vt.set(this,()=>{}),Ie.set(this,{}),Ct.set(this,!1),dn.set(this,!1),fn.set(this,!1),Qe.set(this,!1),V(this,zt,new Promise((e,n)=>{V(this,Xt,e,"f"),V(this,yt,n,"f")})),V(this,_t,new Promise((e,n)=>{V(this,Qt,e,"f"),V(this,vt,n,"f")})),_(this,zt,"f").catch(()=>{}),_(this,_t,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},_(this,si,"m",$r).bind(this))},0)}_connected(){this.ended||(_(this,Xt,"f").call(this),this._emit("connect"))}get ended(){return _(this,Ct,"f")}get errored(){return _(this,dn,"f")}get aborted(){return _(this,fn,"f")}abort(){this.controller.abort()}on(e,n){return(_(this,Ie,"f")[e]||(_(this,Ie,"f")[e]=[])).push({listener:n}),this}off(e,n){const i=_(this,Ie,"f")[e];if(!i)return this;const o=i.findIndex(r=>r.listener===n);return o>=0&&i.splice(o,1),this}once(e,n){return(_(this,Ie,"f")[e]||(_(this,Ie,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,i)=>{V(this,Qe,!0),e!=="error"&&this.once("error",i),this.once(e,n)})}async done(){V(this,Qe,!0),await _(this,_t,"f")}_emit(e,...n){if(_(this,Ct,"f"))return;e==="end"&&(V(this,Ct,!0),_(this,Qt,"f").call(this));const i=_(this,Ie,"f")[e];if(i&&(_(this,Ie,"f")[e]=i.filter(o=>!o.once),i.forEach(({listener:o})=>o(...n))),e==="abort"){const o=n[0];!_(this,Qe,"f")&&!(i!=null&&i.length)&&Promise.reject(o),_(this,yt,"f").call(this,o),_(this,vt,"f").call(this,o),this._emit("end");return}if(e==="error"){const o=n[0];!_(this,Qe,"f")&&!(i!=null&&i.length)&&Promise.reject(o),_(this,yt,"f").call(this,o),_(this,vt,"f").call(this,o),this._emit("end")}}_emitFinal(){}}zt=new WeakMap,Xt=new WeakMap,yt=new WeakMap,_t=new WeakMap,Qt=new WeakMap,vt=new WeakMap,Ie=new WeakMap,Ct=new WeakMap,dn=new WeakMap,fn=new WeakMap,Qe=new WeakMap,si=new WeakSet,$r=function(e){if(V(this,dn,!0),e instanceof Error&&e.name==="AbortError"&&(e=new me),e instanceof me)return V(this,fn,!0),this._emit("abort",e);if(e instanceof L)return this._emit("error",e);if(e instanceof Error){const n=new L(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new L(String(e)))};function Di(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Nt(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function ou(t,e){return!e||!Br(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Fi(t,e)}function Fi(t,e){const n=t.choices.map(i=>{var o;if(i.finish_reason==="length")throw new Cr;if(i.finish_reason==="content_filter")throw new Tr;return{...i,message:{...i.message,...i.message.tool_calls?{tool_calls:((o=i.message.tool_calls)==null?void 0:o.map(r=>ru(e,r)))??void 0}:void 0,parsed:i.message.content&&!i.message.refusal?su(e,i.message.content):null}}});return{...t,choices:n}}function su(t,e){var n,i;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((i=t.response_format)==null?void 0:i.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function ru(t,e){var i;const n=(i=t.tools)==null?void 0:i.find(o=>{var r;return((r=o.function)==null?void 0:r.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Nt(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function au(t,e){var i;if(!t)return!1;const n=(i=t.tools)==null?void 0:i.find(o=>{var r;return((r=o.function)==null?void 0:r.name)===e.function.name});return Nt(n)||(n==null?void 0:n.function.strict)||!1}function Br(t){var e;return Di(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Nt(n)||n.type==="function"&&n.function.strict===!0))??!1}function lu(t){for(const e of t??[]){if(e.type!=="function")throw new L(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new L(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var re,ri,hn,ai,li,ui,Or,Gr;const uu=10;class qr extends bi{constructor(){super(...arguments),re.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var i;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(i=e.choices[0])==null?void 0:i.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),Vr(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(cn(e)&&e.tool_calls)for(const i of e.tool_calls)i.type==="function"&&this._emit("functionToolCall",i.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new L("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),_(this,re,"m",ri).call(this)}async finalMessage(){return await this.done(),_(this,re,"m",hn).call(this)}async finalFunctionToolCall(){return await this.done(),_(this,re,"m",ai).call(this)}async finalFunctionToolCallResult(){return await this.done(),_(this,re,"m",li).call(this)}async totalUsage(){return await this.done(),_(this,re,"m",ui).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=_(this,re,"m",hn).call(this);n&&this._emit("finalMessage",n);const i=_(this,re,"m",ri).call(this);i&&this._emit("finalContent",i);const o=_(this,re,"m",ai).call(this);o&&this._emit("finalFunctionToolCall",o);const r=_(this,re,"m",li).call(this);r!=null&&this._emit("finalFunctionToolCallResult",r),this._chatCompletions.some(l=>l.usage)&&this._emit("totalUsage",_(this,re,"m",ui).call(this))}async _createChatCompletion(e,n,i){const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),_(this,re,"m",Or).call(this,n);const r=await e.chat.completions.create({...n,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Fi(r,n))}async _runChatCompletion(e,n,i){for(const o of n.messages)this._addMessage(o,!1);return await this._createChatCompletion(e,n,i)}async _runTools(e,n,i){var p,g,y;const o="tool",{tool_choice:r="auto",stream:l,...u}=n,d=typeof r!="string"&&((p=r==null?void 0:r.function)==null?void 0:p.name),{maxChatCompletions:c=uu}=i||{},f=n.tools.map(v=>{if(Nt(v)){if(!v.$callback)throw new L("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),h={};for(const v of f)v.type==="function"&&(h[v.function.name||v.function.function.name]=v.function);const m="tools"in n?f.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<c;++v){const C=(g=(await this._createChatCompletion(e,{...u,tool_choice:r,tools:m,messages:[...this.messages]},i)).choices[0])==null?void 0:g.message;if(!C)throw new L("missing message in ChatCompletion response");if(!((y=C.tool_calls)!=null&&y.length))return;for(const w of C.tool_calls){if(w.type!=="function")continue;const T=w.id,{name:M,arguments:D}=w.function,A=h[M];if(A){if(d&&d!==M){const O=`Invalid tool_call: ${JSON.stringify(M)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:o,tool_call_id:T,content:O});continue}}else{const O=`Invalid tool_call: ${JSON.stringify(M)}. Available options are: ${Object.keys(h).map(ge=>JSON.stringify(ge)).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:T,content:O});continue}let U;try{U=iu(A)?await A.parse(D):D}catch(O){const ge=O instanceof Error?O.message:String(O);this._addMessage({role:o,tool_call_id:T,content:ge});continue}const R=await A.function(U,this),N=_(this,re,"m",Gr).call(this,R);if(this._addMessage({role:o,tool_call_id:T,content:N}),d)return}}}}re=new WeakSet,ri=function(){return _(this,re,"m",hn).call(this).content??null},hn=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(cn(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new L("stream ended without producing a ChatCompletionMessage with role=assistant")},ai=function(){var e,n;for(let i=this.messages.length-1;i>=0;i--){const o=this.messages[i];if(cn(o)&&((e=o==null?void 0:o.tool_calls)!=null&&e.length))return(n=o.tool_calls.at(-1))==null?void 0:n.function}},li=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(Vr(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(i=>{var o;return i.role==="assistant"&&((o=i.tool_calls)==null?void 0:o.some(r=>r.type==="function"&&r.id===n.tool_call_id))}))return n.content}},ui=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Or=function(e){if(e.n!=null&&e.n>1)throw new L("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Gr=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Li extends qr{static runTools(e,n,i){const o=new Li,r={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(e,n,r)),o}_addMessage(e,n=!0){super._addMessage(e,n),cn(e)&&e.content&&this._emit("content",e.content)}}const Jr=1,Hr=2,Wr=4,Kr=8,Yr=16,Zr=32,zr=64,Xr=128,Qr=256,jr=Xr|Qr,ea=Yr|Zr|jr|zr,ta=Jr|Hr|ea,na=Wr|Kr,cu=ta|na,ne={STR:Jr,NUM:Hr,ARR:Wr,OBJ:Kr,NULL:Yr,BOOL:Zr,NAN:zr,INFINITY:Xr,MINUS_INFINITY:Qr,INF:jr,SPECIAL:ea,ATOM:ta,COLLECTION:na,ALL:cu};class du extends Error{}class fu extends Error{}function hu(t,e=ne.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return mu(t.trim(),e)}const mu=(t,e)=>{const n=t.length;let i=0;const o=m=>{throw new du(`${m} at position ${i}`)},r=m=>{throw new fu(`${m} at position ${i}`)},l=()=>(h(),i>=n&&o("Unexpected end of input"),t[i]==='"'?u():t[i]==="{"?d():t[i]==="["?c():t.substring(i,i+4)==="null"||ne.NULL&e&&n-i<4&&"null".startsWith(t.substring(i))?(i+=4,null):t.substring(i,i+4)==="true"||ne.BOOL&e&&n-i<4&&"true".startsWith(t.substring(i))?(i+=4,!0):t.substring(i,i+5)==="false"||ne.BOOL&e&&n-i<5&&"false".startsWith(t.substring(i))?(i+=5,!1):t.substring(i,i+8)==="Infinity"||ne.INFINITY&e&&n-i<8&&"Infinity".startsWith(t.substring(i))?(i+=8,1/0):t.substring(i,i+9)==="-Infinity"||ne.MINUS_INFINITY&e&&1<n-i&&n-i<9&&"-Infinity".startsWith(t.substring(i))?(i+=9,-1/0):t.substring(i,i+3)==="NaN"||ne.NAN&e&&n-i<3&&"NaN".startsWith(t.substring(i))?(i+=3,NaN):f()),u=()=>{const m=i;let p=!1;for(i++;i<n&&(t[i]!=='"'||p&&t[i-1]==="\\");)p=t[i]==="\\"?!p:!1,i++;if(t.charAt(i)=='"')try{return JSON.parse(t.substring(m,++i-Number(p)))}catch(g){r(String(g))}else if(ne.STR&e)try{return JSON.parse(t.substring(m,i-Number(p))+'"')}catch{return JSON.parse(t.substring(m,t.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},d=()=>{i++,h();const m={};try{for(;t[i]!=="}";){if(h(),i>=n&&ne.OBJ&e)return m;const p=u();h(),i++;try{const g=l();Object.defineProperty(m,p,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(ne.OBJ&e)return m;throw g}h(),t[i]===","&&i++}}catch{if(ne.OBJ&e)return m;o("Expected '}' at end of object")}return i++,m},c=()=>{i++;const m=[];try{for(;t[i]!=="]";)m.push(l()),h(),t[i]===","&&i++}catch{if(ne.ARR&e)return m;o("Expected ']' at end of array")}return i++,m},f=()=>{if(i===0){t==="-"&&ne.NUM&e&&o("Not sure what '-' is");try{return JSON.parse(t)}catch(p){if(ne.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}r(String(p))}}const m=i;for(t[i]==="-"&&i++;t[i]&&!",]}".includes(t[i]);)i++;i==n&&!(ne.NUM&e)&&o("Unterminated number literal");try{return JSON.parse(t.substring(m,i))}catch{t.substring(m,i)==="-"&&ne.NUM&e&&o("Not sure what '-' is");try{return JSON.parse(t.substring(m,t.lastIndexOf("e")))}catch(g){r(String(g))}}},h=()=>{for(;i<n&&` 
\r	`.includes(t[i]);)i++};return l()},To=t=>hu(t,ne.ALL^ne.NUM);var ee,Ee,Ye,Ne,Hn,Gt,Wn,Kn,Yn,qt,Zn,wo;class Rt extends qr{constructor(e){super(),ee.add(this),Ee.set(this,void 0),Ye.set(this,void 0),Ne.set(this,void 0),V(this,Ee,e),V(this,Ye,[])}get currentChatCompletionSnapshot(){return _(this,Ne,"f")}static fromReadableStream(e){const n=new Rt(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,i){const o=new Rt(n);return o._run(()=>o._runChatCompletion(e,{...n,stream:!0},{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createChatCompletion(e,n,i){var l;super._createChatCompletion;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),_(this,ee,"m",Hn).call(this);const r=await e.chat.completions.create({...n,stream:!0},{...i,signal:this.controller.signal});this._connected();for await(const u of r)_(this,ee,"m",Wn).call(this,u);if((l=r.controller.signal)!=null&&l.aborted)throw new me;return this._addChatCompletion(_(this,ee,"m",qt).call(this))}async _fromReadableStream(e,n){var l;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),_(this,ee,"m",Hn).call(this),this._connected();const o=Te.fromReadableStream(e,this.controller);let r;for await(const u of o)r&&r!==u.id&&this._addChatCompletion(_(this,ee,"m",qt).call(this)),_(this,ee,"m",Wn).call(this,u),r=u.id;if((l=o.controller.signal)!=null&&l.aborted)throw new me;return this._addChatCompletion(_(this,ee,"m",qt).call(this))}[(Ee=new WeakMap,Ye=new WeakMap,Ne=new WeakMap,ee=new WeakSet,Hn=function(){this.ended||V(this,Ne,void 0)},Gt=function(n){let i=_(this,Ye,"f")[n.index];return i||(i={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},_(this,Ye,"f")[n.index]=i,i)},Wn=function(n){var o,r,l,u,d,c,f,h,m,p,g,y,v,x,C;if(this.ended)return;const i=_(this,ee,"m",wo).call(this,n);this._emit("chunk",n,i);for(const w of n.choices){const T=i.choices[w.index];w.delta.content!=null&&((o=T.message)==null?void 0:o.role)==="assistant"&&((r=T.message)!=null&&r.content)&&(this._emit("content",w.delta.content,T.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),w.delta.refusal!=null&&((l=T.message)==null?void 0:l.role)==="assistant"&&((u=T.message)!=null&&u.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:T.message.refusal}),((d=w.logprobs)==null?void 0:d.content)!=null&&((c=T.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=w.logprobs)==null?void 0:f.content,snapshot:((h=T.logprobs)==null?void 0:h.content)??[]}),((m=w.logprobs)==null?void 0:m.refusal)!=null&&((p=T.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=w.logprobs)==null?void 0:g.refusal,snapshot:((y=T.logprobs)==null?void 0:y.refusal)??[]});const M=_(this,ee,"m",Gt).call(this,T);T.finish_reason&&(_(this,ee,"m",Yn).call(this,T),M.current_tool_call_index!=null&&_(this,ee,"m",Kn).call(this,T,M.current_tool_call_index));for(const D of w.delta.tool_calls??[])M.current_tool_call_index!==D.index&&(_(this,ee,"m",Yn).call(this,T),M.current_tool_call_index!=null&&_(this,ee,"m",Kn).call(this,T,M.current_tool_call_index)),M.current_tool_call_index=D.index;for(const D of w.delta.tool_calls??[]){const A=(v=T.message.tool_calls)==null?void 0:v[D.index];A!=null&&A.type&&((A==null?void 0:A.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(x=A.function)==null?void 0:x.name,index:D.index,arguments:A.function.arguments,parsed_arguments:A.function.parsed_arguments,arguments_delta:((C=D.function)==null?void 0:C.arguments)??""}):(A==null||A.type,void 0))}}},Kn=function(n,i){var l,u,d;if(_(this,ee,"m",Gt).call(this,n).done_tool_calls.has(i))return;const r=(l=n.message.tool_calls)==null?void 0:l[i];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const c=(d=(u=_(this,Ee,"f"))==null?void 0:u.tools)==null?void 0:d.find(f=>f.type==="function"&&f.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:i,arguments:r.function.arguments,parsed_arguments:Nt(c)?c.$parseRaw(r.function.arguments):c!=null&&c.function.strict?JSON.parse(r.function.arguments):null})}else r.type},Yn=function(n){var o,r;const i=_(this,ee,"m",Gt).call(this,n);if(n.message.content&&!i.content_done){i.content_done=!0;const l=_(this,ee,"m",Zn).call(this);this._emit("content.done",{content:n.message.content,parsed:l?l.$parseRaw(n.message.content):null})}n.message.refusal&&!i.refusal_done&&(i.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(o=n.logprobs)!=null&&o.content&&!i.logprobs_content_done&&(i.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(r=n.logprobs)!=null&&r.refusal&&!i.logprobs_refusal_done&&(i.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},qt=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");const n=_(this,Ne,"f");if(!n)throw new L("request ended without sending any chunks");return V(this,Ne,void 0),V(this,Ye,[]),pu(n,_(this,Ee,"f"))},Zn=function(){var i;const n=(i=_(this,Ee,"f"))==null?void 0:i.response_format;return Di(n)?n:null},wo=function(n){var i,o,r,l;let u=_(this,Ne,"f");const{choices:d,...c}=n;u?Object.assign(u,c):u=V(this,Ne,{...c,choices:[]});for(const{delta:f,finish_reason:h,index:m,logprobs:p=null,...g}of n.choices){let y=u.choices[m];if(y||(y=u.choices[m]={finish_reason:h,index:m,message:{},logprobs:p,...g}),p)if(!y.logprobs)y.logprobs=Object.assign({},p);else{const{content:D,refusal:A,...U}=p;Object.assign(y.logprobs,U),D&&((i=y.logprobs).content??(i.content=[]),y.logprobs.content.push(...D)),A&&((o=y.logprobs).refusal??(o.refusal=[]),y.logprobs.refusal.push(...A))}if(h&&(y.finish_reason=h,_(this,Ee,"f")&&Br(_(this,Ee,"f")))){if(h==="length")throw new Cr;if(h==="content_filter")throw new Tr}if(Object.assign(y,g),!f)continue;const{content:v,refusal:x,function_call:C,role:w,tool_calls:T,...M}=f;if(Object.assign(y.message,M),x&&(y.message.refusal=(y.message.refusal||"")+x),w&&(y.message.role=w),C&&(y.message.function_call?(C.name&&(y.message.function_call.name=C.name),C.arguments&&((r=y.message.function_call).arguments??(r.arguments=""),y.message.function_call.arguments+=C.arguments)):y.message.function_call=C),v&&(y.message.content=(y.message.content||"")+v,!y.message.refusal&&_(this,ee,"m",Zn).call(this)&&(y.message.parsed=To(y.message.content))),T){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:D,id:A,type:U,function:R,...N}of T){const O=(l=y.message.tool_calls)[D]??(l[D]={});Object.assign(O,N),A&&(O.id=A),U&&(O.type=U),R&&(O.function??(O.function={name:R.name??"",arguments:""})),R!=null&&R.name&&(O.function.name=R.name),R!=null&&R.arguments&&(O.function.arguments+=R.arguments,au(_(this,Ee,"f"),O)&&(O.function.parsed_arguments=To(O.function.arguments)))}}}return u},Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("chunk",o=>{const r=n.shift();r?r.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((r,l)=>n.push({resolve:r,reject:l})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Te(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function pu(t,e){const{id:n,choices:i,created:o,model:r,system_fingerprint:l,...u}=t,d={...u,id:n,choices:i.map(({message:c,finish_reason:f,index:h,logprobs:m,...p})=>{if(!f)throw new L(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:y,tool_calls:v,...x}=c,C=c.role;if(!C)throw new L(`missing role for choice ${h}`);if(y){const{arguments:w,name:T}=y;if(w==null)throw new L(`missing function_call.arguments for choice ${h}`);if(!T)throw new L(`missing function_call.name for choice ${h}`);return{...p,message:{content:g,function_call:{arguments:w,name:T},role:C,refusal:c.refusal??null},finish_reason:f,index:h,logprobs:m}}return v?{...p,index:h,finish_reason:f,logprobs:m,message:{...x,role:C,content:g,refusal:c.refusal??null,tool_calls:v.map((w,T)=>{const{function:M,type:D,id:A,...U}=w,{arguments:R,name:N,...O}=M||{};if(A==null)throw new L(`missing choices[${h}].tool_calls[${T}].id
${Jt(t)}`);if(D==null)throw new L(`missing choices[${h}].tool_calls[${T}].type
${Jt(t)}`);if(N==null)throw new L(`missing choices[${h}].tool_calls[${T}].function.name
${Jt(t)}`);if(R==null)throw new L(`missing choices[${h}].tool_calls[${T}].function.arguments
${Jt(t)}`);return{...U,id:A,type:D,function:{...O,name:N,arguments:R}}})}}:{...p,message:{...x,content:g,role:C,refusal:c.refusal??null},finish_reason:f,index:h,logprobs:m}}),created:o,model:r,object:"chat.completion",...l?{system_fingerprint:l}:{}};return ou(d,e)}function Jt(t){return JSON.stringify(t)}class mn extends Rt{static fromReadableStream(e){const n=new mn(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,i){const o=new mn(n),r={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(e,n,r)),o}}let Ui=class extends B{constructor(){super(...arguments),this.messages=new Ur(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(E`/chat/completions/${e}`,n)}update(e,n,i){return this._client.post(E`/chat/completions/${e}`,{body:n,...i})}list(e={},n){return this._client.getAPIList("/chat/completions",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/chat/completions/${e}`,n)}parse(e,n){return lu(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(i=>Fi(i,e))}runTools(e,n){return e.stream?mn.runTools(this._client,e,n):Li.runTools(this._client,e,n)}stream(e,n){return Rt.createChatCompletion(this._client,e,n)}};Ui.Messages=Ur;let Vi=class extends B{constructor(){super(...arguments),this.completions=new Ui(this._client)}};Vi.Completions=Ui;const ia=Symbol("brand.privateNullableHeaders");function*gu(t){if(!t)return;if(ia in t){const{values:i,nulls:o}=t;yield*i.entries();for(const r of o)yield[r,null];return}let e=!1,n;t instanceof Headers?n=t.entries():ao(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let i of n){const o=i[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const r=ao(i[1])?i[1]:[i[1]];let l=!1;for(const u of r)u!==void 0&&(e&&!l&&(l=!0,yield[o,null]),yield[o,u])}}const b=t=>{const e=new Headers,n=new Set;for(const i of t){const o=new Set;for(const[r,l]of gu(i)){const u=r.toLowerCase();o.has(u)||(e.delete(r),o.add(u)),l===null?(e.delete(r),n.add(u)):(e.append(r,l),n.delete(u))}}return{[ia]:!0,values:e,nulls:n}};class oa extends B{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:b([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class sa extends B{create(e,n){return this._client.post("/audio/transcriptions",Je({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class ra extends B{create(e,n){return this._client.post("/audio/translations",Je({body:e,...n,__metadata:{model:e.model}},this._client))}}class bt extends B{constructor(){super(...arguments),this.transcriptions=new sa(this._client),this.translations=new ra(this._client),this.speech=new oa(this._client)}}bt.Transcriptions=sa;bt.Translations=ra;bt.Speech=oa;class aa extends B{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(E`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Q,{query:e,...n})}cancel(e,n){return this._client.post(E`/batches/${e}/cancel`,n)}}class la extends B{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(E`/assistants/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,i){return this._client.post(E`/assistants/${e}`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Q,{query:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(E`/assistants/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class ua extends B{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class ca extends B{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class kn extends B{constructor(){super(...arguments),this.sessions=new ua(this._client),this.transcriptionSessions=new ca(this._client)}}kn.Sessions=ua;kn.TranscriptionSessions=ca;class da extends B{create(e,n,i){return this._client.post(E`/threads/${e}/messages`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(e,n,i){const{thread_id:o}=n;return this._client.get(E`/threads/${o}/messages/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(e,n,i){const{thread_id:o,...r}=n;return this._client.post(E`/threads/${o}/messages/${e}`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n={},i){return this._client.getAPIList(E`/threads/${e}/messages`,Q,{query:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(e,n,i){const{thread_id:o}=n;return this._client.delete(E`/threads/${o}/messages/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}class fa extends B{retrieve(e,n,i){const{thread_id:o,run_id:r,...l}=n;return this._client.get(E`/threads/${o}/runs/${r}/steps/${e}`,{query:l,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n,i){const{thread_id:o,...r}=n;return this._client.getAPIList(E`/threads/${o}/runs/${e}/steps`,Q,{query:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}const yu=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,i=new Uint8Array(n);for(let o=0;o<n;o++)i[o]=e.charCodeAt(o);return Array.from(new Float32Array(i.buffer))}};var zn={};const ht=t=>{var e,n,i,o;if(typeof globalThis.process<"u")return((e=zn==null?void 0:zn[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(o=(i=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:i.call(n,t))==null?void 0:o.trim()};var ie,Ge,ci,Ce,jt,ye,qe,et,Oe,pn,he,en,tn,Et,Tt,wt,So,Ao,xo,Eo,Io,Mo,Ro;class It extends bi{constructor(){super(...arguments),ie.add(this),ci.set(this,[]),Ce.set(this,{}),jt.set(this,{}),ye.set(this,void 0),qe.set(this,void 0),et.set(this,void 0),Oe.set(this,void 0),pn.set(this,void 0),he.set(this,void 0),en.set(this,void 0),tn.set(this,void 0),Et.set(this,void 0)}[(ci=new WeakMap,Ce=new WeakMap,jt=new WeakMap,ye=new WeakMap,qe=new WeakMap,et=new WeakMap,Oe=new WeakMap,pn=new WeakMap,he=new WeakMap,en=new WeakMap,tn=new WeakMap,Et=new WeakMap,ie=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((r,l)=>n.push({resolve:r,reject:l})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Ge;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var r;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),this._connected();const o=Te.fromReadableStream(e,this.controller);for await(const l of o)_(this,ie,"m",Tt).call(this,l);if((r=o.controller.signal)!=null&&r.aborted)throw new me;return this._addRun(_(this,ie,"m",wt).call(this))}toReadableStream(){return new Te(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,i,o){const r=new Ge;return r._run(()=>r._runToolAssistantStream(e,n,i,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createToolAssistantStream(e,n,i,o){var d;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const l={...i,stream:!0},u=await e.submitToolOutputs(n,l,{...o,signal:this.controller.signal});this._connected();for await(const c of u)_(this,ie,"m",Tt).call(this,c);if((d=u.controller.signal)!=null&&d.aborted)throw new me;return this._addRun(_(this,ie,"m",wt).call(this))}static createThreadAssistantStream(e,n,i){const o=new Ge;return o._run(()=>o._threadAssistantStream(e,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}static createAssistantStream(e,n,i,o){const r=new Ge;return r._run(()=>r._runAssistantStream(e,n,i,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}currentEvent(){return _(this,en,"f")}currentRun(){return _(this,tn,"f")}currentMessageSnapshot(){return _(this,ye,"f")}currentRunStepSnapshot(){return _(this,Et,"f")}async finalRunSteps(){return await this.done(),Object.values(_(this,Ce,"f"))}async finalMessages(){return await this.done(),Object.values(_(this,jt,"f"))}async finalRun(){if(await this.done(),!_(this,qe,"f"))throw Error("Final run was not received.");return _(this,qe,"f")}async _createThreadAssistantStream(e,n,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const r={...n,stream:!0},l=await e.createAndRun(r,{...i,signal:this.controller.signal});this._connected();for await(const d of l)_(this,ie,"m",Tt).call(this,d);if((u=l.controller.signal)!=null&&u.aborted)throw new me;return this._addRun(_(this,ie,"m",wt).call(this))}async _createAssistantStream(e,n,i,o){var d;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const l={...i,stream:!0},u=await e.create(n,l,{...o,signal:this.controller.signal});this._connected();for await(const c of u)_(this,ie,"m",Tt).call(this,c);if((d=u.controller.signal)!=null&&d.aborted)throw new me;return this._addRun(_(this,ie,"m",wt).call(this))}static accumulateDelta(e,n){for(const[i,o]of Object.entries(n)){if(!e.hasOwnProperty(i)){e[i]=o;continue}let r=e[i];if(r==null){e[i]=o;continue}if(i==="index"||i==="type"){e[i]=o;continue}if(typeof r=="string"&&typeof o=="string")r+=o;else if(typeof r=="number"&&typeof o=="number")r+=o;else if(Gn(r)&&Gn(o))r=this.accumulateDelta(r,o);else if(Array.isArray(r)&&Array.isArray(o)){if(r.every(l=>typeof l=="string"||typeof l=="number")){r.push(...o);continue}for(const l of o){if(!Gn(l))throw new Error(`Expected array delta entry to be an object but got: ${l}`);const u=l.index;if(u==null)throw console.error(l),new Error("Expected array delta entry to have an `index` property");if(typeof u!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${u}`);const d=r[u];d==null?r.push(l):r[u]=this.accumulateDelta(d,l)}continue}else throw Error(`Unhandled record type: ${i}, deltaValue: ${o}, accValue: ${r}`);e[i]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,n,i){return await this._createThreadAssistantStream(n,e,i)}async _runAssistantStream(e,n,i,o){return await this._createAssistantStream(n,e,i,o)}async _runToolAssistantStream(e,n,i,o){return await this._createToolAssistantStream(n,e,i,o)}}Ge=It,Tt=function(e){if(!this.ended)switch(V(this,en,e),_(this,ie,"m",xo).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":_(this,ie,"m",Ro).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_(this,ie,"m",Ao).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":_(this,ie,"m",So).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},wt=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");if(!_(this,qe,"f"))throw Error("Final run has not been received");return _(this,qe,"f")},So=function(e){const[n,i]=_(this,ie,"m",Io).call(this,e,_(this,ye,"f"));V(this,ye,n),_(this,jt,"f")[n.id]=n;for(const o of i){const r=n.content[o.index];(r==null?void 0:r.type)=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const o of e.data.delta.content){if(o.type=="text"&&o.text){let r=o.text,l=n.content[o.index];if(l&&l.type=="text")this._emit("textDelta",r,l.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(o.index!=_(this,et,"f")){if(_(this,Oe,"f"))switch(_(this,Oe,"f").type){case"text":this._emit("textDone",_(this,Oe,"f").text,_(this,ye,"f"));break;case"image_file":this._emit("imageFileDone",_(this,Oe,"f").image_file,_(this,ye,"f"));break}V(this,et,o.index)}V(this,Oe,n.content[o.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(_(this,et,"f")!==void 0){const o=e.data.content[_(this,et,"f")];if(o)switch(o.type){case"image_file":this._emit("imageFileDone",o.image_file,_(this,ye,"f"));break;case"text":this._emit("textDone",o.text,_(this,ye,"f"));break}}_(this,ye,"f")&&this._emit("messageDone",e.data),V(this,ye,void 0)}},Ao=function(e){const n=_(this,ie,"m",Eo).call(this,e);switch(V(this,Et,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const i=e.data.delta;if(i.step_details&&i.step_details.type=="tool_calls"&&i.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const r of i.step_details.tool_calls)r.index==_(this,pn,"f")?this._emit("toolCallDelta",r,n.step_details.tool_calls[r.index]):(_(this,he,"f")&&this._emit("toolCallDone",_(this,he,"f")),V(this,pn,r.index),V(this,he,n.step_details.tool_calls[r.index]),_(this,he,"f")&&this._emit("toolCallCreated",_(this,he,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":V(this,Et,void 0),e.data.step_details.type=="tool_calls"&&_(this,he,"f")&&(this._emit("toolCallDone",_(this,he,"f")),V(this,he,void 0)),this._emit("runStepDone",e.data,n);break}},xo=function(e){_(this,ci,"f").push(e),this._emit("event",e)},Eo=function(e){switch(e.event){case"thread.run.step.created":return _(this,Ce,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=_(this,Ce,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let i=e.data;if(i.delta){const o=Ge.accumulateDelta(n,i.delta);_(this,Ce,"f")[e.data.id]=o}return _(this,Ce,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":_(this,Ce,"f")[e.data.id]=e.data;break}if(_(this,Ce,"f")[e.data.id])return _(this,Ce,"f")[e.data.id];throw new Error("No snapshot available")},Io=function(e,n){let i=[];switch(e.event){case"thread.message.created":return[e.data,i];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let o=e.data;if(o.delta.content)for(const r of o.delta.content)if(r.index in n.content){let l=n.content[r.index];n.content[r.index]=_(this,ie,"m",Mo).call(this,r,l)}else n.content[r.index]=r,i.push(r);return[n,i];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,i];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Mo=function(e,n){return Ge.accumulateDelta(n,e)},Ro=function(e){switch(V(this,tn,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":V(this,qe,e.data),_(this,he,"f")&&(this._emit("toolCallDone",_(this,he,"f")),V(this,he,void 0));break}};let $i=class extends B{constructor(){super(...arguments),this.steps=new fa(this._client)}create(e,n,i){const{include:o,...r}=n;return this._client.post(E`/threads/${e}/runs`,{query:{include:o},body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers]),stream:n.stream??!1})}retrieve(e,n,i){const{thread_id:o}=n;return this._client.get(E`/threads/${o}/runs/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(e,n,i){const{thread_id:o,...r}=n;return this._client.post(E`/threads/${o}/runs/${e}`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n={},i){return this._client.getAPIList(E`/threads/${e}/runs`,Q,{query:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}cancel(e,n,i){const{thread_id:o}=n;return this._client.post(E`/threads/${o}/runs/${e}/cancel`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(e,n,i){const o=await this.create(e,n,i);return await this.poll(o.id,{thread_id:e},i)}createAndStream(e,n,i){return It.createAssistantStream(e,this._client.beta.threads.runs,n,i)}async poll(e,n,i){var r;const o=b([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=i==null?void 0:i.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:l,response:u}=await this.retrieve(e,n,{...i,headers:{...i==null?void 0:i.headers,...o}}).withResponse();switch(l.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(i!=null&&i.pollIntervalMs)d=i.pollIntervalMs;else{const c=u.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(d=f)}}await kt(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return l}}}stream(e,n,i){return It.createAssistantStream(e,this._client.beta.threads.runs,n,i)}submitToolOutputs(e,n,i){const{thread_id:o,...r}=n;return this._client.post(E`/threads/${o}/runs/${e}/submit_tool_outputs`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,i){const o=await this.submitToolOutputs(e,n,i);return await this.poll(o.id,n,i)}submitToolOutputsStream(e,n,i){return It.createToolAssistantStream(e,this._client.beta.threads.runs,n,i)}};$i.Steps=fa;class Nn extends B{constructor(){super(...arguments),this.runs=new $i(this._client),this.messages=new da(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(E`/threads/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,i){return this._client.post(E`/threads/${e}`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(e,n){return this._client.delete(E`/threads/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const i=await this.createAndRun(e,n);return await this.runs.poll(i.id,{thread_id:i.thread_id},n)}createAndRunStream(e,n){return It.createThreadAssistantStream(e,this._client.beta.threads,n)}}Nn.Runs=$i;Nn.Messages=da;class Dt extends B{constructor(){super(...arguments),this.realtime=new kn(this._client),this.assistants=new la(this._client),this.threads=new Nn(this._client)}}Dt.Realtime=kn;Dt.Assistants=la;Dt.Threads=Nn;class ha extends B{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class ma extends B{retrieve(e,n,i){const{container_id:o}=n;return this._client.get(E`/containers/${o}/files/${e}/content`,{...i,headers:b([{Accept:"application/binary"},i==null?void 0:i.headers]),__binaryResponse:!0})}}let Bi=class extends B{constructor(){super(...arguments),this.content=new ma(this._client)}create(e,n,i){return this._client.post(E`/containers/${e}/files`,Je({body:n,...i},this._client))}retrieve(e,n,i){const{container_id:o}=n;return this._client.get(E`/containers/${o}/files/${e}`,i)}list(e,n={},i){return this._client.getAPIList(E`/containers/${e}/files`,Q,{query:n,...i})}delete(e,n,i){const{container_id:o}=n;return this._client.delete(E`/containers/${o}/files/${e}`,{...i,headers:b([{Accept:"*/*"},i==null?void 0:i.headers])})}};Bi.Content=ma;class Oi extends B{constructor(){super(...arguments),this.files=new Bi(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(E`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/containers/${e}`,{...n,headers:b([{Accept:"*/*"},n==null?void 0:n.headers])})}}Oi.Files=Bi;class pa extends B{create(e,n){const i=!!e.encoding_format;let o=i?e.encoding_format:"base64";i&&se(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const r=this._client.post("/embeddings",{body:{...e,encoding_format:o},...n});return i?r:(se(this._client).debug("embeddings/decoding base64 embeddings from base64"),r._thenUnwrap(l=>(l&&l.data&&l.data.forEach(u=>{const d=u.embedding;u.embedding=yu(d)}),l)))}}class ga extends B{retrieve(e,n,i){const{eval_id:o,run_id:r}=n;return this._client.get(E`/evals/${o}/runs/${r}/output_items/${e}`,i)}list(e,n,i){const{eval_id:o,...r}=n;return this._client.getAPIList(E`/evals/${o}/runs/${e}/output_items`,Q,{query:r,...i})}}class Gi extends B{constructor(){super(...arguments),this.outputItems=new ga(this._client)}create(e,n,i){return this._client.post(E`/evals/${e}/runs`,{body:n,...i})}retrieve(e,n,i){const{eval_id:o}=n;return this._client.get(E`/evals/${o}/runs/${e}`,i)}list(e,n={},i){return this._client.getAPIList(E`/evals/${e}/runs`,Q,{query:n,...i})}delete(e,n,i){const{eval_id:o}=n;return this._client.delete(E`/evals/${o}/runs/${e}`,i)}cancel(e,n,i){const{eval_id:o}=n;return this._client.post(E`/evals/${o}/runs/${e}`,i)}}Gi.OutputItems=ga;class qi extends B{constructor(){super(...arguments),this.runs=new Gi(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(E`/evals/${e}`,n)}update(e,n,i){return this._client.post(E`/evals/${e}`,{body:n,...i})}list(e={},n){return this._client.getAPIList("/evals",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/evals/${e}`,n)}}qi.Runs=Gi;let ya=class extends B{create(e,n){return this._client.post("/files",Je({body:e,...n},this._client))}retrieve(e,n){return this._client.get(E`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/files/${e}`,n)}content(e,n){return this._client.get(E`/files/${e}/content`,{...n,headers:b([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:i=30*60*1e3}={}){const o=new Set(["processed","error","deleted"]),r=Date.now();let l=await this.retrieve(e);for(;!l.status||!o.has(l.status);)if(await kt(n),l=await this.retrieve(e),Date.now()-r>i)throw new ki({message:`Giving up on waiting for file ${e} to finish processing after ${i} milliseconds.`});return l}};class _a extends B{}let va=class extends B{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class Ji extends B{constructor(){super(...arguments),this.graders=new va(this._client)}}Ji.Graders=va;class Ca extends B{create(e,n,i){return this._client.getAPIList(E`/fine_tuning/checkpoints/${e}/permissions`,Pn,{body:n,method:"post",...i})}retrieve(e,n={},i){return this._client.getAPIList(E`/fine_tuning/checkpoints/${e}/permissions`,Q,{query:n,...i})}delete(e,n,i){const{fine_tuned_model_checkpoint:o}=n;return this._client.delete(E`/fine_tuning/checkpoints/${o}/permissions/${e}`,i)}}let Hi=class extends B{constructor(){super(...arguments),this.permissions=new Ca(this._client)}};Hi.Permissions=Ca;class Ta extends B{list(e,n={},i){return this._client.getAPIList(E`/fine_tuning/jobs/${e}/checkpoints`,Q,{query:n,...i})}}class Wi extends B{constructor(){super(...arguments),this.checkpoints=new Ta(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(E`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Q,{query:e,...n})}cancel(e,n){return this._client.post(E`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},i){return this._client.getAPIList(E`/fine_tuning/jobs/${e}/events`,Q,{query:n,...i})}pause(e,n){return this._client.post(E`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(E`/fine_tuning/jobs/${e}/resume`,n)}}Wi.Checkpoints=Ta;class ct extends B{constructor(){super(...arguments),this.methods=new _a(this._client),this.jobs=new Wi(this._client),this.checkpoints=new Hi(this._client),this.alpha=new Ji(this._client)}}ct.Methods=_a;ct.Jobs=Wi;ct.Checkpoints=Hi;ct.Alpha=Ji;class wa extends B{}class Ki extends B{constructor(){super(...arguments),this.graderModels=new wa(this._client)}}Ki.GraderModels=wa;class Sa extends B{createVariation(e,n){return this._client.post("/images/variations",Je({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Je({body:e,...n},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}let Aa=class extends B{retrieve(e,n){return this._client.get(E`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Pn,e)}delete(e,n){return this._client.delete(E`/models/${e}`,n)}};class xa extends B{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function _u(t,e){return!e||!Cu(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(i=>({...i,parsed:null}))}:n)}:Ea(t,e)}function Ea(t,e){const n=t.output.map(o=>{if(o.type==="function_call")return{...o,parsed_arguments:Su(e,o)};if(o.type==="message"){const r=o.content.map(l=>l.type==="output_text"?{...l,parsed:vu(e,l.text)}:l);return{...o,content:r}}return o}),i=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||Ia(i),Object.defineProperty(i,"output_parsed",{enumerable:!0,get(){for(const o of i.output)if(o.type==="message"){for(const r of o.content)if(r.type==="output_text"&&r.parsed!==null)return r.parsed}return null}}),i}function vu(t,e){var n,i,o,r;return((i=(n=t.text)==null?void 0:n.format)==null?void 0:i.type)!=="json_schema"?null:"$parseRaw"in((o=t.text)==null?void 0:o.format)?((r=t.text)==null?void 0:r.format).$parseRaw(e):JSON.parse(e)}function Cu(t){var e;return!!Di((e=t.text)==null?void 0:e.format)}function Tu(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function wu(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function Su(t,e){const n=wu(t.tools??[],e.name);return{...e,...e,parsed_arguments:Tu(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function Ia(t){const e=[];for(const n of t.output)if(n.type==="message")for(const i of n.content)i.type==="output_text"&&e.push(i.text);t.output_text=e.join("")}var Ze,Ht,be,Wt,Po,ko,No,bo;class Yi extends bi{constructor(e){super(),Ze.add(this),Ht.set(this,void 0),be.set(this,void 0),Wt.set(this,void 0),V(this,Ht,e)}static createResponse(e,n,i){const o=new Yi(n);return o._run(()=>o._createOrRetrieveResponse(e,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createOrRetrieveResponse(e,n,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),_(this,Ze,"m",Po).call(this);let r,l=null;"response_id"in n?(r=await e.responses.retrieve(n.response_id,{stream:!0},{...i,signal:this.controller.signal,stream:!0}),l=n.starting_after??null):r=await e.responses.create({...n,stream:!0},{...i,signal:this.controller.signal}),this._connected();for await(const d of r)_(this,Ze,"m",ko).call(this,d,l);if((u=r.controller.signal)!=null&&u.aborted)throw new me;return _(this,Ze,"m",No).call(this)}[(Ht=new WeakMap,be=new WeakMap,Wt=new WeakMap,Ze=new WeakSet,Po=function(){this.ended||V(this,be,void 0)},ko=function(n,i){if(this.ended)return;const o=(l,u)=>{(i==null||u.sequence_number>i)&&this._emit(l,u)},r=_(this,Ze,"m",bo).call(this,n);switch(o("event",n),n.type){case"response.output_text.delta":{const l=r.output[n.output_index];if(!l)throw new L(`missing output at index ${n.output_index}`);if(l.type==="message"){const u=l.content[n.content_index];if(!u)throw new L(`missing content at index ${n.content_index}`);if(u.type!=="output_text")throw new L(`expected content to be 'output_text', got ${u.type}`);o("response.output_text.delta",{...n,snapshot:u.text})}break}case"response.function_call_arguments.delta":{const l=r.output[n.output_index];if(!l)throw new L(`missing output at index ${n.output_index}`);l.type==="function_call"&&o("response.function_call_arguments.delta",{...n,snapshot:l.arguments});break}default:o(n.type,n);break}},No=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");const n=_(this,be,"f");if(!n)throw new L("request ended without sending any events");V(this,be,void 0);const i=Au(n,_(this,Ht,"f"));return V(this,Wt,i),i},bo=function(n){let i=_(this,be,"f");if(!i){if(n.type!=="response.created")throw new L(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return i=V(this,be,n.response),i}switch(n.type){case"response.output_item.added":{i.output.push(n.item);break}case"response.content_part.added":{const o=i.output[n.output_index];if(!o)throw new L(`missing output at index ${n.output_index}`);o.type==="message"&&o.content.push(n.part);break}case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new L(`missing output at index ${n.output_index}`);if(o.type==="message"){const r=o.content[n.content_index];if(!r)throw new L(`missing content at index ${n.content_index}`);if(r.type!=="output_text")throw new L(`expected content to be 'output_text', got ${r.type}`);r.text+=n.delta}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new L(`missing output at index ${n.output_index}`);o.type==="function_call"&&(o.arguments+=n.delta);break}case"response.completed":{V(this,be,n.response);break}}return i},Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((r,l)=>n.push({resolve:r,reject:l})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=_(this,Wt,"f");if(!e)throw new L("stream ended without producing a ChatCompletion");return e}}function Au(t,e){return _u(t,e)}class Ma extends B{list(e,n={},i){return this._client.getAPIList(E`/responses/${e}/input_items`,Q,{query:n,...i})}}class Zi extends B{constructor(){super(...arguments),this.inputItems=new Ma(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(i=>("object"in i&&i.object==="response"&&Ia(i),i))}retrieve(e,n={},i){return this._client.get(E`/responses/${e}`,{query:n,...i,stream:(n==null?void 0:n.stream)??!1})}delete(e,n){return this._client.delete(E`/responses/${e}`,{...n,headers:b([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(i=>Ea(i,e))}stream(e,n){return Yi.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(E`/responses/${e}/cancel`,n)}}Zi.InputItems=Ma;class Ra extends B{create(e,n,i){return this._client.post(E`/uploads/${e}/parts`,Je({body:n,...i},this._client))}}class zi extends B{constructor(){super(...arguments),this.parts=new Ra(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(E`/uploads/${e}/cancel`,n)}complete(e,n,i){return this._client.post(E`/uploads/${e}/complete`,{body:n,...i})}}zi.Parts=Ra;const xu=async t=>{const e=await Promise.allSettled(t),n=e.filter(o=>o.status==="rejected");if(n.length){for(const o of n)console.error(o.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const i=[];for(const o of e)o.status==="fulfilled"&&i.push(o.value);return i};class Pa extends B{create(e,n,i){return this._client.post(E`/vector_stores/${e}/file_batches`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(e,n,i){const{vector_store_id:o}=n;return this._client.get(E`/vector_stores/${o}/file_batches/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}cancel(e,n,i){const{vector_store_id:o}=n;return this._client.post(E`/vector_stores/${o}/file_batches/${e}/cancel`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(e,n,i){const o=await this.create(e,n);return await this.poll(e,o.id,i)}listFiles(e,n,i){const{vector_store_id:o,...r}=n;return this._client.getAPIList(E`/vector_stores/${o}/file_batches/${e}/files`,Q,{query:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async poll(e,n,i){var r;const o=b([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=i==null?void 0:i.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:l,response:u}=await this.retrieve(n,{vector_store_id:e},{...i,headers:o}).withResponse();switch(l.status){case"in_progress":let d=5e3;if(i!=null&&i.pollIntervalMs)d=i.pollIntervalMs;else{const c=u.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(d=f)}}await kt(d);break;case"failed":case"cancelled":case"completed":return l}}}async uploadAndPoll(e,{files:n,fileIds:i=[]},o){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=(o==null?void 0:o.maxConcurrency)??5,l=Math.min(r,n.length),u=this._client,d=n.values(),c=[...i];async function f(m){for(let p of m){const g=await u.files.create({file:p,purpose:"assistants"},o);c.push(g.id)}}const h=Array(l).fill(d).map(f);return await xu(h),await this.createAndPoll(e,{file_ids:c})}}let ka=class extends B{create(e,n,i){return this._client.post(E`/vector_stores/${e}/files`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(e,n,i){const{vector_store_id:o}=n;return this._client.get(E`/vector_stores/${o}/files/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(e,n,i){const{vector_store_id:o,...r}=n;return this._client.post(E`/vector_stores/${o}/files/${e}`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n={},i){return this._client.getAPIList(E`/vector_stores/${e}/files`,Q,{query:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(e,n,i){const{vector_store_id:o}=n;return this._client.delete(E`/vector_stores/${o}/files/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(e,n,i){const o=await this.create(e,n,i);return await this.poll(e,o.id,i)}async poll(e,n,i){var r;const o=b([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=i==null?void 0:i.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const l=await this.retrieve(n,{vector_store_id:e},{...i,headers:o}).withResponse(),u=l.data;switch(u.status){case"in_progress":let d=5e3;if(i!=null&&i.pollIntervalMs)d=i.pollIntervalMs;else{const c=l.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(d=f)}}await kt(d);break;case"failed":case"completed":return u}}}async upload(e,n,i){const o=await this._client.files.create({file:n,purpose:"assistants"},i);return this.create(e,{file_id:o.id},i)}async uploadAndPoll(e,n,i){const o=await this.upload(e,n,i);return await this.poll(e,o.id,i)}content(e,n,i){const{vector_store_id:o}=n;return this._client.getAPIList(E`/vector_stores/${o}/files/${e}/content`,Pn,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}};class bn extends B{constructor(){super(...arguments),this.files=new ka(this._client),this.fileBatches=new Pa(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(E`/vector_stores/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,i){return this._client.post(E`/vector_stores/${e}`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Q,{query:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(E`/vector_stores/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,i){return this._client.getAPIList(E`/vector_stores/${e}/search`,Pn,{body:n,method:"post",...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}bn.Files=ka;bn.FileBatches=Pa;var di,Xi,nn,Na;class W{constructor({baseURL:e=ht("OPENAI_BASE_URL"),apiKey:n=ht("OPENAI_API_KEY"),organization:i=ht("OPENAI_ORG_ID")??null,project:o=ht("OPENAI_PROJECT_ID")??null,...r}={}){if(di.add(this),nn.set(this,void 0),this.completions=new ha(this),this.chat=new Vi(this),this.embeddings=new pa(this),this.files=new ya(this),this.images=new Sa(this),this.audio=new bt(this),this.moderations=new xa(this),this.models=new Aa(this),this.fineTuning=new ct(this),this.graders=new Ki(this),this.vectorStores=new bn(this),this.beta=new Dt(this),this.batches=new aa(this),this.uploads=new zi(this),this.responses=new Zi(this),this.evals=new qi(this),this.containers=new Oi(this),n===void 0)throw new L("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:n,organization:i,project:o,...r,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&El())throw new L(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=l.baseURL,this.timeout=l.timeout??Xi.DEFAULT_TIMEOUT,this.logger=l.logger??console;const u="warn";this.logLevel=u,this.logLevel=_o(l.logLevel,"ClientOptions.logLevel",this)??_o(ht("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??u,this.fetchOptions=l.fetchOptions,this.maxRetries=l.maxRetries??2,this.fetch=l.fetch??kl(),V(this,nn,bl),this._options=l,this.apiKey=n,this.organization=i,this.project=o}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}authHeaders(e){return b([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return $l(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Xe}`}defaultIdempotencyKey(){return`stainless-node-retry-${dr()}`}makeStatusError(e,n,i,o){return oe.generate(e,n,i,o)}buildURL(e,n,i){const o=!_(this,di,"m",Na).call(this)&&i||this.baseURL,r=Cl(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return wl(l)||(n={...l,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:i}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,i){return this.request(Promise.resolve(i).then(o=>({method:e,path:n,...o})))}request(e,n=null){return new Rn(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,i){var x,C;const o=await e,r=o.maxRetries??this.maxRetries;n==null&&(n=r),await this.prepareOptions(o);const{req:l,url:u,timeout:d}=this.buildRequest(o,{retryCount:r-n});await this.prepareRequest(l,{url:u,options:o});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=i===void 0?"":`, retryOf: ${i}`,h=Date.now();if(se(this).debug(`[${c}] sending request`,Be({retryOfRequestLogID:i,method:o.method,url:u,options:o,headers:l.headers})),(x=o.signal)!=null&&x.aborted)throw new me;const m=new AbortController,p=await this.fetchWithTimeout(u,l,d,m).catch(ti),g=Date.now();if(p instanceof Error){const w=`retrying, ${n} attempts remaining`;if((C=o.signal)!=null&&C.aborted)throw new me;const T=ei(p)||/timed? ?out/i.test(String(p)+("cause"in p?String(p.cause):""));if(n)return se(this).info(`[${c}] connection ${T?"timed out":"failed"} - ${w}`),se(this).debug(`[${c}] connection ${T?"timed out":"failed"} (${w})`,Be({retryOfRequestLogID:i,url:u,durationMs:g-h,message:p.message})),this.retryRequest(o,n,i??c);throw se(this).info(`[${c}] connection ${T?"timed out":"failed"} - error; no more retries left`),se(this).debug(`[${c}] connection ${T?"timed out":"failed"} (error; no more retries left)`,Be({retryOfRequestLogID:i,url:u,durationMs:g-h,message:p.message})),T?new ki:new In({cause:p})}const y=[...p.headers.entries()].filter(([w])=>w==="x-request-id").map(([w,T])=>", "+w+": "+JSON.stringify(T)).join(""),v=`[${c}${f}${y}] ${l.method} ${u} ${p.ok?"succeeded":"failed"} with status ${p.status} in ${g-h}ms`;if(!p.ok){const w=this.shouldRetry(p);if(n&&w){const R=`retrying, ${n} attempts remaining`;return await Nl(p.body),se(this).info(`${v} - ${R}`),se(this).debug(`[${c}] response error (${R})`,Be({retryOfRequestLogID:i,url:p.url,status:p.status,headers:p.headers,durationMs:g-h})),this.retryRequest(o,n,i??c,p.headers)}const T=w?"error; no more retries left":"error; not retryable";se(this).info(`${v} - ${T}`);const M=await p.text().catch(R=>ti(R).message),D=xl(M),A=D?void 0:M;throw se(this).debug(`[${c}] response error (${T})`,Be({retryOfRequestLogID:i,url:p.url,status:p.status,headers:p.headers,message:A,durationMs:Date.now()-h})),this.makeStatusError(p.status,D,A,p.headers)}return se(this).info(v),se(this).debug(`[${c}] response start`,Be({retryOfRequestLogID:i,url:p.url,status:p.status,headers:p.headers,durationMs:g-h})),{response:p,options:o,controller:m,requestLogID:c,retryOfRequestLogID:i,startTime:h}}getAPIList(e,n,i){return this.requestAPIList(n,{method:"get",path:e,...i})}requestAPIList(e,n){const i=this.makeRequest(n,null,void 0);return new Yl(this,i,e)}async fetchWithTimeout(e,n,i,o){const{signal:r,method:l,...u}=n||{};r&&r.addEventListener("abort",()=>o.abort());const d=setTimeout(()=>o.abort(),i),c=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,f={signal:o.signal,...c?{duplex:"half"}:{},method:"GET",...u};l&&(f.method=l.toUpperCase());try{return await this.fetch.call(void 0,e,f)}finally{clearTimeout(d)}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,i,o){let r;const l=o==null?void 0:o.get("retry-after-ms");if(l){const d=parseFloat(l);Number.isNaN(d)||(r=d)}const u=o==null?void 0:o.get("retry-after");if(u&&!r){const d=parseFloat(u);Number.isNaN(d)?r=Date.parse(u)-Date.now():r=d*1e3}if(!(r&&0<=r&&r<60*1e3)){const d=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(n,d)}return await kt(r),this.makeRequest(e,n-1,i)}calculateDefaultRetryTimeoutMillis(e,n){const r=n-e,l=Math.min(.5*Math.pow(2,r),8),u=1-Math.random()*.25;return l*u*1e3}buildRequest(e,{retryCount:n=0}={}){const i={...e},{method:o,path:r,query:l,defaultBaseURL:u}=i,d=this.buildURL(r,l,u);"timeout"in i&&Al("timeout",i.timeout),i.timeout=i.timeout??this.timeout;const{bodyHeaders:c,body:f}=this.buildBody({options:i}),h=this.buildHeaders({options:e,method:o,bodyHeaders:c,retryCount:n});return{req:{method:o,headers:h,...i.signal&&{signal:i.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...i.fetchOptions??{}},url:d,timeout:i.timeout}}buildHeaders({options:e,method:n,bodyHeaders:i,retryCount:o}){let r={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);const l=b([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...Pl(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},this.authHeaders(e),this._options.defaultHeaders,i,e.headers]);return this.validateHeaders(l),l.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=b([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Sr(e)}:_(this,nn,"f").call(this,{body:e,headers:i})}}Xi=W,nn=new WeakMap,di=new WeakSet,Na=function(){return this.baseURL!=="https://api.openai.com/v1"};W.OpenAI=Xi;W.DEFAULT_TIMEOUT=6e5;W.OpenAIError=L;W.APIError=oe;W.APIConnectionError=In;W.APIConnectionTimeoutError=ki;W.APIUserAbortError=me;W.NotFoundError=pr;W.ConflictError=gr;W.RateLimitError=_r;W.BadRequestError=fr;W.AuthenticationError=hr;W.InternalServerError=vr;W.PermissionDeniedError=mr;W.UnprocessableEntityError=yr;W.toFile=eu;W.Completions=ha;W.Chat=Vi;W.Embeddings=pa;W.Files=ya;W.Images=Sa;W.Audio=bt;W.Moderations=xa;W.Models=Aa;W.FineTuning=ct;W.Graders=Ki;W.VectorStores=bn;W.Beta=Dt;W.Batches=aa;W.Uploads=zi;W.Responses=Zi;W.Evals=qi;W.Containers=Oi;let fi=null,on=null;const Dn=async()=>(fi??(fi=await xn.getActiveApiKey("openai")),fi),H_=async()=>{fi=await xn.getActiveApiKey("openai"),on=null},Fn=async()=>{const t=await Dn();return!on&&t&&(on=new W({apiKey:t,dangerouslyAllowBrowser:!0})),on},Eu=t=>{const e=Array.isArray(t.text)?t.text.join(`
`):t.text;switch(t.sender){case"character":return{role:"assistant",content:e};case"user":default:return{role:"user",content:e}}},ba=t=>{const e=[];return t.characterInitialPrompt&&e.push({role:"system",content:t.characterInitialPrompt}),t.characterInitialMessage&&t.characterInitialMessage.length>0&&e.push({role:"assistant",content:t.characterInitialMessage.join(`
`)}),t.messages&&t.messages.length>0&&t.messages.forEach(n=>{e.push(Eu(n))}),e},Iu=async(t,e="gpt-3.5-turbo",n=1e3)=>{var i,o;try{if(!await Dn())throw new Error("OpenAI API key is not configured. Please configure your API key in the application settings.");const l=await Fn();if(!l)throw new Error("Failed to initialize OpenAI client");const u=ba(t),d=parseFloat(t.temperature)||.7,f=(o=(i=(await l.chat.completions.create({model:e,messages:u,temperature:d,max_tokens:n})).choices[0])==null?void 0:i.message)==null?void 0:o.content;if(!f)throw new Error("No response received from OpenAI");return f}catch(r){throw console.error("Error getting chat completion:",r),r}},Mu=async(t,e="gpt-3.5-turbo",n=1e3,i)=>{var o,r;try{if(!await Dn())throw new Error("OpenAI API key is not configured. Please configure your API key in the application settings.");const u=await Fn();if(!u)throw new Error("Failed to initialize OpenAI client");const d=ba(t),c=parseFloat(t.temperature)||.7,f=await u.chat.completions.create({model:e,messages:d,temperature:c,max_tokens:n,stream:!0});let h="";for await(const m of f){const p=((r=(o=m.choices[0])==null?void 0:o.delta)==null?void 0:r.content)??"";p&&(h+=p,i==null||i(p))}return h}catch(l){throw console.error("Error getting streaming chat completion:",l),l}},Ru=(t,e="character")=>({id:`msg_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,sender:e,text:[t]}),Pu=async()=>{try{if(!await Dn())return!1;const e=await Fn();return e?(await e.models.list(),!0):!1}catch(t){return console.error("Invalid OpenAI API key:",t),!1}},ku=async()=>{try{const t=await Fn();return t?(await t.models.list()).data.filter(n=>n.id.includes("gpt")&&!n.id.includes("image")&&!n.id.includes("vision")&&!n.id.includes("dall-e")&&!n.id.includes("transcribe")).map(n=>n.id).sort((n,i)=>n.localeCompare(i)):["gpt-3.5-turbo","gpt-4","gpt-4-turbo-preview"]}catch(t){return console.error("Error fetching available models:",t),["gpt-3.5-turbo","gpt-4","gpt-4-turbo-preview"]}};var Y;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function n(o){throw new Error}t.assertNever=n,t.arrayToEnum=o=>{const r={};for(const l of o)r[l]=l;return r},t.getValidEnumValues=o=>{const r=t.objectKeys(o).filter(u=>typeof o[o[u]]!="number"),l={};for(const u of r)l[u]=o[u];return t.objectValues(l)},t.objectValues=o=>t.objectKeys(o).map(function(r){return o[r]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const r=[];for(const l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.push(l);return r},t.find=(o,r)=>{for(const l of o)if(r(l))return l},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function i(o,r=" | "){return o.map(l=>typeof l=="string"?`'${l}'`:l).join(r)}t.joinValues=i,t.jsonStringifyReplacer=(o,r)=>typeof r=="bigint"?r.toString():r})(Y||(Y={}));var Do;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Do||(Do={}));const P=Y.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),De=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return Number.isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},S=Y.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Me extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(r){return r.message},i={_errors:[]},o=r=>{for(const l of r.issues)if(l.code==="invalid_union")l.unionErrors.map(o);else if(l.code==="invalid_return_type")o(l.returnTypeError);else if(l.code==="invalid_arguments")o(l.argumentsError);else if(l.path.length===0)i._errors.push(n(l));else{let u=i,d=0;for(;d<l.path.length;){const c=l.path[d];d===l.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(n(l))):u[c]=u[c]||{_errors:[]},u=u[c],d++}}};return o(this),i}static assert(e){if(!(e instanceof Me))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Y.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const o of this.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(e(o))):i.push(e(o));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Me.create=t=>new Me(t);const hi=(t,e)=>{let n;switch(t.code){case S.invalid_type:t.received===P.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case S.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Y.jsonStringifyReplacer)}`;break;case S.unrecognized_keys:n=`Unrecognized key(s) in object: ${Y.joinValues(t.keys,", ")}`;break;case S.invalid_union:n="Invalid input";break;case S.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Y.joinValues(t.options)}`;break;case S.invalid_enum_value:n=`Invalid enum value. Expected ${Y.joinValues(t.options)}, received '${t.received}'`;break;case S.invalid_arguments:n="Invalid function arguments";break;case S.invalid_return_type:n="Invalid function return type";break;case S.invalid_date:n="Invalid date";break;case S.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Y.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case S.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case S.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case S.custom:n="Invalid input";break;case S.invalid_intersection_types:n="Intersection results could not be merged";break;case S.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case S.not_finite:n="Number must be finite";break;default:n=e.defaultError,Y.assertNever(t)}return{message:n}};let Nu=hi;function bu(){return Nu}const Du=t=>{const{data:e,path:n,errorMaps:i,issueData:o}=t,r=[...n,...o.path||[]],l={...o,path:r};if(o.message!==void 0)return{...o,path:r,message:o.message};let u="";const d=i.filter(c=>!!c).slice().reverse();for(const c of d)u=c(l,{data:e,defaultError:u}).message;return{...o,path:r,message:u}};function I(t,e){const n=bu(),i=Du({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===hi?void 0:hi].filter(o=>!!o)});t.common.issues.push(i)}class le{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const o of n){if(o.status==="aborted")return G;o.status==="dirty"&&e.dirty(),i.push(o.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const o of n){const r=await o.key,l=await o.value;i.push({key:r,value:l})}return le.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const o of n){const{key:r,value:l}=o;if(r.status==="aborted"||l.status==="aborted")return G;r.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof l.value<"u"||o.alwaysSet)&&(i[r.value]=l.value)}return{status:e.value,value:i}}}const G=Object.freeze({status:"aborted"}),St=t=>({status:"dirty",value:t}),pe=t=>({status:"valid",value:t}),Fo=t=>t.status==="aborted",Lo=t=>t.status==="dirty",ot=t=>t.status==="valid",gn=t=>typeof Promise<"u"&&t instanceof Promise;var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(k||(k={}));class xe{constructor(e,n,i,o){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Uo=(t,e)=>{if(ot(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Me(t.common.issues);return this._error=n,this._error}}};function q(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:o}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(l,u)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??u.defaultError}:typeof u.data>"u"?{message:d??i??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:d??n??u.defaultError}},description:o}}class H{get description(){return this._def.description}_getType(e){return De(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:De(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:De(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(gn(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)},o=this._parseSync({data:e,path:i.path,parent:i});return Uo(i,o)}"~validate"(e){var i,o;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return ot(r)?{value:r.value}:{issues:n.common.issues}}catch(r){(o=(i=r==null?void 0:r.message)==null?void 0:i.toLowerCase())!=null&&o.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>ot(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)},o=this._parse({data:e,path:i.path,parent:i}),r=await(gn(o)?o:Promise.resolve(o));return Uo(i,r)}refine(e,n){const i=o=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(o):n;return this._refinement((o,r)=>{const l=e(o),u=()=>r.addIssue({code:S.custom,...i(o)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(e,n){return this._refinement((i,o)=>e(i)?!0:(o.addIssue(typeof n=="function"?n(i,o):n),!1))}_refinement(e){return new at({schema:this,typeName:$.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Fe.create(this,this._def)}nullable(){return lt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ae.create(this)}promise(){return Tn.create(this,this._def)}or(e){return _n.create([this,e],this._def)}and(e){return vn.create(this,e,this._def)}transform(e){return new at({...q(this._def),schema:this,typeName:$.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new yi({...q(this._def),innerType:this,defaultValue:n,typeName:$.ZodDefault})}brand(){return new ic({typeName:$.ZodBranded,type:this,...q(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new _i({...q(this._def),innerType:this,catchValue:n,typeName:$.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Qi.create(this,e)}readonly(){return vi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Fu=/^c[^\s-]{8,}$/i,Lu=/^[0-9a-z]+$/,Uu=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Vu=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$u=/^[a-z0-9_-]{21}$/i,Bu=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ou=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Gu=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,qu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Xn;const Ju=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Hu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Wu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ku=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Yu=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Zu=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Da="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",zu=new RegExp(`^${Da}$`);function Fa(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function Xu(t){return new RegExp(`^${Fa(t)}$`)}function Qu(t){let e=`${Da}T${Fa(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function ju(t,e){return!!((e==="v4"||!e)&&Ju.test(t)||(e==="v6"||!e)&&Wu.test(t))}function ec(t,e){if(!Bu.test(t))return!1;try{const[n]=t.split("."),i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(i));return!(typeof o!="object"||o===null||"typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function tc(t,e){return!!((e==="v4"||!e)&&Hu.test(t)||(e==="v6"||!e)&&Ku.test(t))}class we extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){const r=this._getOrReturnCtx(e);return I(r,{code:S.invalid_type,expected:P.string,received:r.parsedType}),G}const i=new le;let o;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(o=this._getOrReturnCtx(e,o),I(o,{code:S.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),i.dirty());else if(r.kind==="max")e.data.length>r.value&&(o=this._getOrReturnCtx(e,o),I(o,{code:S.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),i.dirty());else if(r.kind==="length"){const l=e.data.length>r.value,u=e.data.length<r.value;(l||u)&&(o=this._getOrReturnCtx(e,o),l?I(o,{code:S.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):u&&I(o,{code:S.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),i.dirty())}else if(r.kind==="email")Gu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"email",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="emoji")Xn||(Xn=new RegExp(qu,"u")),Xn.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"emoji",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="uuid")Vu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"uuid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="nanoid")$u.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"nanoid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="cuid")Fu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"cuid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="cuid2")Lu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"cuid2",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="ulid")Uu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"ulid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),I(o,{validation:"url",code:S.invalid_string,message:r.message}),i.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"regex",code:S.invalid_string,message:r.message}),i.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(o=this._getOrReturnCtx(e,o),I(o,{code:S.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),i.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(o=this._getOrReturnCtx(e,o),I(o,{code:S.invalid_string,validation:{startsWith:r.value},message:r.message}),i.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(o=this._getOrReturnCtx(e,o),I(o,{code:S.invalid_string,validation:{endsWith:r.value},message:r.message}),i.dirty()):r.kind==="datetime"?Qu(r).test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{code:S.invalid_string,validation:"datetime",message:r.message}),i.dirty()):r.kind==="date"?zu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{code:S.invalid_string,validation:"date",message:r.message}),i.dirty()):r.kind==="time"?Xu(r).test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{code:S.invalid_string,validation:"time",message:r.message}),i.dirty()):r.kind==="duration"?Ou.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"duration",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="ip"?ju(e.data,r.version)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"ip",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="jwt"?ec(e.data,r.alg)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"jwt",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="cidr"?tc(e.data,r.version)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"cidr",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="base64"?Yu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"base64",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="base64url"?Zu.test(e.data)||(o=this._getOrReturnCtx(e,o),I(o,{validation:"base64url",code:S.invalid_string,message:r.message}),i.dirty()):Y.assertNever(r);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(o=>e.test(o),{validation:n,code:S.invalid_string,...k.errToObj(i)})}_addCheck(e){return new we({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...k.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...k.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...k.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...k.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...k.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...k.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...k.errToObj(n)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new we({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new we({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new we({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}we.create=t=>new we({checks:[],typeName:$.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...q(t)});function nc(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,o=n>i?n:i,r=Number.parseInt(t.toFixed(o).replace(".","")),l=Number.parseInt(e.toFixed(o).replace(".",""));return r%l/10**o}class He extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){const r=this._getOrReturnCtx(e);return I(r,{code:S.invalid_type,expected:P.number,received:r.parsedType}),G}let i;const o=new le;for(const r of this._def.checks)r.kind==="int"?Y.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),I(i,{code:S.invalid_type,expected:"integer",received:"float",message:r.message}),o.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(i=this._getOrReturnCtx(e,i),I(i,{code:S.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),o.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(i=this._getOrReturnCtx(e,i),I(i,{code:S.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),o.dirty()):r.kind==="multipleOf"?nc(e.data,r.value)!==0&&(i=this._getOrReturnCtx(e,i),I(i,{code:S.not_multiple_of,multipleOf:r.value,message:r.message}),o.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),I(i,{code:S.not_finite,message:r.message}),o.dirty()):Y.assertNever(r);return{status:o.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,k.toString(n))}gt(e,n){return this.setLimit("min",e,!1,k.toString(n))}lte(e,n){return this.setLimit("max",e,!0,k.toString(n))}lt(e,n){return this.setLimit("max",e,!1,k.toString(n))}setLimit(e,n,i,o){return new He({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:k.toString(o)}]})}_addCheck(e){return new He({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Y.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}He.create=t=>new He({checks:[],typeName:$.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...q(t)});class We extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let i;const o=new le;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(i=this._getOrReturnCtx(e,i),I(i,{code:S.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),o.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(i=this._getOrReturnCtx(e,i),I(i,{code:S.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),o.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),I(i,{code:S.not_multiple_of,multipleOf:r.value,message:r.message}),o.dirty()):Y.assertNever(r);return{status:o.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return I(n,{code:S.invalid_type,expected:P.bigint,received:n.parsedType}),G}gte(e,n){return this.setLimit("min",e,!0,k.toString(n))}gt(e,n){return this.setLimit("min",e,!1,k.toString(n))}lte(e,n){return this.setLimit("max",e,!0,k.toString(n))}lt(e,n){return this.setLimit("max",e,!1,k.toString(n))}setLimit(e,n,i,o){return new We({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:k.toString(o)}]})}_addCheck(e){return new We({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}We.create=t=>new We({checks:[],typeName:$.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...q(t)});class yn extends H{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){const i=this._getOrReturnCtx(e);return I(i,{code:S.invalid_type,expected:P.boolean,received:i.parsedType}),G}return pe(e.data)}}yn.create=t=>new yn({typeName:$.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...q(t)});class st extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){const r=this._getOrReturnCtx(e);return I(r,{code:S.invalid_type,expected:P.date,received:r.parsedType}),G}if(Number.isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return I(r,{code:S.invalid_date}),G}const i=new le;let o;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(o=this._getOrReturnCtx(e,o),I(o,{code:S.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),i.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(o=this._getOrReturnCtx(e,o),I(o,{code:S.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),i.dirty()):Y.assertNever(r);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new st({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}st.create=t=>new st({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:$.ZodDate,...q(t)});class Vo extends H{_parse(e){if(this._getType(e)!==P.symbol){const i=this._getOrReturnCtx(e);return I(i,{code:S.invalid_type,expected:P.symbol,received:i.parsedType}),G}return pe(e.data)}}Vo.create=t=>new Vo({typeName:$.ZodSymbol,...q(t)});class $o extends H{_parse(e){if(this._getType(e)!==P.undefined){const i=this._getOrReturnCtx(e);return I(i,{code:S.invalid_type,expected:P.undefined,received:i.parsedType}),G}return pe(e.data)}}$o.create=t=>new $o({typeName:$.ZodUndefined,...q(t)});class Bo extends H{_parse(e){if(this._getType(e)!==P.null){const i=this._getOrReturnCtx(e);return I(i,{code:S.invalid_type,expected:P.null,received:i.parsedType}),G}return pe(e.data)}}Bo.create=t=>new Bo({typeName:$.ZodNull,...q(t)});class Oo extends H{constructor(){super(...arguments),this._any=!0}_parse(e){return pe(e.data)}}Oo.create=t=>new Oo({typeName:$.ZodAny,...q(t)});class mi extends H{constructor(){super(...arguments),this._unknown=!0}_parse(e){return pe(e.data)}}mi.create=t=>new mi({typeName:$.ZodUnknown,...q(t)});class Le extends H{_parse(e){const n=this._getOrReturnCtx(e);return I(n,{code:S.invalid_type,expected:P.never,received:n.parsedType}),G}}Le.create=t=>new Le({typeName:$.ZodNever,...q(t)});class Go extends H{_parse(e){if(this._getType(e)!==P.undefined){const i=this._getOrReturnCtx(e);return I(i,{code:S.invalid_type,expected:P.void,received:i.parsedType}),G}return pe(e.data)}}Go.create=t=>new Go({typeName:$.ZodVoid,...q(t)});class Ae extends H{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),o=this._def;if(n.parsedType!==P.array)return I(n,{code:S.invalid_type,expected:P.array,received:n.parsedType}),G;if(o.exactLength!==null){const l=n.data.length>o.exactLength.value,u=n.data.length<o.exactLength.value;(l||u)&&(I(n,{code:l?S.too_big:S.too_small,minimum:u?o.exactLength.value:void 0,maximum:l?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),i.dirty())}if(o.minLength!==null&&n.data.length<o.minLength.value&&(I(n,{code:S.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),i.dirty()),o.maxLength!==null&&n.data.length>o.maxLength.value&&(I(n,{code:S.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((l,u)=>o.type._parseAsync(new xe(n,l,n.path,u)))).then(l=>le.mergeArray(i,l));const r=[...n.data].map((l,u)=>o.type._parseSync(new xe(n,l,n.path,u)));return le.mergeArray(i,r)}get element(){return this._def.type}min(e,n){return new Ae({...this._def,minLength:{value:e,message:k.toString(n)}})}max(e,n){return new Ae({...this._def,maxLength:{value:e,message:k.toString(n)}})}length(e,n){return new Ae({...this._def,exactLength:{value:e,message:k.toString(n)}})}nonempty(e){return this.min(1,e)}}Ae.create=(t,e)=>new Ae({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$.ZodArray,...q(e)});function je(t){if(t instanceof j){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=Fe.create(je(i))}return new j({...t._def,shape:()=>e})}else return t instanceof Ae?new Ae({...t._def,type:je(t.element)}):t instanceof Fe?Fe.create(je(t.unwrap())):t instanceof lt?lt.create(je(t.unwrap())):t instanceof Ke?Ke.create(t.items.map(e=>je(e))):t}class j extends H{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Y.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==P.object){const c=this._getOrReturnCtx(e);return I(c,{code:S.invalid_type,expected:P.object,received:c.parsedType}),G}const{status:i,ctx:o}=this._processInputParams(e),{shape:r,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof Le&&this._def.unknownKeys==="strip"))for(const c in o.data)l.includes(c)||u.push(c);const d=[];for(const c of l){const f=r[c],h=o.data[c];d.push({key:{status:"valid",value:c},value:f._parse(new xe(o,h,o.path,c)),alwaysSet:c in o.data})}if(this._def.catchall instanceof Le){const c=this._def.unknownKeys;if(c==="passthrough")for(const f of u)d.push({key:{status:"valid",value:f},value:{status:"valid",value:o.data[f]}});else if(c==="strict")u.length>0&&(I(o,{code:S.unrecognized_keys,keys:u}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const f of u){const h=o.data[f];d.push({key:{status:"valid",value:f},value:c._parse(new xe(o,h,o.path,f)),alwaysSet:f in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const c=[];for(const f of d){const h=await f.key,m=await f.value;c.push({key:h,value:m,alwaysSet:f.alwaysSet})}return c}).then(c=>le.mergeObjectSync(i,c)):le.mergeObjectSync(i,d)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new j({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var r,l;const o=((l=(r=this._def).errorMap)==null?void 0:l.call(r,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:k.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new j({...this._def,unknownKeys:"strip"})}passthrough(){return new j({...this._def,unknownKeys:"passthrough"})}extend(e){return new j({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new j({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new j({...this._def,catchall:e})}pick(e){const n={};for(const i of Y.objectKeys(e))e[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new j({...this._def,shape:()=>n})}omit(e){const n={};for(const i of Y.objectKeys(this.shape))e[i]||(n[i]=this.shape[i]);return new j({...this._def,shape:()=>n})}deepPartial(){return je(this)}partial(e){const n={};for(const i of Y.objectKeys(this.shape)){const o=this.shape[i];e&&!e[i]?n[i]=o:n[i]=o.optional()}return new j({...this._def,shape:()=>n})}required(e){const n={};for(const i of Y.objectKeys(this.shape))if(e&&!e[i])n[i]=this.shape[i];else{let r=this.shape[i];for(;r instanceof Fe;)r=r._def.innerType;n[i]=r}return new j({...this._def,shape:()=>n})}keyof(){return La(Y.objectKeys(this.shape))}}j.create=(t,e)=>new j({shape:()=>t,unknownKeys:"strip",catchall:Le.create(),typeName:$.ZodObject,...q(e)});j.strictCreate=(t,e)=>new j({shape:()=>t,unknownKeys:"strict",catchall:Le.create(),typeName:$.ZodObject,...q(e)});j.lazycreate=(t,e)=>new j({shape:t,unknownKeys:"strip",catchall:Le.create(),typeName:$.ZodObject,...q(e)});class _n extends H{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function o(r){for(const u of r)if(u.result.status==="valid")return u.result;for(const u of r)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const l=r.map(u=>new Me(u.ctx.common.issues));return I(n,{code:S.invalid_union,unionErrors:l}),G}if(n.common.async)return Promise.all(i.map(async r=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await r._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(o);{let r;const l=[];for(const d of i){const c={...n,common:{...n.common,issues:[]},parent:null},f=d._parseSync({data:n.data,path:n.path,parent:c});if(f.status==="valid")return f;f.status==="dirty"&&!r&&(r={result:f,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(r)return n.common.issues.push(...r.ctx.common.issues),r.result;const u=l.map(d=>new Me(d));return I(n,{code:S.invalid_union,unionErrors:u}),G}}get options(){return this._def.options}}_n.create=(t,e)=>new _n({options:t,typeName:$.ZodUnion,...q(e)});function pi(t,e){const n=De(t),i=De(e);if(t===e)return{valid:!0,data:t};if(n===P.object&&i===P.object){const o=Y.objectKeys(e),r=Y.objectKeys(t).filter(u=>o.indexOf(u)!==-1),l={...t,...e};for(const u of r){const d=pi(t[u],e[u]);if(!d.valid)return{valid:!1};l[u]=d.data}return{valid:!0,data:l}}else if(n===P.array&&i===P.array){if(t.length!==e.length)return{valid:!1};const o=[];for(let r=0;r<t.length;r++){const l=t[r],u=e[r],d=pi(l,u);if(!d.valid)return{valid:!1};o.push(d.data)}return{valid:!0,data:o}}else return n===P.date&&i===P.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class vn extends H{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),o=(r,l)=>{if(Fo(r)||Fo(l))return G;const u=pi(r.value,l.value);return u.valid?((Lo(r)||Lo(l))&&n.dirty(),{status:n.value,value:u.data}):(I(i,{code:S.invalid_intersection_types}),G)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([r,l])=>o(r,l)):o(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}vn.create=(t,e,n)=>new vn({left:t,right:e,typeName:$.ZodIntersection,...q(n)});class Ke extends H{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.array)return I(i,{code:S.invalid_type,expected:P.array,received:i.parsedType}),G;if(i.data.length<this._def.items.length)return I(i,{code:S.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),G;!this._def.rest&&i.data.length>this._def.items.length&&(I(i,{code:S.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const r=[...i.data].map((l,u)=>{const d=this._def.items[u]||this._def.rest;return d?d._parse(new xe(i,l,i.path,u)):null}).filter(l=>!!l);return i.common.async?Promise.all(r).then(l=>le.mergeArray(n,l)):le.mergeArray(n,r)}get items(){return this._def.items}rest(e){return new Ke({...this._def,rest:e})}}Ke.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ke({items:t,typeName:$.ZodTuple,rest:null,...q(e)})};class Cn extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.object)return I(i,{code:S.invalid_type,expected:P.object,received:i.parsedType}),G;const o=[],r=this._def.keyType,l=this._def.valueType;for(const u in i.data)o.push({key:r._parse(new xe(i,u,i.path,u)),value:l._parse(new xe(i,i.data[u],i.path,u)),alwaysSet:u in i.data});return i.common.async?le.mergeObjectAsync(n,o):le.mergeObjectSync(n,o)}get element(){return this._def.valueType}static create(e,n,i){return n instanceof H?new Cn({keyType:e,valueType:n,typeName:$.ZodRecord,...q(i)}):new Cn({keyType:we.create(),valueType:e,typeName:$.ZodRecord,...q(n)})}}class qo extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.map)return I(i,{code:S.invalid_type,expected:P.map,received:i.parsedType}),G;const o=this._def.keyType,r=this._def.valueType,l=[...i.data.entries()].map(([u,d],c)=>({key:o._parse(new xe(i,u,i.path,[c,"key"])),value:r._parse(new xe(i,d,i.path,[c,"value"]))}));if(i.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const d of l){const c=await d.key,f=await d.value;if(c.status==="aborted"||f.status==="aborted")return G;(c.status==="dirty"||f.status==="dirty")&&n.dirty(),u.set(c.value,f.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const d of l){const c=d.key,f=d.value;if(c.status==="aborted"||f.status==="aborted")return G;(c.status==="dirty"||f.status==="dirty")&&n.dirty(),u.set(c.value,f.value)}return{status:n.value,value:u}}}}qo.create=(t,e,n)=>new qo({valueType:e,keyType:t,typeName:$.ZodMap,...q(n)});class Pt extends H{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.set)return I(i,{code:S.invalid_type,expected:P.set,received:i.parsedType}),G;const o=this._def;o.minSize!==null&&i.data.size<o.minSize.value&&(I(i,{code:S.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),n.dirty()),o.maxSize!==null&&i.data.size>o.maxSize.value&&(I(i,{code:S.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),n.dirty());const r=this._def.valueType;function l(d){const c=new Set;for(const f of d){if(f.status==="aborted")return G;f.status==="dirty"&&n.dirty(),c.add(f.value)}return{status:n.value,value:c}}const u=[...i.data.values()].map((d,c)=>r._parse(new xe(i,d,i.path,c)));return i.common.async?Promise.all(u).then(d=>l(d)):l(u)}min(e,n){return new Pt({...this._def,minSize:{value:e,message:k.toString(n)}})}max(e,n){return new Pt({...this._def,maxSize:{value:e,message:k.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Pt.create=(t,e)=>new Pt({valueType:t,minSize:null,maxSize:null,typeName:$.ZodSet,...q(e)});class gi extends H{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}gi.create=(t,e)=>new gi({getter:t,typeName:$.ZodLazy,...q(e)});class Jo extends H{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return I(n,{received:n.data,code:S.invalid_literal,expected:this._def.value}),G}return{status:"valid",value:e.data}}get value(){return this._def.value}}Jo.create=(t,e)=>new Jo({value:t,typeName:$.ZodLiteral,...q(e)});function La(t,e){return new rt({values:t,typeName:$.ZodEnum,...q(e)})}class rt extends H{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return I(n,{expected:Y.joinValues(i),received:n.parsedType,code:S.invalid_type}),G}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return I(n,{received:n.data,code:S.invalid_enum_value,options:i}),G}return pe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return rt.create(e,{...this._def,...n})}exclude(e,n=this._def){return rt.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}rt.create=La;class Ho extends H{_parse(e){const n=Y.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==P.string&&i.parsedType!==P.number){const o=Y.objectValues(n);return I(i,{expected:Y.joinValues(o),received:i.parsedType,code:S.invalid_type}),G}if(this._cache||(this._cache=new Set(Y.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const o=Y.objectValues(n);return I(i,{received:i.data,code:S.invalid_enum_value,options:o}),G}return pe(e.data)}get enum(){return this._def.values}}Ho.create=(t,e)=>new Ho({values:t,typeName:$.ZodNativeEnum,...q(e)});class Tn extends H{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==P.promise&&n.common.async===!1)return I(n,{code:S.invalid_type,expected:P.promise,received:n.parsedType}),G;const i=n.parsedType===P.promise?n.data:Promise.resolve(n.data);return pe(i.then(o=>this._def.type.parseAsync(o,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Tn.create=(t,e)=>new Tn({type:t,typeName:$.ZodPromise,...q(e)});class at extends H{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),o=this._def.effect||null,r={addIssue:l=>{I(i,l),l.fatal?n.abort():n.dirty()},get path(){return i.path}};if(r.addIssue=r.addIssue.bind(r),o.type==="preprocess"){const l=o.transform(i.data,r);if(i.common.async)return Promise.resolve(l).then(async u=>{if(n.value==="aborted")return G;const d=await this._def.schema._parseAsync({data:u,path:i.path,parent:i});return d.status==="aborted"?G:d.status==="dirty"||n.value==="dirty"?St(d.value):d});{if(n.value==="aborted")return G;const u=this._def.schema._parseSync({data:l,path:i.path,parent:i});return u.status==="aborted"?G:u.status==="dirty"||n.value==="dirty"?St(u.value):u}}if(o.type==="refinement"){const l=u=>{const d=o.refinement(u,r);if(i.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(i.common.async===!1){const u=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?G:(u.status==="dirty"&&n.dirty(),l(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(u=>u.status==="aborted"?G:(u.status==="dirty"&&n.dirty(),l(u.value).then(()=>({status:n.value,value:u.value}))))}if(o.type==="transform")if(i.common.async===!1){const l=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ot(l))return G;const u=o.transform(l.value,r);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(l=>ot(l)?Promise.resolve(o.transform(l.value,r)).then(u=>({status:n.value,value:u})):G);Y.assertNever(o)}}at.create=(t,e,n)=>new at({schema:t,typeName:$.ZodEffects,effect:e,...q(n)});at.createWithPreprocess=(t,e,n)=>new at({schema:e,effect:{type:"preprocess",transform:t},typeName:$.ZodEffects,...q(n)});class Fe extends H{_parse(e){return this._getType(e)===P.undefined?pe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fe.create=(t,e)=>new Fe({innerType:t,typeName:$.ZodOptional,...q(e)});class lt extends H{_parse(e){return this._getType(e)===P.null?pe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}lt.create=(t,e)=>new lt({innerType:t,typeName:$.ZodNullable,...q(e)});class yi extends H{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===P.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}yi.create=(t,e)=>new yi({innerType:t,typeName:$.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...q(e)});class _i extends H{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},o=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return gn(o)?o.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Me(i.common.issues)},input:i.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Me(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}_i.create=(t,e)=>new _i({innerType:t,typeName:$.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...q(e)});class Wo extends H{_parse(e){if(this._getType(e)!==P.nan){const i=this._getOrReturnCtx(e);return I(i,{code:S.invalid_type,expected:P.nan,received:i.parsedType}),G}return{status:"valid",value:e.data}}}Wo.create=t=>new Wo({typeName:$.ZodNaN,...q(t)});class ic extends H{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class Qi extends H{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?G:r.status==="dirty"?(n.dirty(),St(r.value)):this._def.out._parseAsync({data:r.value,path:i.path,parent:i})})();{const o=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?G:o.status==="dirty"?(n.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:i.path,parent:i})}}static create(e,n){return new Qi({in:e,out:n,typeName:$.ZodPipeline})}}class vi extends H{_parse(e){const n=this._def.innerType._parse(e),i=o=>(ot(o)&&(o.value=Object.freeze(o.value)),o);return gn(n)?n.then(o=>i(o)):i(n)}unwrap(){return this._def.innerType}}vi.create=(t,e)=>new vi({innerType:t,typeName:$.ZodReadonly,...q(e)});var $;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($||($={}));const $e=we.create,Ko=He.create;We.create;const oc=yn.create;st.create;const Yo=mi.create;Le.create;const At=Ae.create,sc=j.create,rc=_n.create;vn.create;Ke.create;const ac=Cn.create,lc=gi.create,uc=rt.create;Tn.create;Fe.create;lt.create;const ze={string:t=>we.create({...t,coerce:!0}),number:t=>He.create({...t,coerce:!0}),boolean:t=>yn.create({...t,coerce:!0}),bigint:t=>We.create({...t,coerce:!0}),date:t=>st.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cc,dc;function fc(){return{geminiUrl:cc,vertexUrl:dc}}function hc(t,e,n){var i,o,r;if(!(!((i=t.httpOptions)===null||i===void 0)&&i.baseUrl)){const l=fc();return t.vertexai?(o=l.vertexUrl)!==null&&o!==void 0?o:e:(r=l.geminiUrl)!==null&&r!==void 0?r:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dt{}function F(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const r=e[o];return r!=null?String(r):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function a(t,e,n){for(let r=0;r<e.length-1;r++){const l=e[r];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[u])){const d=t[u];if(Array.isArray(n))for(let c=0;c<d.length;c++){const f=d[c];a(f,e.slice(r+1),n[c])}else for(const c of d)a(c,e.slice(r+1),n)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in t||(t[u]=[{}]);const d=t[u];a(d[0],e.slice(r+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const i=e[e.length-1],o=t[i];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else t[i]=n}function s(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const i=e[n];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in t){const r=t[o];return Array.isArray(r)?r.map(l=>s(l,e.slice(n+1))):void 0}else return}else t=t[i]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Zo;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Zo||(Zo={}));var zo;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(zo||(zo={}));var Se;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Se||(Se={}));var Xo;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Xo||(Xo={}));var Qo;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Qo||(Qo={}));var jo;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(jo||(jo={}));var es;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(es||(es={}));var ts;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(ts||(ts={}));var ns;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(ns||(ns={}));var is;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(is||(is={}));var os;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(os||(os={}));var ss;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(ss||(ss={}));var rs;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(rs||(rs={}));var wn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(wn||(wn={}));var as;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(as||(as={}));var Ci;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ci||(Ci={}));var ls;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ls||(ls={}));var us;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(us||(us={}));var cs;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(cs||(cs={}));var ds;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ds||(ds={}));var fs;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(fs||(fs={}));var hs;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(hs||(hs={}));var ms;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(ms||(ms={}));var ps;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(ps||(ps={}));var gs;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(gs||(gs={}));var ys;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ys||(ys={}));var _s;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(_s||(_s={}));var vs;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(vs||(vs={}));var Cs;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Cs||(Cs={}));var Ts;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Ts||(Ts={}));var ws;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(ws||(ws={}));var Ss;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Ss||(Ss={}));var As;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(As||(As={}));var xs;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(xs||(xs={}));var Es;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Es||(Es={}));var Is;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Is||(Is={}));var Ms;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Ms||(Ms={}));var Rs;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Rs||(Rs={}));var tt;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(tt||(tt={}));class Ti{constructor(e){const n={};for(const i of e.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class mt{get text(){var e,n,i,o,r,l,u,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const h=[];for(const m of(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[p,g]of Object.entries(m))p!=="text"&&p!=="thought"&&(g!==null||g!==void 0)&&h.push(p);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,c+=m.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,n,i,o,r,l,u,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const h of(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,p]of Object.entries(h))m!=="inlineData"&&(p!==null||p!==void 0)&&f.push(m);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,i,o,r,l,u,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,n,i,o,r,l,u,d,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,i,o,r,l,u,d,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class Ps{}class ks{}class mc{}class pc{}class Ns{}class bs{}class Ds{}class gc{}class Fs{}class Ls{}class Us{}class yc{}class _c{}class vc{}class Cc{get text(){var e,n,i;let o="",r=!1;const l=[];for(const u of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;r=!0,o+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?o:void 0}get data(){var e,n,i;let o="";const r=[];for(const l of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&r.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(o+=atob(l.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class Tc{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Ua(t,e){const n=z(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Va(t){return Array.isArray(t)?t.map(e=>Sn(e)):[Sn(t)]}function Sn(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function wc(t){const e=Sn(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Sc(t){const e=Sn(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Vs(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function $a(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Vs(e)):[Vs(t)]}function wi(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function $s(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Bs(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ae(t){if(t==null)throw new Error("ContentUnion is required");return wi(t)?t:{role:"user",parts:$a(t)}}function Ba(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const i=ae(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(t.isVertexAI()){const n=ae(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ae(n)):[ae(e)]}function _e(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if($s(t)||Bs(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ae(t)]}const e=[],n=[],i=wi(t[0]);for(const o of t){const r=wi(o);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(o);else{if($s(o)||Bs(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return i||e.push({role:"user",parts:$a(n)}),e}const Ac=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),Os=uc(["string","number","integer","object","array","boolean","null"]),xc=rc([Os,At(Os)]);function Ec(t=!0){const e=lc(()=>{const n=sc({type:xc.optional(),format:$e().optional(),title:$e().optional(),description:$e().optional(),default:Yo().optional(),items:e.optional(),minItems:ze.string().optional(),maxItems:ze.string().optional(),enum:At(Yo()).optional(),properties:ac($e(),e).optional(),required:At($e()).optional(),minProperties:ze.string().optional(),maxProperties:ze.string().optional(),propertyOrdering:At($e()).optional(),minimum:Ko().optional(),maximum:Ko().optional(),minLength:ze.string().optional(),maxLength:ze.string().optional(),pattern:$e().optional(),anyOf:At(e).optional(),additionalProperties:oc().optional()});return t?n.strict():n});return e}function Ic(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(i=>i!=="null");if(n.length===1)e.type=Object.values(Se).includes(n[0].toUpperCase())?n[0].toUpperCase():Se.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of n)e.anyOf.push({type:Object.values(Se).includes(i.toUpperCase())?i.toUpperCase():Se.TYPE_UNSPECIFIED})}}function nt(t){const e={},n=["items"],i=["anyOf"],o=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=t.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,t=r[1]):r[1].type==="null"&&(e.nullable=!0,t=r[0])),t.type instanceof Array&&Ic(t.type,e);for(const[l,u]of Object.entries(t))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Se).includes(u.toUpperCase())?u.toUpperCase():Se.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=nt(u);else if(i.includes(l)){const d=[];for(const c of u){if(c.type=="null"){e.nullable=!0;continue}d.push(nt(c))}e[l]=d}else if(o.includes(l)){const d={};for(const[c,f]of Object.entries(u))d[c]=nt(f);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function An(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=Ec().parse(t);return nt(e)}else return nt(t)}function Oa(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function ji(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ft(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=An(e.parameters)),e.response&&(e.response=An(e.response));return t}function Lt(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Mc(t,e,n,i=1){const o=!e.startsWith(`${n}/`)&&e.split("/").length===i;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:o?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:o?`${n}/${e}`:e}function Ue(t,e){if(typeof e!="string")throw new Error("name must be a string");return Mc(t,e,"cachedContents")}function Ga(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Re(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Rc(t){return t!=null&&typeof t=="object"&&"name"in t}function Pc(t){return t!=null&&typeof t=="object"&&"video"in t}function kc(t){return t!=null&&typeof t=="object"&&"uri"in t}function qa(t){var e;let n;if(Rc(t)&&(n=t.name),!(kc(t)&&(n=t.uri,n===void 0))&&!(Pc(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Ja(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Ha(t){for(const e of["models","tunedModels","publisherModels"])if(Nc(t,e))return t[e];return[]}function Nc(t,e){return t!==null&&typeof t=="object"&&e in t}function bc(t,e={}){const n=t,i={name:n.name,description:n.description,parameters:nt(Ln(n.inputSchema))};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Dc(t,e={}){const n=[],i=new Set;for(const o of t){const r=o.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const l=bc(o,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function Fc(t){const e=[];for(const n of t)e.push(Ln(n));return e}function Lc(t){const e={};for(const[n,i]of Object.entries(t)){const o=i;e[n]=Ln(o)}return e}function Ln(t){const e=new Set(["items"]),n=new Set(["anyOf"]),i=new Set(["properties"]),o={};for(const[r,l]of Object.entries(t))if(e.has(r))o[r]=Ln(l);else if(n.has(r))o[r]=Fc(l);else if(i.has(r))o[r]=Lc(l);else if(r==="type"){const u=l.toUpperCase();o[r]=Object.values(Se).includes(u)?u:Se.TYPE_UNSPECIFIED}else Ac.has(r)&&(o[r]=l);return o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uc(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Vc(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function $c(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Bc(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Uc(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Vc(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],$c(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Gs(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Bc(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Oc(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function Gc(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function qc(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Gc(n)),e}function Jc(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function Hc(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Jc(n)),e}function Wc(){return{}}function Kc(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>Oc(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],qc(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],Hc(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],Wc());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function Yc(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function Zc(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function zc(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],Zc(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function Xc(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],Yc(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],zc(i)),e}function Qc(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);e!==void 0&&o!=null&&a(e,["expireTime"],o);const r=s(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const l=s(t,["contents"]);if(e!==void 0&&l!=null){let f=_e(l);Array.isArray(f)&&(f=f.map(h=>Gs(h))),a(e,["contents"],f)}const u=s(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Gs(ae(u)));const d=s(t,["tools"]);if(e!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(h=>Kc(h))),a(e,["tools"],f)}const c=s(t,["toolConfig"]);if(e!==void 0&&c!=null&&a(e,["toolConfig"],Xc(c)),s(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function jc(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["model"],Ua(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Qc(o,n)),n}function ed(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ue(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function td(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ue(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function nd(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);return e!==void 0&&o!=null&&a(e,["expireTime"],o),n}function id(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ue(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],nd(o,n)),n}function od(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);return e!==void 0&&o!=null&&a(e,["_query","pageToken"],o),n}function sd(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],od(n,e)),e}function rd(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function ad(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function ld(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function ud(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],rd(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],ad(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],ld(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function qs(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>ud(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function cd(t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&a(e,["description"],n);const i=s(t,["name"]);i!=null&&a(e,["name"],i);const o=s(t,["parameters"]);o!=null&&a(e,["parameters"],o);const r=s(t,["parametersJsonSchema"]);r!=null&&a(e,["parametersJsonSchema"],r);const l=s(t,["response"]);l!=null&&a(e,["response"],l);const u=s(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function dd(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function fd(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],dd(n)),e}function hd(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function md(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],hd(n)),e}function pd(){return{}}function gd(t){const e={},n=s(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function yd(t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],gd(n));const i=s(t,["authType"]);i!=null&&a(e,["authType"],i);const o=s(t,["googleServiceAccountConfig"]);o!=null&&a(e,["googleServiceAccountConfig"],o);const r=s(t,["httpBasicAuthConfig"]);r!=null&&a(e,["httpBasicAuthConfig"],r);const l=s(t,["oauthConfig"]);l!=null&&a(e,["oauthConfig"],l);const u=s(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function _d(t){const e={},n=s(t,["authConfig"]);return n!=null&&a(e,["authConfig"],yd(n)),e}function vd(){return{}}function Cd(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>cd(h))),a(e,["functionDeclarations"],f)}const i=s(t,["retrieval"]);i!=null&&a(e,["retrieval"],i);const o=s(t,["googleSearch"]);o!=null&&a(e,["googleSearch"],fd(o));const r=s(t,["googleSearchRetrieval"]);r!=null&&a(e,["googleSearchRetrieval"],md(r)),s(t,["enterpriseWebSearch"])!=null&&a(e,["enterpriseWebSearch"],pd());const u=s(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],_d(u)),s(t,["urlContext"])!=null&&a(e,["urlContext"],vd());const c=s(t,["codeExecution"]);return c!=null&&a(e,["codeExecution"],c),e}function Td(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function wd(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function Sd(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],wd(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function Ad(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],Td(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],Sd(i)),e}function xd(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);e!==void 0&&o!=null&&a(e,["expireTime"],o);const r=s(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const l=s(t,["contents"]);if(e!==void 0&&l!=null){let h=_e(l);Array.isArray(h)&&(h=h.map(m=>qs(m))),a(e,["contents"],h)}const u=s(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],qs(ae(u)));const d=s(t,["tools"]);if(e!==void 0&&d!=null){let h=d;Array.isArray(h)&&(h=h.map(m=>Cd(m))),a(e,["tools"],h)}const c=s(t,["toolConfig"]);e!==void 0&&c!=null&&a(e,["toolConfig"],Ad(c));const f=s(t,["kmsKeyName"]);return e!==void 0&&f!=null&&a(e,["encryption_spec","kmsKeyName"],f),n}function Ed(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["model"],Ua(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],xd(o,n)),n}function Id(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ue(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Md(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ue(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Rd(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);return e!==void 0&&o!=null&&a(e,["expireTime"],o),n}function Pd(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ue(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Rd(o,n)),n}function kd(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);return e!==void 0&&o!=null&&a(e,["_query","pageToken"],o),n}function Nd(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],kd(n,e)),e}function sn(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["model"]);o!=null&&a(e,["model"],o);const r=s(t,["createTime"]);r!=null&&a(e,["createTime"],r);const l=s(t,["updateTime"]);l!=null&&a(e,["updateTime"],l);const u=s(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const d=s(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function bd(){return{}}function Dd(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>sn(r))),a(e,["cachedContents"],o)}return e}function rn(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["model"]);o!=null&&a(e,["model"],o);const r=s(t,["createTime"]);r!=null&&a(e,["createTime"],r);const l=s(t,["updateTime"]);l!=null&&a(e,["updateTime"],l);const u=s(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const d=s(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function Fd(){return{}}function Ld(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>rn(r))),a(e,["cachedContents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ut;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(ut||(ut={}));class Un{constructor(e,n,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,i,o)}init(e,n,i){var o,r;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};i?typeof i=="object"?l=Object.assign({},i):l=i:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(r=(o=l.config)===null||o===void 0?void 0:o.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ud extends dt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Un(ut.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ed(this.apiClient,e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>rn(f))}else{const c=jc(this.apiClient,e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>sn(f))}}async get(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Id(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>rn(f))}else{const c=ed(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>sn(f))}}async delete(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Md(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Fd(),h=new Ls;return Object.assign(h,f),h})}else{const c=td(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(()=>{const f=bd(),h=new Ls;return Object.assign(h,f),h})}}async update(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Pd(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>rn(f))}else{const c=id(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>sn(f))}}async listInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Nd(e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Ld(f),m=new Us;return Object.assign(m,h),m})}else{const c=sd(e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Dd(f),m=new Us;return Object.assign(m,h),m})}}}function Js(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(t){return this instanceof X?(this.v=t,this):new X(t)}function it(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),o[Symbol.asyncIterator]=function(){return this},o;function l(p){return function(g){return Promise.resolve(g).then(p,h)}}function u(p,g){i[p]&&(o[p]=function(y){return new Promise(function(v,x){r.push([p,y,v,x])>1||d(p,y)})},g&&(o[p]=g(o[p])))}function d(p,g){try{c(i[p](g))}catch(y){m(r[0][3],y)}}function c(p){p.value instanceof X?Promise.resolve(p.value.v).then(f,h):m(r[0][2],p)}function f(p){d("next",p)}function h(p){d("throw",p)}function m(p,g){p(g),r.shift(),r.length&&d(r[0][0],r[0][1])}}function Mt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Js=="function"?Js(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(r){n[r]=t[r]&&function(l){return new Promise(function(u,d){l=t[r](l),o(u,d,l.done,l.value)})}}function o(r,l,u,d){Promise.resolve(d).then(function(c){r({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vd(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Wa(n)}function Wa(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function $d(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Hs(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let i=0;for(;i<n;)if(t[i].role==="user")e.push(t[i]),i++;else{const o=[];let r=!0;for(;i<n&&t[i].role==="model";)o.push(t[i]),r&&!Wa(t[i])&&(r=!1),i++;r?e.push(...o):e.pop()}return e}class Bd{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new Od(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Od{constructor(e,n,i,o={},r=[]){this.apiClient=e,this.modelsModule=n,this.model=i,this.config=o,this.history=r,this.sendPromise=Promise.resolve(),$d(r)}async sendMessage(e){var n;await this.sendPromise;const i=ae(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var r,l,u;const d=await o,c=(l=(r=d.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content,f=d.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let m=[];f!=null&&(m=(u=f.slice(h))!==null&&u!==void 0?u:[]);const p=c?[c]:[];this.recordHistory(i,p,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var n;await this.sendPromise;const i=ae(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const r=await o;return this.processStreamResponse(r,i)}getHistory(e=!1){const n=e?Hs(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var i,o;return it(this,arguments,function*(){var l,u,d,c;const f=[];try{for(var h=!0,m=Mt(e),p;p=yield X(m.next()),l=p.done,!l;h=!0){c=p.value,h=!1;const g=c;if(Vd(g)){const y=(o=(i=g.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;y!==void 0&&f.push(y)}yield yield X(g)}}catch(g){u={error:g}}finally{try{!h&&!l&&(d=m.return)&&(yield X(d.call(m)))}finally{if(u)throw u.error}}this.recordHistory(n,f)})}recordHistory(e,n,i){let o=[];n.length>0&&n.every(r=>r.role!==void 0)?o=n:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...Hs(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vn extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Vn.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gd(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);return e!==void 0&&o!=null&&a(e,["_query","pageToken"],o),n}function qd(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],Gd(n,e)),e}function Jd(t){const e={},n=s(t,["details"]);n!=null&&a(e,["details"],n);const i=s(t,["message"]);i!=null&&a(e,["message"],i);const o=s(t,["code"]);return o!=null&&a(e,["code"],o),e}function Hd(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["mimeType"]);o!=null&&a(e,["mimeType"],o);const r=s(t,["sizeBytes"]);r!=null&&a(e,["sizeBytes"],r);const l=s(t,["createTime"]);l!=null&&a(e,["createTime"],l);const u=s(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const d=s(t,["updateTime"]);d!=null&&a(e,["updateTime"],d);const c=s(t,["sha256Hash"]);c!=null&&a(e,["sha256Hash"],c);const f=s(t,["uri"]);f!=null&&a(e,["uri"],f);const h=s(t,["downloadUri"]);h!=null&&a(e,["downloadUri"],h);const m=s(t,["state"]);m!=null&&a(e,["state"],m);const p=s(t,["source"]);p!=null&&a(e,["source"],p);const g=s(t,["videoMetadata"]);g!=null&&a(e,["videoMetadata"],g);const y=s(t,["error"]);return y!=null&&a(e,["error"],Jd(y)),e}function Wd(t){const e={},n=s(t,["file"]);n!=null&&a(e,["file"],Hd(n));const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Kd(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","file"],qa(n));const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Yd(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","file"],qa(n));const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Zd(t){const e={},n=s(t,["details"]);n!=null&&a(e,["details"],n);const i=s(t,["message"]);i!=null&&a(e,["message"],i);const o=s(t,["code"]);return o!=null&&a(e,["code"],o),e}function Si(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["mimeType"]);o!=null&&a(e,["mimeType"],o);const r=s(t,["sizeBytes"]);r!=null&&a(e,["sizeBytes"],r);const l=s(t,["createTime"]);l!=null&&a(e,["createTime"],l);const u=s(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const d=s(t,["updateTime"]);d!=null&&a(e,["updateTime"],d);const c=s(t,["sha256Hash"]);c!=null&&a(e,["sha256Hash"],c);const f=s(t,["uri"]);f!=null&&a(e,["uri"],f);const h=s(t,["downloadUri"]);h!=null&&a(e,["downloadUri"],h);const m=s(t,["state"]);m!=null&&a(e,["state"],m);const p=s(t,["source"]);p!=null&&a(e,["source"],p);const g=s(t,["videoMetadata"]);g!=null&&a(e,["videoMetadata"],g);const y=s(t,["error"]);return y!=null&&a(e,["error"],Zd(y)),e}function zd(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>Si(r))),a(e,["files"],o)}return e}function Xd(){return{}}function Qd(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jd extends dt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Un(ut.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Si(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qd(e);return r=F("files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=zd(d),f=new yc;return Object.assign(f,c),f})}}async createInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Wd(e);return r=F("upload/v1beta/files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Xd(),c=new _c;return Object.assign(c,d),c})}}async get(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Kd(e);return r=F("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Si(d))}}async delete(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Yd(e);return r=F("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Qd(),c=new vc;return Object.assign(c,d),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ef(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function tf(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function Ka(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],ef(n)),e}function nf(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],tf(n)),e}function of(t){const e={},n=s(t,["speaker"]);n!=null&&a(e,["speaker"],n);const i=s(t,["voiceConfig"]);return i!=null&&a(e,["voiceConfig"],Ka(i)),e}function sf(t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>of(o))),a(e,["speakerVoiceConfigs"],i)}return e}function rf(t){const e={},n=s(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],Ka(n));const i=s(t,["multiSpeakerVoiceConfig"]);i!=null&&a(e,["multiSpeakerVoiceConfig"],sf(i));const o=s(t,["languageCode"]);return o!=null&&a(e,["languageCode"],o),e}function af(t){const e={},n=s(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],nf(n)),s(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function lf(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function uf(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function cf(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function df(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function ff(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function hf(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function mf(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],lf(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],cf(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],ff(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function pf(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],uf(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],df(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],hf(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function gf(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>mf(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function yf(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>pf(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function _f(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function vf(t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&a(e,["description"],n);const i=s(t,["name"]);i!=null&&a(e,["name"],i);const o=s(t,["parameters"]);o!=null&&a(e,["parameters"],o);const r=s(t,["parametersJsonSchema"]);r!=null&&a(e,["parametersJsonSchema"],r);const l=s(t,["response"]);l!=null&&a(e,["response"],l);const u=s(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function Cf(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Tf(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function wf(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Cf(n)),e}function Sf(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Tf(n)),e}function Af(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function xf(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function Ef(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Af(n)),e}function If(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],xf(n)),e}function Mf(){return{}}function Rf(t){const e={},n=s(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function Pf(t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],Rf(n));const i=s(t,["authType"]);i!=null&&a(e,["authType"],i);const o=s(t,["googleServiceAccountConfig"]);o!=null&&a(e,["googleServiceAccountConfig"],o);const r=s(t,["httpBasicAuthConfig"]);r!=null&&a(e,["httpBasicAuthConfig"],r);const l=s(t,["oauthConfig"]);l!=null&&a(e,["oauthConfig"],l);const u=s(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function kf(t){const e={},n=s(t,["authConfig"]);return n!=null&&a(e,["authConfig"],Pf(n)),e}function Nf(){return{}}function bf(){return{}}function Df(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>_f(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],wf(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],Ef(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],Nf());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function Ff(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>vf(h))),a(e,["functionDeclarations"],f)}const i=s(t,["retrieval"]);i!=null&&a(e,["retrieval"],i);const o=s(t,["googleSearch"]);o!=null&&a(e,["googleSearch"],Sf(o));const r=s(t,["googleSearchRetrieval"]);r!=null&&a(e,["googleSearchRetrieval"],If(r)),s(t,["enterpriseWebSearch"])!=null&&a(e,["enterpriseWebSearch"],Mf());const u=s(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],kf(u)),s(t,["urlContext"])!=null&&a(e,["urlContext"],bf());const c=s(t,["codeExecution"]);return c!=null&&a(e,["codeExecution"],c),e}function Lf(t){const e={},n=s(t,["handle"]);if(n!=null&&a(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Uf(t){const e={},n=s(t,["handle"]);n!=null&&a(e,["handle"],n);const i=s(t,["transparent"]);return i!=null&&a(e,["transparent"],i),e}function Ws(){return{}}function Ks(){return{}}function Vf(t){const e={},n=s(t,["disabled"]);n!=null&&a(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&a(e,["startOfSpeechSensitivity"],i);const o=s(t,["endOfSpeechSensitivity"]);o!=null&&a(e,["endOfSpeechSensitivity"],o);const r=s(t,["prefixPaddingMs"]);r!=null&&a(e,["prefixPaddingMs"],r);const l=s(t,["silenceDurationMs"]);return l!=null&&a(e,["silenceDurationMs"],l),e}function $f(t){const e={},n=s(t,["disabled"]);n!=null&&a(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&a(e,["startOfSpeechSensitivity"],i);const o=s(t,["endOfSpeechSensitivity"]);o!=null&&a(e,["endOfSpeechSensitivity"],o);const r=s(t,["prefixPaddingMs"]);r!=null&&a(e,["prefixPaddingMs"],r);const l=s(t,["silenceDurationMs"]);return l!=null&&a(e,["silenceDurationMs"],l),e}function Bf(t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],Vf(n));const i=s(t,["activityHandling"]);i!=null&&a(e,["activityHandling"],i);const o=s(t,["turnCoverage"]);return o!=null&&a(e,["turnCoverage"],o),e}function Of(t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],$f(n));const i=s(t,["activityHandling"]);i!=null&&a(e,["activityHandling"],i);const o=s(t,["turnCoverage"]);return o!=null&&a(e,["turnCoverage"],o),e}function Gf(t){const e={},n=s(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function qf(t){const e={},n=s(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function Jf(t){const e={},n=s(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&a(e,["slidingWindow"],Gf(i)),e}function Hf(t){const e={},n=s(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&a(e,["slidingWindow"],qf(i)),e}function Wf(t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function Kf(t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function Yf(t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig"],i);const o=s(t,["responseModalities"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","responseModalities"],o);const r=s(t,["temperature"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig","temperature"],r);const l=s(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=s(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=s(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=s(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=s(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],rf(ji(h)));const m=s(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const p=s(t,["systemInstruction"]);e!==void 0&&p!=null&&a(e,["setup","systemInstruction"],gf(ae(p)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let M=Lt(g);Array.isArray(M)&&(M=M.map(D=>Df(Ft(D)))),a(e,["setup","tools"],M)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&a(e,["setup","sessionResumption"],Lf(y));const v=s(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&a(e,["setup","inputAudioTranscription"],Ws());const x=s(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&a(e,["setup","outputAudioTranscription"],Ws());const C=s(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&a(e,["setup","realtimeInputConfig"],Bf(C));const w=s(t,["contextWindowCompression"]);e!==void 0&&w!=null&&a(e,["setup","contextWindowCompression"],Jf(w));const T=s(t,["proactivity"]);return e!==void 0&&T!=null&&a(e,["setup","proactivity"],Wf(T)),n}function Zf(t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig"],i);const o=s(t,["responseModalities"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","responseModalities"],o);const r=s(t,["temperature"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig","temperature"],r);const l=s(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=s(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=s(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=s(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=s(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],af(ji(h)));const m=s(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const p=s(t,["systemInstruction"]);e!==void 0&&p!=null&&a(e,["setup","systemInstruction"],yf(ae(p)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let M=Lt(g);Array.isArray(M)&&(M=M.map(D=>Ff(Ft(D)))),a(e,["setup","tools"],M)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&a(e,["setup","sessionResumption"],Uf(y));const v=s(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&a(e,["setup","inputAudioTranscription"],Ks());const x=s(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&a(e,["setup","outputAudioTranscription"],Ks());const C=s(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&a(e,["setup","realtimeInputConfig"],Of(C));const w=s(t,["contextWindowCompression"]);e!==void 0&&w!=null&&a(e,["setup","contextWindowCompression"],Hf(w));const T=s(t,["proactivity"]);return e!==void 0&&T!=null&&a(e,["setup","proactivity"],Kf(T)),n}function zf(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["setup","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Yf(o,n)),n}function Xf(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["setup","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Zf(o,n)),n}function Qf(){return{}}function jf(){return{}}function eh(){return{}}function th(){return{}}function nh(t){const e={},n=s(t,["media"]);n!=null&&a(e,["mediaChunks"],Va(n));const i=s(t,["audio"]);i!=null&&a(e,["audio"],Sc(i));const o=s(t,["audioStreamEnd"]);o!=null&&a(e,["audioStreamEnd"],o);const r=s(t,["video"]);r!=null&&a(e,["video"],wc(r));const l=s(t,["text"]);return l!=null&&a(e,["text"],l),s(t,["activityStart"])!=null&&a(e,["activityStart"],Qf()),s(t,["activityEnd"])!=null&&a(e,["activityEnd"],eh()),e}function ih(t){const e={},n=s(t,["media"]);if(n!=null&&a(e,["mediaChunks"],Va(n)),s(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=s(t,["audioStreamEnd"]);if(i!=null&&a(e,["audioStreamEnd"],i),s(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(s(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return s(t,["activityStart"])!=null&&a(e,["activityStart"],jf()),s(t,["activityEnd"])!=null&&a(e,["activityEnd"],th()),e}function Ya(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["weight"]);return i!=null&&a(e,["weight"],i),e}function oh(t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Ya(o))),a(e,["weightedPrompts"],i)}return e}function Za(t){const e={},n=s(t,["temperature"]);n!=null&&a(e,["temperature"],n);const i=s(t,["topK"]);i!=null&&a(e,["topK"],i);const o=s(t,["seed"]);o!=null&&a(e,["seed"],o);const r=s(t,["guidance"]);r!=null&&a(e,["guidance"],r);const l=s(t,["bpm"]);l!=null&&a(e,["bpm"],l);const u=s(t,["density"]);u!=null&&a(e,["density"],u);const d=s(t,["brightness"]);d!=null&&a(e,["brightness"],d);const c=s(t,["scale"]);c!=null&&a(e,["scale"],c);const f=s(t,["muteBass"]);f!=null&&a(e,["muteBass"],f);const h=s(t,["muteDrums"]);h!=null&&a(e,["muteDrums"],h);const m=s(t,["onlyBassAndDrums"]);return m!=null&&a(e,["onlyBassAndDrums"],m),e}function sh(t){const e={},n=s(t,["musicGenerationConfig"]);return n!=null&&a(e,["musicGenerationConfig"],Za(n)),e}function za(t){const e={},n=s(t,["model"]);return n!=null&&a(e,["model"],n),e}function Xa(t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Ya(o))),a(e,["weightedPrompts"],i)}return e}function Ai(t){const e={},n=s(t,["setup"]);n!=null&&a(e,["setup"],za(n));const i=s(t,["clientContent"]);i!=null&&a(e,["clientContent"],Xa(i));const o=s(t,["musicGenerationConfig"]);o!=null&&a(e,["musicGenerationConfig"],Za(o));const r=s(t,["playbackControl"]);return r!=null&&a(e,["playbackControl"],r),e}function rh(){return{}}function ah(){return{}}function lh(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function uh(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function ch(t){const e={},n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function dh(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function fh(t){const e={},n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function hh(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function mh(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],lh(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],ch(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],fh(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function ph(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],uh(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],dh(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],hh(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function gh(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>mh(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function yh(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>ph(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Ys(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["finished"]);return i!=null&&a(e,["finished"],i),e}function Zs(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["finished"]);return i!=null&&a(e,["finished"],i),e}function _h(t){const e={},n=s(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const i=s(t,["urlRetrievalStatus"]);return i!=null&&a(e,["urlRetrievalStatus"],i),e}function vh(t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>_h(o))),a(e,["urlMetadata"],i)}return e}function Ch(t){const e={},n=s(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],gh(n));const i=s(t,["turnComplete"]);i!=null&&a(e,["turnComplete"],i);const o=s(t,["interrupted"]);o!=null&&a(e,["interrupted"],o);const r=s(t,["groundingMetadata"]);r!=null&&a(e,["groundingMetadata"],r);const l=s(t,["generationComplete"]);l!=null&&a(e,["generationComplete"],l);const u=s(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],Ys(u));const d=s(t,["outputTranscription"]);d!=null&&a(e,["outputTranscription"],Ys(d));const c=s(t,["urlContextMetadata"]);return c!=null&&a(e,["urlContextMetadata"],vh(c)),e}function Th(t){const e={},n=s(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],yh(n));const i=s(t,["turnComplete"]);i!=null&&a(e,["turnComplete"],i);const o=s(t,["interrupted"]);o!=null&&a(e,["interrupted"],o);const r=s(t,["groundingMetadata"]);r!=null&&a(e,["groundingMetadata"],r);const l=s(t,["generationComplete"]);l!=null&&a(e,["generationComplete"],l);const u=s(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],Zs(u));const d=s(t,["outputTranscription"]);return d!=null&&a(e,["outputTranscription"],Zs(d)),e}function wh(t){const e={},n=s(t,["id"]);n!=null&&a(e,["id"],n);const i=s(t,["args"]);i!=null&&a(e,["args"],i);const o=s(t,["name"]);return o!=null&&a(e,["name"],o),e}function Sh(t){const e={},n=s(t,["args"]);n!=null&&a(e,["args"],n);const i=s(t,["name"]);return i!=null&&a(e,["name"],i),e}function Ah(t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>wh(o))),a(e,["functionCalls"],i)}return e}function xh(t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Sh(o))),a(e,["functionCalls"],i)}return e}function Eh(t){const e={},n=s(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function Ih(t){const e={},n=s(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function Kt(t){const e={},n=s(t,["modality"]);n!=null&&a(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&a(e,["tokenCount"],i),e}function Yt(t){const e={},n=s(t,["modality"]);n!=null&&a(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&a(e,["tokenCount"],i),e}function Mh(t){const e={},n=s(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&a(e,["cachedContentTokenCount"],i);const o=s(t,["responseTokenCount"]);o!=null&&a(e,["responseTokenCount"],o);const r=s(t,["toolUsePromptTokenCount"]);r!=null&&a(e,["toolUsePromptTokenCount"],r);const l=s(t,["thoughtsTokenCount"]);l!=null&&a(e,["thoughtsTokenCount"],l);const u=s(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const d=s(t,["promptTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(p=>Kt(p))),a(e,["promptTokensDetails"],m)}const c=s(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(p=>Kt(p))),a(e,["cacheTokensDetails"],m)}const f=s(t,["responseTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(p=>Kt(p))),a(e,["responseTokensDetails"],m)}const h=s(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(p=>Kt(p))),a(e,["toolUsePromptTokensDetails"],m)}return e}function Rh(t){const e={},n=s(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&a(e,["cachedContentTokenCount"],i);const o=s(t,["candidatesTokenCount"]);o!=null&&a(e,["responseTokenCount"],o);const r=s(t,["toolUsePromptTokenCount"]);r!=null&&a(e,["toolUsePromptTokenCount"],r);const l=s(t,["thoughtsTokenCount"]);l!=null&&a(e,["thoughtsTokenCount"],l);const u=s(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const d=s(t,["promptTokensDetails"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(g=>Yt(g))),a(e,["promptTokensDetails"],p)}const c=s(t,["cacheTokensDetails"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(g=>Yt(g))),a(e,["cacheTokensDetails"],p)}const f=s(t,["candidatesTokensDetails"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>Yt(g))),a(e,["responseTokensDetails"],p)}const h=s(t,["toolUsePromptTokensDetails"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(g=>Yt(g))),a(e,["toolUsePromptTokensDetails"],p)}const m=s(t,["trafficType"]);return m!=null&&a(e,["trafficType"],m),e}function Ph(t){const e={},n=s(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function kh(t){const e={},n=s(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function Nh(t){const e={},n=s(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&a(e,["resumable"],i);const o=s(t,["lastConsumedClientMessageIndex"]);return o!=null&&a(e,["lastConsumedClientMessageIndex"],o),e}function bh(t){const e={},n=s(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&a(e,["resumable"],i);const o=s(t,["lastConsumedClientMessageIndex"]);return o!=null&&a(e,["lastConsumedClientMessageIndex"],o),e}function Dh(t){const e={};s(t,["setupComplete"])!=null&&a(e,["setupComplete"],rh());const i=s(t,["serverContent"]);i!=null&&a(e,["serverContent"],Ch(i));const o=s(t,["toolCall"]);o!=null&&a(e,["toolCall"],Ah(o));const r=s(t,["toolCallCancellation"]);r!=null&&a(e,["toolCallCancellation"],Eh(r));const l=s(t,["usageMetadata"]);l!=null&&a(e,["usageMetadata"],Mh(l));const u=s(t,["goAway"]);u!=null&&a(e,["goAway"],Ph(u));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&a(e,["sessionResumptionUpdate"],Nh(d)),e}function Fh(t){const e={};s(t,["setupComplete"])!=null&&a(e,["setupComplete"],ah());const i=s(t,["serverContent"]);i!=null&&a(e,["serverContent"],Th(i));const o=s(t,["toolCall"]);o!=null&&a(e,["toolCall"],xh(o));const r=s(t,["toolCallCancellation"]);r!=null&&a(e,["toolCallCancellation"],Ih(r));const l=s(t,["usageMetadata"]);l!=null&&a(e,["usageMetadata"],Rh(l));const u=s(t,["goAway"]);u!=null&&a(e,["goAway"],kh(u));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&a(e,["sessionResumptionUpdate"],bh(d)),e}function Lh(){return{}}function Uh(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["weight"]);return i!=null&&a(e,["weight"],i),e}function Vh(t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Uh(o))),a(e,["weightedPrompts"],i)}return e}function $h(t){const e={},n=s(t,["temperature"]);n!=null&&a(e,["temperature"],n);const i=s(t,["topK"]);i!=null&&a(e,["topK"],i);const o=s(t,["seed"]);o!=null&&a(e,["seed"],o);const r=s(t,["guidance"]);r!=null&&a(e,["guidance"],r);const l=s(t,["bpm"]);l!=null&&a(e,["bpm"],l);const u=s(t,["density"]);u!=null&&a(e,["density"],u);const d=s(t,["brightness"]);d!=null&&a(e,["brightness"],d);const c=s(t,["scale"]);c!=null&&a(e,["scale"],c);const f=s(t,["muteBass"]);f!=null&&a(e,["muteBass"],f);const h=s(t,["muteDrums"]);h!=null&&a(e,["muteDrums"],h);const m=s(t,["onlyBassAndDrums"]);return m!=null&&a(e,["onlyBassAndDrums"],m),e}function Bh(t){const e={},n=s(t,["clientContent"]);n!=null&&a(e,["clientContent"],Vh(n));const i=s(t,["musicGenerationConfig"]);return i!=null&&a(e,["musicGenerationConfig"],$h(i)),e}function Oh(t){const e={},n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);i!=null&&a(e,["mimeType"],i);const o=s(t,["sourceMetadata"]);return o!=null&&a(e,["sourceMetadata"],Bh(o)),e}function Gh(t){const e={},n=s(t,["audioChunks"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Oh(o))),a(e,["audioChunks"],i)}return e}function qh(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["filteredReason"]);return i!=null&&a(e,["filteredReason"],i),e}function Jh(t){const e={};s(t,["setupComplete"])!=null&&a(e,["setupComplete"],Lh());const i=s(t,["serverContent"]);i!=null&&a(e,["serverContent"],Gh(i));const o=s(t,["filteredPrompt"]);return o!=null&&a(e,["filteredPrompt"],qh(o)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hh(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Wh(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Kh(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Yh(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Hh(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Wh(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Kh(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function $n(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Yh(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Zh(t){const e={},n=s(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const i=s(t,["default"]);i!=null&&a(e,["default"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["enum"]);r!=null&&a(e,["enum"],r);const l=s(t,["example"]);l!=null&&a(e,["example"],l);const u=s(t,["format"]);u!=null&&a(e,["format"],u);const d=s(t,["items"]);d!=null&&a(e,["items"],d);const c=s(t,["maxItems"]);c!=null&&a(e,["maxItems"],c);const f=s(t,["maxLength"]);f!=null&&a(e,["maxLength"],f);const h=s(t,["maxProperties"]);h!=null&&a(e,["maxProperties"],h);const m=s(t,["maximum"]);m!=null&&a(e,["maximum"],m);const p=s(t,["minItems"]);p!=null&&a(e,["minItems"],p);const g=s(t,["minLength"]);g!=null&&a(e,["minLength"],g);const y=s(t,["minProperties"]);y!=null&&a(e,["minProperties"],y);const v=s(t,["minimum"]);v!=null&&a(e,["minimum"],v);const x=s(t,["nullable"]);x!=null&&a(e,["nullable"],x);const C=s(t,["pattern"]);C!=null&&a(e,["pattern"],C);const w=s(t,["properties"]);w!=null&&a(e,["properties"],w);const T=s(t,["propertyOrdering"]);T!=null&&a(e,["propertyOrdering"],T);const M=s(t,["required"]);M!=null&&a(e,["required"],M);const D=s(t,["title"]);D!=null&&a(e,["title"],D);const A=s(t,["type"]);return A!=null&&a(e,["type"],A),e}function zh(t){const e={};if(s(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(t,["category"]);n!=null&&a(e,["category"],n);const i=s(t,["threshold"]);return i!=null&&a(e,["threshold"],i),e}function Xh(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function Qh(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function jh(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Qh(n)),e}function em(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function tm(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],em(n)),e}function nm(){return{}}function im(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>Xh(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],jh(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],tm(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],nm());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function om(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function sm(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function rm(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],sm(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function am(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],om(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],rm(i)),e}function lm(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function Qa(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],lm(n)),e}function um(t){const e={},n=s(t,["speaker"]);n!=null&&a(e,["speaker"],n);const i=s(t,["voiceConfig"]);return i!=null&&a(e,["voiceConfig"],Qa(i)),e}function cm(t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>um(o))),a(e,["speakerVoiceConfigs"],i)}return e}function dm(t){const e={},n=s(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],Qa(n));const i=s(t,["multiSpeakerVoiceConfig"]);i!=null&&a(e,["multiSpeakerVoiceConfig"],cm(i));const o=s(t,["languageCode"]);return o!=null&&a(e,["languageCode"],o),e}function fm(t){const e={},n=s(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&a(e,["thinkingBudget"],i),e}function hm(t,e,n){const i={},o=s(e,["systemInstruction"]);n!==void 0&&o!=null&&a(n,["systemInstruction"],$n(ae(o)));const r=s(e,["temperature"]);r!=null&&a(i,["temperature"],r);const l=s(e,["topP"]);l!=null&&a(i,["topP"],l);const u=s(e,["topK"]);u!=null&&a(i,["topK"],u);const d=s(e,["candidateCount"]);d!=null&&a(i,["candidateCount"],d);const c=s(e,["maxOutputTokens"]);c!=null&&a(i,["maxOutputTokens"],c);const f=s(e,["stopSequences"]);f!=null&&a(i,["stopSequences"],f);const h=s(e,["responseLogprobs"]);h!=null&&a(i,["responseLogprobs"],h);const m=s(e,["logprobs"]);m!=null&&a(i,["logprobs"],m);const p=s(e,["presencePenalty"]);p!=null&&a(i,["presencePenalty"],p);const g=s(e,["frequencyPenalty"]);g!=null&&a(i,["frequencyPenalty"],g);const y=s(e,["seed"]);y!=null&&a(i,["seed"],y);const v=s(e,["responseMimeType"]);v!=null&&a(i,["responseMimeType"],v);const x=s(e,["responseSchema"]);if(x!=null&&a(i,["responseSchema"],Zh(An(x))),s(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=s(e,["safetySettings"]);if(n!==void 0&&C!=null){let N=C;Array.isArray(N)&&(N=N.map(O=>zh(O))),a(n,["safetySettings"],N)}const w=s(e,["tools"]);if(n!==void 0&&w!=null){let N=Lt(w);Array.isArray(N)&&(N=N.map(O=>im(Ft(O)))),a(n,["tools"],N)}const T=s(e,["toolConfig"]);if(n!==void 0&&T!=null&&a(n,["toolConfig"],am(T)),s(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=s(e,["cachedContent"]);n!==void 0&&M!=null&&a(n,["cachedContent"],Ue(t,M));const D=s(e,["responseModalities"]);D!=null&&a(i,["responseModalities"],D);const A=s(e,["mediaResolution"]);A!=null&&a(i,["mediaResolution"],A);const U=s(e,["speechConfig"]);if(U!=null&&a(i,["speechConfig"],dm(Oa(U))),s(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=s(e,["thinkingConfig"]);return R!=null&&a(i,["thinkingConfig"],fm(R)),i}function zs(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=_e(o);Array.isArray(l)&&(l=l.map(u=>$n(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["generationConfig"],hm(t,r,n)),n}function mm(t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&a(e,["requests[]","taskType"],i);const o=s(t,["title"]);e!==void 0&&o!=null&&a(e,["requests[]","title"],o);const r=s(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&a(e,["requests[]","outputDimensionality"],r),s(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function pm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);o!=null&&a(n,["requests[]","content"],Ba(t,o));const r=s(e,["config"]);r!=null&&a(n,["config"],mm(r,n));const l=s(e,["model"]);return l!==void 0&&a(n,["requests[]","model"],z(t,l)),n}function gm(t,e){const n={};if(s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=s(t,["numberOfImages"]);e!==void 0&&i!=null&&a(e,["parameters","sampleCount"],i);const o=s(t,["aspectRatio"]);e!==void 0&&o!=null&&a(e,["parameters","aspectRatio"],o);const r=s(t,["guidanceScale"]);if(e!==void 0&&r!=null&&a(e,["parameters","guidanceScale"],r),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=s(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&a(e,["parameters","safetySetting"],l);const u=s(t,["personGeneration"]);e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u);const d=s(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&a(e,["parameters","includeSafetyAttributes"],d);const c=s(t,["includeRaiReason"]);e!==void 0&&c!=null&&a(e,["parameters","includeRaiReason"],c);const f=s(t,["language"]);e!==void 0&&f!=null&&a(e,["parameters","language"],f);const h=s(t,["outputMimeType"]);e!==void 0&&h!=null&&a(e,["parameters","outputOptions","mimeType"],h);const m=s(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&a(e,["parameters","outputOptions","compressionQuality"],m),s(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function ym(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["config"]);return r!=null&&a(n,["config"],gm(r,n)),n}function _m(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function vm(t,e,n){const i={},o=s(e,["pageSize"]);n!==void 0&&o!=null&&a(n,["_query","pageSize"],o);const r=s(e,["pageToken"]);n!==void 0&&r!=null&&a(n,["_query","pageToken"],r);const l=s(e,["filter"]);n!==void 0&&l!=null&&a(n,["_query","filter"],l);const u=s(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Ja(t,u)),i}function Cm(t,e){const n={},i=s(e,["config"]);return i!=null&&a(n,["config"],vm(t,i,n)),n}function Tm(t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);e!==void 0&&o!=null&&a(e,["description"],o);const r=s(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&a(e,["defaultCheckpointId"],r),n}function wm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Tm(o,n)),n}function Sm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Am(t){const e={};if(s(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function xm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=_e(o);Array.isArray(l)&&(l=l.map(u=>$n(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["config"],Am(r)),n}function Em(t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["imageBytes"]);n!=null&&a(e,["bytesBase64Encoded"],Re(n));const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Im(t,e){const n={},i=s(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&a(e,["parameters","sampleCount"],i),s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=s(t,["durationSeconds"]);if(e!==void 0&&o!=null&&a(e,["parameters","durationSeconds"],o),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=s(t,["aspectRatio"]);if(e!==void 0&&r!=null&&a(e,["parameters","aspectRatio"],r),s(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=s(t,["personGeneration"]);if(e!==void 0&&l!=null&&a(e,["parameters","personGeneration"],l),s(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=s(t,["negativePrompt"]);e!==void 0&&u!=null&&a(e,["parameters","negativePrompt"],u);const d=s(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&a(e,["parameters","enhancePrompt"],d),s(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(s(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");return n}function Mm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["image"]);if(r!=null&&a(n,["instances[0]","image"],Em(r)),s(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=s(e,["config"]);return l!=null&&a(n,["config"],Im(l,n)),n}function Rm(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Pm(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function km(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Nm(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Rm(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Pm(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],km(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function ft(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Nm(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function bm(t){const e={},n=s(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const i=s(t,["default"]);i!=null&&a(e,["default"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["enum"]);r!=null&&a(e,["enum"],r);const l=s(t,["example"]);l!=null&&a(e,["example"],l);const u=s(t,["format"]);u!=null&&a(e,["format"],u);const d=s(t,["items"]);d!=null&&a(e,["items"],d);const c=s(t,["maxItems"]);c!=null&&a(e,["maxItems"],c);const f=s(t,["maxLength"]);f!=null&&a(e,["maxLength"],f);const h=s(t,["maxProperties"]);h!=null&&a(e,["maxProperties"],h);const m=s(t,["maximum"]);m!=null&&a(e,["maximum"],m);const p=s(t,["minItems"]);p!=null&&a(e,["minItems"],p);const g=s(t,["minLength"]);g!=null&&a(e,["minLength"],g);const y=s(t,["minProperties"]);y!=null&&a(e,["minProperties"],y);const v=s(t,["minimum"]);v!=null&&a(e,["minimum"],v);const x=s(t,["nullable"]);x!=null&&a(e,["nullable"],x);const C=s(t,["pattern"]);C!=null&&a(e,["pattern"],C);const w=s(t,["properties"]);w!=null&&a(e,["properties"],w);const T=s(t,["propertyOrdering"]);T!=null&&a(e,["propertyOrdering"],T);const M=s(t,["required"]);M!=null&&a(e,["required"],M);const D=s(t,["title"]);D!=null&&a(e,["title"],D);const A=s(t,["type"]);return A!=null&&a(e,["type"],A),e}function Dm(t){const e={},n=s(t,["featureSelectionPreference"]);return n!=null&&a(e,["featureSelectionPreference"],n),e}function Fm(t){const e={},n=s(t,["method"]);n!=null&&a(e,["method"],n);const i=s(t,["category"]);i!=null&&a(e,["category"],i);const o=s(t,["threshold"]);return o!=null&&a(e,["threshold"],o),e}function Lm(t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&a(e,["description"],n);const i=s(t,["name"]);i!=null&&a(e,["name"],i);const o=s(t,["parameters"]);o!=null&&a(e,["parameters"],o);const r=s(t,["parametersJsonSchema"]);r!=null&&a(e,["parametersJsonSchema"],r);const l=s(t,["response"]);l!=null&&a(e,["response"],l);const u=s(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function Um(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Vm(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Um(n)),e}function $m(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function Bm(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],$m(n)),e}function Om(){return{}}function Gm(t){const e={},n=s(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function qm(t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],Gm(n));const i=s(t,["authType"]);i!=null&&a(e,["authType"],i);const o=s(t,["googleServiceAccountConfig"]);o!=null&&a(e,["googleServiceAccountConfig"],o);const r=s(t,["httpBasicAuthConfig"]);r!=null&&a(e,["httpBasicAuthConfig"],r);const l=s(t,["oauthConfig"]);l!=null&&a(e,["oauthConfig"],l);const u=s(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function Jm(t){const e={},n=s(t,["authConfig"]);return n!=null&&a(e,["authConfig"],qm(n)),e}function Hm(){return{}}function ja(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>Lm(h))),a(e,["functionDeclarations"],f)}const i=s(t,["retrieval"]);i!=null&&a(e,["retrieval"],i);const o=s(t,["googleSearch"]);o!=null&&a(e,["googleSearch"],Vm(o));const r=s(t,["googleSearchRetrieval"]);r!=null&&a(e,["googleSearchRetrieval"],Bm(r)),s(t,["enterpriseWebSearch"])!=null&&a(e,["enterpriseWebSearch"],Om());const u=s(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],Jm(u)),s(t,["urlContext"])!=null&&a(e,["urlContext"],Hm());const c=s(t,["codeExecution"]);return c!=null&&a(e,["codeExecution"],c),e}function Wm(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function Km(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function Ym(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],Km(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function Zm(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],Wm(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],Ym(i)),e}function zm(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function Xm(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],zm(n)),e}function Qm(t){const e={},n=s(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],Xm(n)),s(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function jm(t){const e={},n=s(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&a(e,["thinkingBudget"],i),e}function ep(t,e,n){const i={},o=s(e,["systemInstruction"]);n!==void 0&&o!=null&&a(n,["systemInstruction"],ft(ae(o)));const r=s(e,["temperature"]);r!=null&&a(i,["temperature"],r);const l=s(e,["topP"]);l!=null&&a(i,["topP"],l);const u=s(e,["topK"]);u!=null&&a(i,["topK"],u);const d=s(e,["candidateCount"]);d!=null&&a(i,["candidateCount"],d);const c=s(e,["maxOutputTokens"]);c!=null&&a(i,["maxOutputTokens"],c);const f=s(e,["stopSequences"]);f!=null&&a(i,["stopSequences"],f);const h=s(e,["responseLogprobs"]);h!=null&&a(i,["responseLogprobs"],h);const m=s(e,["logprobs"]);m!=null&&a(i,["logprobs"],m);const p=s(e,["presencePenalty"]);p!=null&&a(i,["presencePenalty"],p);const g=s(e,["frequencyPenalty"]);g!=null&&a(i,["frequencyPenalty"],g);const y=s(e,["seed"]);y!=null&&a(i,["seed"],y);const v=s(e,["responseMimeType"]);v!=null&&a(i,["responseMimeType"],v);const x=s(e,["responseSchema"]);x!=null&&a(i,["responseSchema"],bm(An(x)));const C=s(e,["routingConfig"]);C!=null&&a(i,["routingConfig"],C);const w=s(e,["modelSelectionConfig"]);w!=null&&a(i,["modelConfig"],Dm(w));const T=s(e,["safetySettings"]);if(n!==void 0&&T!=null){let ce=T;Array.isArray(ce)&&(ce=ce.map(ke=>Fm(ke))),a(n,["safetySettings"],ce)}const M=s(e,["tools"]);if(n!==void 0&&M!=null){let ce=Lt(M);Array.isArray(ce)&&(ce=ce.map(ke=>ja(Ft(ke)))),a(n,["tools"],ce)}const D=s(e,["toolConfig"]);n!==void 0&&D!=null&&a(n,["toolConfig"],Zm(D));const A=s(e,["labels"]);n!==void 0&&A!=null&&a(n,["labels"],A);const U=s(e,["cachedContent"]);n!==void 0&&U!=null&&a(n,["cachedContent"],Ue(t,U));const R=s(e,["responseModalities"]);R!=null&&a(i,["responseModalities"],R);const N=s(e,["mediaResolution"]);N!=null&&a(i,["mediaResolution"],N);const O=s(e,["speechConfig"]);O!=null&&a(i,["speechConfig"],Qm(Oa(O)));const ge=s(e,["audioTimestamp"]);ge!=null&&a(i,["audioTimestamp"],ge);const Pe=s(e,["thinkingConfig"]);return Pe!=null&&a(i,["thinkingConfig"],jm(Pe)),i}function Xs(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=_e(o);Array.isArray(l)&&(l=l.map(u=>ft(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["generationConfig"],ep(t,r,n)),n}function tp(t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&a(e,["instances[]","task_type"],i);const o=s(t,["title"]);e!==void 0&&o!=null&&a(e,["instances[]","title"],o);const r=s(t,["outputDimensionality"]);e!==void 0&&r!=null&&a(e,["parameters","outputDimensionality"],r);const l=s(t,["mimeType"]);e!==void 0&&l!=null&&a(e,["instances[]","mimeType"],l);const u=s(t,["autoTruncate"]);return e!==void 0&&u!=null&&a(e,["parameters","autoTruncate"],u),n}function np(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);o!=null&&a(n,["instances[]","content"],Ba(t,o));const r=s(e,["config"]);return r!=null&&a(n,["config"],tp(r,n)),n}function ip(t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const o=s(t,["negativePrompt"]);e!==void 0&&o!=null&&a(e,["parameters","negativePrompt"],o);const r=s(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const u=s(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const d=s(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const c=s(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const f=s(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=s(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&a(e,["parameters","includeSafetyAttributes"],h);const m=s(t,["includeRaiReason"]);e!==void 0&&m!=null&&a(e,["parameters","includeRaiReason"],m);const p=s(t,["language"]);e!==void 0&&p!=null&&a(e,["parameters","language"],p);const g=s(t,["outputMimeType"]);e!==void 0&&g!=null&&a(e,["parameters","outputOptions","mimeType"],g);const y=s(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&a(e,["parameters","outputOptions","compressionQuality"],y);const v=s(t,["addWatermark"]);e!==void 0&&v!=null&&a(e,["parameters","addWatermark"],v);const x=s(t,["enhancePrompt"]);return e!==void 0&&x!=null&&a(e,["parameters","enhancePrompt"],x),n}function op(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["config"]);return r!=null&&a(n,["config"],ip(r,n)),n}function Bn(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const i=s(t,["imageBytes"]);i!=null&&a(e,["bytesBase64Encoded"],Re(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function sp(t){const e={},n=s(t,["maskMode"]);n!=null&&a(e,["maskMode"],n);const i=s(t,["segmentationClasses"]);i!=null&&a(e,["maskClasses"],i);const o=s(t,["maskDilation"]);return o!=null&&a(e,["dilation"],o),e}function rp(t){const e={},n=s(t,["controlType"]);n!=null&&a(e,["controlType"],n);const i=s(t,["enableControlImageComputation"]);return i!=null&&a(e,["computeControl"],i),e}function ap(t){const e={},n=s(t,["styleDescription"]);return n!=null&&a(e,["styleDescription"],n),e}function lp(t){const e={},n=s(t,["subjectType"]);n!=null&&a(e,["subjectType"],n);const i=s(t,["subjectDescription"]);return i!=null&&a(e,["subjectDescription"],i),e}function up(t){const e={},n=s(t,["referenceImage"]);n!=null&&a(e,["referenceImage"],Bn(n));const i=s(t,["referenceId"]);i!=null&&a(e,["referenceId"],i);const o=s(t,["referenceType"]);o!=null&&a(e,["referenceType"],o);const r=s(t,["maskImageConfig"]);r!=null&&a(e,["maskImageConfig"],sp(r));const l=s(t,["controlImageConfig"]);l!=null&&a(e,["controlImageConfig"],rp(l));const u=s(t,["styleImageConfig"]);u!=null&&a(e,["styleImageConfig"],ap(u));const d=s(t,["subjectImageConfig"]);return d!=null&&a(e,["subjectImageConfig"],lp(d)),e}function cp(t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const o=s(t,["negativePrompt"]);e!==void 0&&o!=null&&a(e,["parameters","negativePrompt"],o);const r=s(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const u=s(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const d=s(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const c=s(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const f=s(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=s(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&a(e,["parameters","includeSafetyAttributes"],h);const m=s(t,["includeRaiReason"]);e!==void 0&&m!=null&&a(e,["parameters","includeRaiReason"],m);const p=s(t,["language"]);e!==void 0&&p!=null&&a(e,["parameters","language"],p);const g=s(t,["outputMimeType"]);e!==void 0&&g!=null&&a(e,["parameters","outputOptions","mimeType"],g);const y=s(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&a(e,["parameters","outputOptions","compressionQuality"],y);const v=s(t,["editMode"]);e!==void 0&&v!=null&&a(e,["parameters","editMode"],v);const x=s(t,["baseSteps"]);return e!==void 0&&x!=null&&a(e,["parameters","editConfig","baseSteps"],x),n}function dp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["referenceImages"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>up(d))),a(n,["instances[0]","referenceImages"],u)}const l=s(e,["config"]);return l!=null&&a(n,["config"],cp(l,n)),n}function fp(t,e){const n={},i=s(t,["includeRaiReason"]);e!==void 0&&i!=null&&a(e,["parameters","includeRaiReason"],i);const o=s(t,["outputMimeType"]);e!==void 0&&o!=null&&a(e,["parameters","outputOptions","mimeType"],o);const r=s(t,["outputCompressionQuality"]);e!==void 0&&r!=null&&a(e,["parameters","outputOptions","compressionQuality"],r);const l=s(t,["numberOfImages"]);e!==void 0&&l!=null&&a(e,["parameters","sampleCount"],l);const u=s(t,["mode"]);return e!==void 0&&u!=null&&a(e,["parameters","mode"],u),n}function hp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["image"]);o!=null&&a(n,["instances[0]","image"],Bn(o));const r=s(e,["upscaleFactor"]);r!=null&&a(n,["parameters","upscaleConfig","upscaleFactor"],r);const l=s(e,["config"]);return l!=null&&a(n,["config"],fp(l,n)),n}function mp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function pp(t,e,n){const i={},o=s(e,["pageSize"]);n!==void 0&&o!=null&&a(n,["_query","pageSize"],o);const r=s(e,["pageToken"]);n!==void 0&&r!=null&&a(n,["_query","pageToken"],r);const l=s(e,["filter"]);n!==void 0&&l!=null&&a(n,["_query","filter"],l);const u=s(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Ja(t,u)),i}function gp(t,e){const n={},i=s(e,["config"]);return i!=null&&a(n,["config"],pp(t,i,n)),n}function yp(t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);e!==void 0&&o!=null&&a(e,["description"],o);const r=s(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&a(e,["defaultCheckpointId"],r),n}function _p(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],yp(o,n)),n}function vp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Cp(t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&a(e,["systemInstruction"],ft(ae(i)));const o=s(t,["tools"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>ja(u))),a(e,["tools"],l)}const r=s(t,["generationConfig"]);return e!==void 0&&r!=null&&a(e,["generationConfig"],r),n}function Tp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=_e(o);Array.isArray(l)&&(l=l.map(u=>ft(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["config"],Cp(r,n)),n}function wp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=_e(o);Array.isArray(l)&&(l=l.map(u=>ft(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["config"],r),n}function Sp(t){const e={},n=s(t,["uri"]);n!=null&&a(e,["gcsUri"],n);const i=s(t,["videoBytes"]);i!=null&&a(e,["bytesBase64Encoded"],Re(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Ap(t,e){const n={},i=s(t,["numberOfVideos"]);e!==void 0&&i!=null&&a(e,["parameters","sampleCount"],i);const o=s(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const r=s(t,["fps"]);e!==void 0&&r!=null&&a(e,["parameters","fps"],r);const l=s(t,["durationSeconds"]);e!==void 0&&l!=null&&a(e,["parameters","durationSeconds"],l);const u=s(t,["seed"]);e!==void 0&&u!=null&&a(e,["parameters","seed"],u);const d=s(t,["aspectRatio"]);e!==void 0&&d!=null&&a(e,["parameters","aspectRatio"],d);const c=s(t,["resolution"]);e!==void 0&&c!=null&&a(e,["parameters","resolution"],c);const f=s(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=s(t,["pubsubTopic"]);e!==void 0&&h!=null&&a(e,["parameters","pubsubTopic"],h);const m=s(t,["negativePrompt"]);e!==void 0&&m!=null&&a(e,["parameters","negativePrompt"],m);const p=s(t,["enhancePrompt"]);e!==void 0&&p!=null&&a(e,["parameters","enhancePrompt"],p);const g=s(t,["generateAudio"]);e!==void 0&&g!=null&&a(e,["parameters","generateAudio"],g);const y=s(t,["lastFrame"]);return e!==void 0&&y!=null&&a(e,["instances[0]","lastFrame"],Bn(y)),n}function xp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["image"]);r!=null&&a(n,["instances[0]","image"],Bn(r));const l=s(e,["video"]);l!=null&&a(n,["instances[0]","video"],Sp(l));const u=s(e,["config"]);return u!=null&&a(n,["config"],Ap(u,n)),n}function Ep(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Ip(t){const e={},n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Mp(t){const e={},n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Rp(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Ep(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Ip(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Mp(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Pp(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Rp(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function kp(t){const e={},n=s(t,["citationSources"]);return n!=null&&a(e,["citations"],n),e}function Np(t){const e={},n=s(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const i=s(t,["urlRetrievalStatus"]);return i!=null&&a(e,["urlRetrievalStatus"],i),e}function bp(t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Np(o))),a(e,["urlMetadata"],i)}return e}function Dp(t){const e={},n=s(t,["content"]);n!=null&&a(e,["content"],Pp(n));const i=s(t,["citationMetadata"]);i!=null&&a(e,["citationMetadata"],kp(i));const o=s(t,["tokenCount"]);o!=null&&a(e,["tokenCount"],o);const r=s(t,["finishReason"]);r!=null&&a(e,["finishReason"],r);const l=s(t,["urlContextMetadata"]);l!=null&&a(e,["urlContextMetadata"],bp(l));const u=s(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const d=s(t,["groundingMetadata"]);d!=null&&a(e,["groundingMetadata"],d);const c=s(t,["index"]);c!=null&&a(e,["index"],c);const f=s(t,["logprobsResult"]);f!=null&&a(e,["logprobsResult"],f);const h=s(t,["safetyRatings"]);return h!=null&&a(e,["safetyRatings"],h),e}function Qs(t){const e={},n=s(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Dp(u))),a(e,["candidates"],l)}const i=s(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const o=s(t,["promptFeedback"]);o!=null&&a(e,["promptFeedback"],o);const r=s(t,["usageMetadata"]);return r!=null&&a(e,["usageMetadata"],r),e}function Fp(t){const e={},n=s(t,["values"]);return n!=null&&a(e,["values"],n),e}function Lp(){return{}}function Up(t){const e={},n=s(t,["embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Fp(r))),a(e,["embeddings"],o)}return s(t,["metadata"])!=null&&a(e,["metadata"],Lp()),e}function Vp(t){const e={},n=s(t,["bytesBase64Encoded"]);n!=null&&a(e,["imageBytes"],Re(n));const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function el(t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&a(e,["scores"],i);const o=s(t,["contentType"]);return o!=null&&a(e,["contentType"],o),e}function $p(t){const e={},n=s(t,["_self"]);n!=null&&a(e,["image"],Vp(n));const i=s(t,["raiFilteredReason"]);i!=null&&a(e,["raiFilteredReason"],i);const o=s(t,["_self"]);return o!=null&&a(e,["safetyAttributes"],el(o)),e}function Bp(t){const e={},n=s(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>$p(r))),a(e,["generatedImages"],o)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],el(i)),e}function Op(t){const e={},n=s(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=s(t,["updateTime"]);return o!=null&&a(e,["updateTime"],o),e}function xi(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["version"]);r!=null&&a(e,["version"],r);const l=s(t,["_self"]);l!=null&&a(e,["tunedModelInfo"],Op(l));const u=s(t,["inputTokenLimit"]);u!=null&&a(e,["inputTokenLimit"],u);const d=s(t,["outputTokenLimit"]);d!=null&&a(e,["outputTokenLimit"],d);const c=s(t,["supportedGenerationMethods"]);return c!=null&&a(e,["supportedActions"],c),e}function Gp(t,e){const n={},i=s(e,["nextPageToken"]);i!=null&&a(n,["nextPageToken"],i);const o=s(e,["_self"]);if(o!=null){let r=Ha(o);Array.isArray(r)&&(r=r.map(l=>xi(l))),a(n,["models"],r)}return n}function qp(){return{}}function Jp(t){const e={},n=s(t,["totalTokens"]);n!=null&&a(e,["totalTokens"],n);const i=s(t,["cachedContentTokenCount"]);return i!=null&&a(e,["cachedContentTokenCount"],i),e}function Hp(t){const e={},n=s(t,["video","uri"]);n!=null&&a(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&a(e,["videoBytes"],Re(i));const o=s(t,["encoding"]);return o!=null&&a(e,["mimeType"],o),e}function Wp(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],Hp(n)),e}function Kp(t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>Wp(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function Yp(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response","generateVideoResponse"]);return l!=null&&a(e,["response"],Kp(l)),e}function Zp(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function zp(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Xp(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Qp(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Zp(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],zp(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Xp(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function jp(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Qp(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function eg(t){const e={},n=s(t,["citations"]);return n!=null&&a(e,["citations"],n),e}function tg(t){const e={},n=s(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const i=s(t,["urlRetrievalStatus"]);return i!=null&&a(e,["urlRetrievalStatus"],i),e}function ng(t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>tg(o))),a(e,["urlMetadata"],i)}return e}function ig(t){const e={},n=s(t,["content"]);n!=null&&a(e,["content"],jp(n));const i=s(t,["citationMetadata"]);i!=null&&a(e,["citationMetadata"],eg(i));const o=s(t,["finishMessage"]);o!=null&&a(e,["finishMessage"],o);const r=s(t,["finishReason"]);r!=null&&a(e,["finishReason"],r);const l=s(t,["urlContextMetadata"]);l!=null&&a(e,["urlContextMetadata"],ng(l));const u=s(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const d=s(t,["groundingMetadata"]);d!=null&&a(e,["groundingMetadata"],d);const c=s(t,["index"]);c!=null&&a(e,["index"],c);const f=s(t,["logprobsResult"]);f!=null&&a(e,["logprobsResult"],f);const h=s(t,["safetyRatings"]);return h!=null&&a(e,["safetyRatings"],h),e}function js(t){const e={},n=s(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>ig(c))),a(e,["candidates"],d)}const i=s(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=s(t,["responseId"]);o!=null&&a(e,["responseId"],o);const r=s(t,["modelVersion"]);r!=null&&a(e,["modelVersion"],r);const l=s(t,["promptFeedback"]);l!=null&&a(e,["promptFeedback"],l);const u=s(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function og(t){const e={},n=s(t,["truncated"]);n!=null&&a(e,["truncated"],n);const i=s(t,["token_count"]);return i!=null&&a(e,["tokenCount"],i),e}function sg(t){const e={},n=s(t,["values"]);n!=null&&a(e,["values"],n);const i=s(t,["statistics"]);return i!=null&&a(e,["statistics"],og(i)),e}function rg(t){const e={},n=s(t,["billableCharacterCount"]);return n!=null&&a(e,["billableCharacterCount"],n),e}function ag(t){const e={},n=s(t,["predictions[]","embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>sg(r))),a(e,["embeddings"],o)}const i=s(t,["metadata"]);return i!=null&&a(e,["metadata"],rg(i)),e}function lg(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&a(e,["imageBytes"],Re(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function tl(t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&a(e,["scores"],i);const o=s(t,["contentType"]);return o!=null&&a(e,["contentType"],o),e}function eo(t){const e={},n=s(t,["_self"]);n!=null&&a(e,["image"],lg(n));const i=s(t,["raiFilteredReason"]);i!=null&&a(e,["raiFilteredReason"],i);const o=s(t,["_self"]);o!=null&&a(e,["safetyAttributes"],tl(o));const r=s(t,["prompt"]);return r!=null&&a(e,["enhancedPrompt"],r),e}function ug(t){const e={},n=s(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>eo(r))),a(e,["generatedImages"],o)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],tl(i)),e}function cg(t){const e={},n=s(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>eo(o))),a(e,["generatedImages"],i)}return e}function dg(t){const e={},n=s(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>eo(o))),a(e,["generatedImages"],i)}return e}function fg(t){const e={},n=s(t,["endpoint"]);n!=null&&a(e,["name"],n);const i=s(t,["deployedModelId"]);return i!=null&&a(e,["deployedModelId"],i),e}function hg(t){const e={},n=s(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=s(t,["updateTime"]);return o!=null&&a(e,["updateTime"],o),e}function mg(t){const e={},n=s(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const i=s(t,["epoch"]);i!=null&&a(e,["epoch"],i);const o=s(t,["step"]);return o!=null&&a(e,["step"],o),e}function Ei(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["versionId"]);r!=null&&a(e,["version"],r);const l=s(t,["deployedModels"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(m=>fg(m))),a(e,["endpoints"],h)}const u=s(t,["labels"]);u!=null&&a(e,["labels"],u);const d=s(t,["_self"]);d!=null&&a(e,["tunedModelInfo"],hg(d));const c=s(t,["defaultCheckpointId"]);c!=null&&a(e,["defaultCheckpointId"],c);const f=s(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(m=>mg(m))),a(e,["checkpoints"],h)}return e}function pg(t,e){const n={},i=s(e,["nextPageToken"]);i!=null&&a(n,["nextPageToken"],i);const o=s(e,["_self"]);if(o!=null){let r=Ha(o);Array.isArray(r)&&(r=r.map(l=>Ei(l))),a(n,["models"],r)}return n}function gg(){return{}}function yg(t){const e={},n=s(t,["totalTokens"]);return n!=null&&a(e,["totalTokens"],n),e}function _g(t){const e={},n=s(t,["tokensInfo"]);return n!=null&&a(e,["tokensInfo"],n),e}function vg(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&a(e,["videoBytes"],Re(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Cg(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],vg(n)),e}function Tg(t){const e={},n=s(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>Cg(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function wg(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response"]);return l!=null&&a(e,["response"],Tg(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Sg="Content-Type",Ag="X-Server-Timeout",xg="User-Agent",Ii="x-goog-api-client",Eg="1.6.0",Ig=`google-genai-sdk/${Eg}`,Mg="v1beta1",Rg="v1beta",er=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Pg{constructor(e){var n,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Mg,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Rg,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,i){const o=[this.getRequestUrlInternal(n)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,i);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))o.searchParams.append(l,String(u));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,n,e.abortSignal),this.unaryApiCall(o,r,e.httpMethod)}patchHttpOptions(e,n){const i=JSON.parse(JSON.stringify(e));for(const[o,r]of Object.entries(n))typeof r=="object"?i[o]=Object.assign(Object.assign({},i[o]),r):r!==void 0&&(i[o]=r);return i}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,n,e.abortSignal),this.streamApiCall(o,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,i){if(n&&n.timeout||i){const o=new AbortController,r=o.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>o.abort(),n.timeout),i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=r}return n&&n.extraBody!==null&&kg(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await tr(o),new Ti(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await tr(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var n;return it(this,arguments,function*(){const o=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),r=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let l="";for(;;){const{done:u,value:d}=yield X(o.read());if(u){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=r.decode(d);try{const h=JSON.parse(c);if("error"in h){const m=JSON.parse(JSON.stringify(h.error)),p=m.status,g=m.code,y=`got status: ${p}. ${JSON.stringify(h)}`;if(g>=400&&g<600)throw new Vn({message:y,status:g})}}catch(h){if(h.name==="ApiError")throw h}l+=c;let f=l.match(er);for(;f;){const h=f[1];try{const m=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield X(new Ti(m)),l=l.slice(f[0].length),f=l.match(er)}catch(m){throw new Error(`exception parsing stream chunk ${h}. ${m}`)}}}}finally{o.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},n=Ig+" "+this.clientOptions.userAgentExtra;return e[xg]=n,e[Ii]=n,e[Sg]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))n.append(i,o);e.timeout&&e.timeout>0&&n.append(Ag,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var i;const o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const r=this.clientOptions.uploader,l=await r.stat(e);o.sizeBytes=String(l.size);const u=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=u;const d=await this.fetchUploadUrl(o,n);return r.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var i;let o={};n!=null&&n.httpOptions?o=n.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const r={file:e},l=await this.request({path:F("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:o});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(i=l==null?void 0:l.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function tr(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let i;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await t.json():i={error:{message:await t.text(),code:t.status,status:t.statusText}};const o=JSON.stringify(i);throw n>=400&&n<600?new Vn({message:o,status:n}):new Error(o)}}function kg(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const r=JSON.parse(t.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))n=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,l){const u=Object.assign({},r);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const c=l[d],f=u[d];c&&typeof c=="object"&&!Array.isArray(c)&&f&&typeof f=="object"&&!Array.isArray(f)?u[d]=i(f,c):(f&&c&&typeof f!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof f}, New type: ${typeof c}. Overwriting.`),u[d]=c)}return u}const o=i(n,e);t.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ng="mcp_used/unknown";function nl(t){for(const e of t)if(to(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function il(t){var e;const n=(e=t[Ii])!==null&&e!==void 0?e:"";t[Ii]=(n+` ${Ng}`).trimStart()}function bg(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>to(o)))!==null&&i!==void 0?i:!1}function Dg(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>!to(o)))!==null&&i!==void 0?i:!1}function to(t){return t!==null&&typeof t=="object"&&t instanceof no}function Fg(t,e=100){return it(this,arguments,function*(){let i,o=0;for(;o<e;){const r=yield X(t.listTools({cursor:i}));for(const l of r.tools)yield yield X(l),o++;if(!r.nextCursor)break;i=r.nextCursor}})}class no{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new no(e,n)}async initialize(){var e,n,i,o;if(this.mcpTools.length>0)return;const r={},l=[];for(const f of this.mcpClients)try{for(var u=!0,d=(n=void 0,Mt(Fg(f))),c;c=await d.next(),e=c.done,!e;u=!0){o=c.value,u=!1;const h=o;l.push(h);const m=h.name;if(r[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);r[m]=f}}catch(h){n={error:h}}finally{try{!u&&!e&&(i=d.return)&&await i.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),Dc(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const l=await o.callTool({name:i.name,arguments:i.args},void 0,r);n.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Lg(t,e,n){const i=new Tc;let o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data);const r=Jh(o);Object.assign(i,r),e(i)}class Ug{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i}async connect(e){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),l=Bg(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${o}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const f=new Promise(w=>{c=w}),h=e.callbacks,m=function(){c({})},p=this.apiClient,g={onopen:m,onmessage:w=>{Lg(p,h.onmessage,w)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(w){},onclose:(i=h==null?void 0:h.onclose)!==null&&i!==void 0?i:function(w){}},y=this.webSocketFactory.create(d,$g(l),g);y.connect(),await f;const v=z(this.apiClient,e.model),x=za({model:v}),C=Ai({setup:x});return y.send(JSON.stringify(C)),new Vg(y,this.apiClient)}}class Vg{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=oh(e),i=Xa(n);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=sh(e),i=Ai(n);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const n=Ai({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(tt.PLAY)}pause(){this.sendPlaybackControl(tt.PAUSE)}stop(){this.sendPlaybackControl(tt.STOP)}resetContext(){this.sendPlaybackControl(tt.RESET_CONTEXT)}close(){this.conn.close()}}function $g(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function Bg(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Og="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Gg(t,e,n){const i=new Cc;let o;if(n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),t.isVertexAI()){const r=Fh(o);Object.assign(i,r)}else{const r=Dh(o);Object.assign(i,r)}e(i)}class qg{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i,this.music=new Ug(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,i,o,r,l,u;const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const h=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&nl(e.config.tools)&&il(h);const m=Kg(h);if(this.apiClient.isVertexAI())f=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const R=this.apiClient.getApiKey();let N="BidiGenerateContent",O="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),N="BidiGenerateContentConstrained",O="access_token"),f=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.${N}?${O}=${R}`}let p=()=>{};const g=new Promise(R=>{p=R}),y=e.callbacks,v=function(){var R;(R=y==null?void 0:y.onopen)===null||R===void 0||R.call(y),p({})},x=this.apiClient,C={onopen:v,onmessage:R=>{Gg(x,y.onmessage,R)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(R){},onclose:(i=y==null?void 0:y.onclose)!==null&&i!==void 0?i:function(R){}},w=this.webSocketFactory.create(f,Wg(m),C);w.connect(),await g;let T=z(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const R=this.apiClient.getProject(),N=this.apiClient.getLocation();T=`projects/${R}/locations/${N}/`+T}let M={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[wn.AUDIO]}:e.config.responseModalities=[wn.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const D=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],A=[];for(const R of D)if(this.isCallableTool(R)){const N=R;A.push(await N.tool())}else A.push(R);A.length>0&&(e.config.tools=A);const U={model:T,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?M=Xf(this.apiClient,U):M=zf(this.apiClient,U),delete M.config,w.send(JSON.stringify(M)),new Hg(w,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Jg={turnComplete:!0};class Hg{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=_e(n.turns),e.isVertexAI()?i=i.map(o=>ft(o)):i=i.map(o=>$n(o))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(Og)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Jg),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:ih(e)}:n={realtimeInput:nh(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Wg(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function Kg(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nr=10;function ir(t){var e,n,i;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(an(l)){o=!0;break}if(!o)return!0;const r=(i=t==null?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function an(t){return"callTool"in t&&typeof t.callTool=="function"}function or(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yg extends dt{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var i,o,r,l,u;const d=await this.processParamsForMcpUsage(n);if(!bg(n)||ir(n.config))return await this.generateContentInternal(d);if(Dg(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let c,f;const h=_e(d.contents),m=(r=(o=(i=d.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&r!==void 0?r:nr;let p=0;for(;p<m&&(c=await this.generateContentInternal(d),!(!c.functionCalls||c.functionCalls.length===0));){const g=c.candidates[0].content,y=[];for(const v of(u=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(an(v)){const C=await v.callTool(c.functionCalls);y.push(...C)}p++,f={role:"user",parts:y},d.contents=_e(d.contents),d.contents.push(g),d.contents.push(f),or(d.config)&&(h.push(g),h.push(f))}return or(d.config)&&(c.automaticFunctionCallingHistory=h),c},this.generateContentStream=async n=>{if(ir(n.config)){const i=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var o;let r;const l=[];if(i!=null&&i.generatedImages)for(const d of i.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((o=d==null?void 0:d.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?r=d==null?void 0:d.safetyAttributes:l.push(d);let u;return r?u={generatedImages:l,positivePromptSafetyAttributes:r}:u={generatedImages:l},u}),this.list=async n=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Un(ut.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(o)}}async processParamsForMcpUsage(e){var n,i,o;const r=(n=e.config)===null||n===void 0?void 0:n.tools;if(!r)return e;const l=await Promise.all(r.map(async d=>an(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&nl(e.config.tools)){const d=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let c=Object.assign({},d);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),il(c),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return u}async initAfcToolsMap(e){var n,i,o;const r=new Map;for(const l of(i=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(an(l)){const u=l,d=await u.tool();for(const c of(o=d.functionDeclarations)!==null&&o!==void 0?o:[]){if(!c.name)throw new Error("Function declaration name is required.");if(r.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);r.set(c.name,u)}}return r}async processAfcStream(e){var n,i,o;const r=(o=(i=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:nr;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return function(c,f,h){var m,p;return it(this,arguments,function*(){for(var g,y,v,x;u<r;){l&&(u++,l=!1);const M=yield X(c.processParamsForMcpUsage(h)),D=yield X(c.generateContentStreamInternal(M)),A=[],U=[];try{for(var C=!0,w=(y=void 0,Mt(D)),T;T=yield X(w.next()),g=T.done,!g;C=!0){x=T.value,C=!1;const R=x;if(yield yield X(R),R.candidates&&(!((m=R.candidates[0])===null||m===void 0)&&m.content)){U.push(R.candidates[0].content);for(const N of(p=R.candidates[0].content.parts)!==null&&p!==void 0?p:[])if(u<r&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(N.functionCall.name)){const O=yield X(f.get(N.functionCall.name).callTool([N.functionCall]));A.push(...O)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(R){y={error:R}}finally{try{!C&&!g&&(v=w.return)&&(yield X(v.call(w)))}finally{if(y)throw y.error}}if(A.length>0){l=!0;const R=new mt;R.candidates=[{content:{role:"user",parts:A}}],yield yield X(R);const N=[];N.push(...U),N.push({role:"user",parts:A});const O=_e(h.contents).concat(N);h.contents=O}else break}})}(this,d,e)}async generateContentInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Xs(this.apiClient,e);return u=F("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=js(f),m=new mt;return Object.assign(m,h),m})}else{const c=zs(this.apiClient,e);return u=F("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Qs(f),m=new mt;return Object.assign(m,h),m})}}async generateContentStreamInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Xs(this.apiClient,e);return u=F("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(h){return it(this,arguments,function*(){var m,p,g,y;try{for(var v=!0,x=Mt(h),C;C=yield X(x.next()),m=C.done,!m;v=!0){y=C.value,v=!1;const T=js(yield X(y.json())),M=new mt;Object.assign(M,T),yield yield X(M)}}catch(w){p={error:w}}finally{try{!v&&!m&&(g=x.return)&&(yield X(g.call(x)))}finally{if(p)throw p.error}}})})}else{const c=zs(this.apiClient,e);return u=F("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(h){return it(this,arguments,function*(){var m,p,g,y;try{for(var v=!0,x=Mt(h),C;C=yield X(x.next()),m=C.done,!m;v=!0){y=C.value,v=!1;const T=Qs(yield X(y.json())),M=new mt;Object.assign(M,T),yield yield X(M)}}catch(w){p={error:w}}finally{try{!v&&!m&&(g=x.return)&&(yield X(g.call(x)))}finally{if(p)throw p.error}}})})}}async embedContent(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=np(this.apiClient,e);return u=F("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=ag(f),m=new Ps;return Object.assign(m,h),m})}else{const c=pm(this.apiClient,e);return u=F("{model}:batchEmbedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Up(f),m=new Ps;return Object.assign(m,h),m})}}async generateImagesInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=op(this.apiClient,e);return u=F("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=ug(f),m=new ks;return Object.assign(m,h),m})}else{const c=ym(this.apiClient,e);return u=F("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Bp(f),m=new ks;return Object.assign(m,h),m})}}async editImageInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=dp(this.apiClient,e);return r=F("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=cg(d),f=new mc;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=hp(this.apiClient,e);return r=F("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=dg(d),f=new pc;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=mp(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Ei(f))}else{const c=_m(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>xi(f))}}async listInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=gp(this.apiClient,e);return u=F("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=pg(this.apiClient,f),m=new Ns;return Object.assign(m,h),m})}else{const c=Cm(this.apiClient,e);return u=F("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Gp(this.apiClient,f),m=new Ns;return Object.assign(m,h),m})}}async update(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=_p(this.apiClient,e);return u=F("{model}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Ei(f))}else{const c=wm(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>xi(f))}}async delete(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=vp(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(()=>{const f=gg(),h=new bs;return Object.assign(h,f),h})}else{const c=Sm(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(()=>{const f=qp(),h=new bs;return Object.assign(h,f),h})}}async countTokens(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Tp(this.apiClient,e);return u=F("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=yg(f),m=new Ds;return Object.assign(m,h),m})}else{const c=xm(this.apiClient,e);return u=F("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Jp(f),m=new Ds;return Object.assign(m,h),m})}}async computeTokens(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=wp(this.apiClient,e);return r=F("{model}:computeTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=_g(d),f=new gc;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=xp(this.apiClient,e);return u=F("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>wg(f))}else{const c=Mm(this.apiClient,e);return u=F("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>Yp(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zg(t){const e={},n=s(t,["operationName"]);n!=null&&a(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function zg(t){const e={},n=s(t,["operationName"]);n!=null&&a(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Xg(t){const e={},n=s(t,["operationName"]);n!=null&&a(e,["operationName"],n);const i=s(t,["resourceName"]);i!=null&&a(e,["_url","resourceName"],i);const o=s(t,["config"]);return o!=null&&a(e,["config"],o),e}function Qg(t){const e={},n=s(t,["video","uri"]);n!=null&&a(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&a(e,["videoBytes"],Re(i));const o=s(t,["encoding"]);return o!=null&&a(e,["mimeType"],o),e}function jg(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],Qg(n)),e}function ey(t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>jg(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function ty(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response","generateVideoResponse"]);return l!=null&&a(e,["response"],ey(l)),e}function ny(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&a(e,["videoBytes"],Re(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function iy(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],ny(n)),e}function oy(t){const e={},n=s(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>iy(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function sr(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response"]);return l!=null&&a(e,["response"],oy(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sy extends dt{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let r;return i&&"httpOptions"in i&&(r=i.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:r}})}else return this.getVideosOperationInternal({operationName:n.name,config:i})}async getVideosOperationInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=zg(e);return u=F("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>sr(f))}else{const c=Zg(e);return u=F("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>ty(f))}}async fetchPredictVideosOperationInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=Xg(e);return r=F("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>sr(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ry(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function ol(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],ry(n)),e}function ay(t){const e={},n=s(t,["speaker"]);n!=null&&a(e,["speaker"],n);const i=s(t,["voiceConfig"]);return i!=null&&a(e,["voiceConfig"],ol(i)),e}function ly(t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>ay(o))),a(e,["speakerVoiceConfigs"],i)}return e}function uy(t){const e={},n=s(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],ol(n));const i=s(t,["multiSpeakerVoiceConfig"]);i!=null&&a(e,["multiSpeakerVoiceConfig"],ly(i));const o=s(t,["languageCode"]);return o!=null&&a(e,["languageCode"],o),e}function cy(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function dy(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function fy(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function hy(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],cy(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],dy(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],fy(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function my(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>hy(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function py(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function gy(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function yy(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],gy(n)),e}function _y(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function vy(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],_y(n)),e}function Cy(){return{}}function Ty(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>py(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],yy(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],vy(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],Cy());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function wy(t){const e={},n=s(t,["handle"]);if(n!=null&&a(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function rr(){return{}}function Sy(t){const e={},n=s(t,["disabled"]);n!=null&&a(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&a(e,["startOfSpeechSensitivity"],i);const o=s(t,["endOfSpeechSensitivity"]);o!=null&&a(e,["endOfSpeechSensitivity"],o);const r=s(t,["prefixPaddingMs"]);r!=null&&a(e,["prefixPaddingMs"],r);const l=s(t,["silenceDurationMs"]);return l!=null&&a(e,["silenceDurationMs"],l),e}function Ay(t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],Sy(n));const i=s(t,["activityHandling"]);i!=null&&a(e,["activityHandling"],i);const o=s(t,["turnCoverage"]);return o!=null&&a(e,["turnCoverage"],o),e}function xy(t){const e={},n=s(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function Ey(t){const e={},n=s(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&a(e,["slidingWindow"],xy(i)),e}function Iy(t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function My(t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig"],i);const o=s(t,["responseModalities"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","responseModalities"],o);const r=s(t,["temperature"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig","temperature"],r);const l=s(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=s(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=s(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=s(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=s(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],uy(ji(h)));const m=s(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const p=s(t,["systemInstruction"]);e!==void 0&&p!=null&&a(e,["setup","systemInstruction"],my(ae(p)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let M=Lt(g);Array.isArray(M)&&(M=M.map(D=>Ty(Ft(D)))),a(e,["setup","tools"],M)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&a(e,["setup","sessionResumption"],wy(y));const v=s(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&a(e,["setup","inputAudioTranscription"],rr());const x=s(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&a(e,["setup","outputAudioTranscription"],rr());const C=s(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&a(e,["setup","realtimeInputConfig"],Ay(C));const w=s(t,["contextWindowCompression"]);e!==void 0&&w!=null&&a(e,["setup","contextWindowCompression"],Ey(w));const T=s(t,["proactivity"]);return e!==void 0&&T!=null&&a(e,["setup","proactivity"],Iy(T)),n}function Ry(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["setup","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],My(o,n)),n}function Py(t,e,n){const i={},o=s(e,["expireTime"]);n!==void 0&&o!=null&&a(n,["expireTime"],o);const r=s(e,["newSessionExpireTime"]);n!==void 0&&r!=null&&a(n,["newSessionExpireTime"],r);const l=s(e,["uses"]);n!==void 0&&l!=null&&a(n,["uses"],l);const u=s(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&a(n,["bidiGenerateContentSetup"],Ry(t,u));const d=s(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&a(n,["fieldMask"],d),i}function ky(t,e){const n={},i=s(e,["config"]);return i!=null&&a(n,["config"],Py(t,i,n)),n}function Ny(t){const e={},n=s(t,["name"]);return n!=null&&a(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function by(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(r=>`${n}.${r}`);e.push(...o)}else e.push(n)}return e.join(",")}function Dy(t,e){let n=null;const i=t.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(t.bidiGenerateContentSetup=r,n=r):delete t.bidiGenerateContentSetup}else i!==void 0&&delete t.bidiGenerateContentSetup;const o=t.fieldMask;if(n){const r=by(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?t.fieldMask=r:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];o.length>0&&(u=o.map(c=>l.includes(c)?`generationConfig.${c}`:c));const d=[];r&&d.push(r),u.length>0&&d.push(...u),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?t.fieldMask=o.join(","):delete t.fieldMask;return t}class Fy extends dt{constructor(e){super(),this.apiClient=e}async create(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=ky(this.apiClient,e);r=F("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=Dy(u,e.config);return o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>Ny(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ly(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Uy(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);e!==void 0&&o!=null&&a(e,["_query","pageToken"],o);const r=s(t,["filter"]);return e!==void 0&&r!=null&&a(e,["_query","filter"],r),n}function Vy(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],Uy(n,e)),e}function $y(t){const e={},n=s(t,["textInput"]);n!=null&&a(e,["textInput"],n);const i=s(t,["output"]);return i!=null&&a(e,["output"],i),e}function By(t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>$y(o))),a(e,["examples","examples"],i)}return e}function Oy(t,e){const n={};if(s(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=s(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&a(e,["displayName"],i),s(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=s(t,["epochCount"]);e!==void 0&&o!=null&&a(e,["tuningTask","hyperparameters","epochCount"],o);const r=s(t,["learningRateMultiplier"]);if(r!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],r),s(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(s(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=s(t,["batchSize"]);e!==void 0&&l!=null&&a(e,["tuningTask","hyperparameters","batchSize"],l);const u=s(t,["learningRate"]);return e!==void 0&&u!=null&&a(e,["tuningTask","hyperparameters","learningRate"],u),n}function Gy(t){const e={},n=s(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&a(e,["tuningTask","trainingData"],By(i));const o=s(t,["config"]);return o!=null&&a(e,["config"],Oy(o,e)),e}function qy(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Jy(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);e!==void 0&&o!=null&&a(e,["_query","pageToken"],o);const r=s(t,["filter"]);return e!==void 0&&r!=null&&a(e,["_query","filter"],r),n}function Hy(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],Jy(n,e)),e}function Wy(t,e){const n={},i=s(t,["gcsUri"]);if(e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),s(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Ky(t){const e={},n=s(t,["gcsUri"]);return n!=null&&a(e,["validationDatasetUri"],n),e}function Yy(t,e){const n={},i=s(t,["validationDataset"]);e!==void 0&&i!=null&&a(e,["supervisedTuningSpec"],Ky(i));const o=s(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&a(e,["tunedModelDisplayName"],o);const r=s(t,["description"]);e!==void 0&&r!=null&&a(e,["description"],r);const l=s(t,["epochCount"]);e!==void 0&&l!=null&&a(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const u=s(t,["learningRateMultiplier"]);e!==void 0&&u!=null&&a(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=s(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&a(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const c=s(t,["adapterSize"]);if(e!==void 0&&c!=null&&a(e,["supervisedTuningSpec","hyperParameters","adapterSize"],c),s(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(s(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Zy(t){const e={},n=s(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],Wy(i,e));const o=s(t,["config"]);return o!=null&&a(e,["config"],Yy(o,e)),e}function zy(t){const e={},n=s(t,["name"]);n!=null&&a(e,["model"],n);const i=s(t,["name"]);return i!=null&&a(e,["endpoint"],i),e}function sl(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["state"]);i!=null&&a(e,["state"],Ga(i));const o=s(t,["createTime"]);o!=null&&a(e,["createTime"],o);const r=s(t,["tuningTask","startTime"]);r!=null&&a(e,["startTime"],r);const l=s(t,["tuningTask","completeTime"]);l!=null&&a(e,["endTime"],l);const u=s(t,["updateTime"]);u!=null&&a(e,["updateTime"],u);const d=s(t,["description"]);d!=null&&a(e,["description"],d);const c=s(t,["baseModel"]);c!=null&&a(e,["baseModel"],c);const f=s(t,["_self"]);f!=null&&a(e,["tunedModel"],zy(f));const h=s(t,["distillationSpec"]);h!=null&&a(e,["distillationSpec"],h);const m=s(t,["experiment"]);m!=null&&a(e,["experiment"],m);const p=s(t,["labels"]);p!=null&&a(e,["labels"],p);const g=s(t,["pipelineJob"]);g!=null&&a(e,["pipelineJob"],g);const y=s(t,["serviceAccount"]);y!=null&&a(e,["serviceAccount"],y);const v=s(t,["tunedModelDisplayName"]);return v!=null&&a(e,["tunedModelDisplayName"],v),e}function Xy(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["tunedModels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>sl(r))),a(e,["tuningJobs"],o)}return e}function Qy(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);return r!=null&&a(e,["error"],r),e}function jy(t){const e={},n=s(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const i=s(t,["epoch"]);i!=null&&a(e,["epoch"],i);const o=s(t,["step"]);o!=null&&a(e,["step"],o);const r=s(t,["endpoint"]);return r!=null&&a(e,["endpoint"],r),e}function e_(t){const e={},n=s(t,["model"]);n!=null&&a(e,["model"],n);const i=s(t,["endpoint"]);i!=null&&a(e,["endpoint"],i);const o=s(t,["checkpoints"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>jy(l))),a(e,["checkpoints"],r)}return e}function Mi(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["state"]);i!=null&&a(e,["state"],Ga(i));const o=s(t,["createTime"]);o!=null&&a(e,["createTime"],o);const r=s(t,["startTime"]);r!=null&&a(e,["startTime"],r);const l=s(t,["endTime"]);l!=null&&a(e,["endTime"],l);const u=s(t,["updateTime"]);u!=null&&a(e,["updateTime"],u);const d=s(t,["error"]);d!=null&&a(e,["error"],d);const c=s(t,["description"]);c!=null&&a(e,["description"],c);const f=s(t,["baseModel"]);f!=null&&a(e,["baseModel"],f);const h=s(t,["tunedModel"]);h!=null&&a(e,["tunedModel"],e_(h));const m=s(t,["supervisedTuningSpec"]);m!=null&&a(e,["supervisedTuningSpec"],m);const p=s(t,["tuningDataStats"]);p!=null&&a(e,["tuningDataStats"],p);const g=s(t,["encryptionSpec"]);g!=null&&a(e,["encryptionSpec"],g);const y=s(t,["partnerModelTuningSpec"]);y!=null&&a(e,["partnerModelTuningSpec"],y);const v=s(t,["distillationSpec"]);v!=null&&a(e,["distillationSpec"],v);const x=s(t,["experiment"]);x!=null&&a(e,["experiment"],x);const C=s(t,["labels"]);C!=null&&a(e,["labels"],C);const w=s(t,["pipelineJob"]);w!=null&&a(e,["pipelineJob"],w);const T=s(t,["serviceAccount"]);T!=null&&a(e,["serviceAccount"],T);const M=s(t,["tunedModelDisplayName"]);return M!=null&&a(e,["tunedModelDisplayName"],M),e}function t_(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["tuningJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>Mi(r))),a(e,["tuningJobs"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n_ extends dt{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Un(ut.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const i=await this.tuneMldevInternal(n);let o="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?o=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(o=i.name.split("/operations/")[0]),{name:o,state:Ci.JOB_STATE_QUEUED}}}}async getInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=qy(e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Mi(f))}else{const c=Ly(e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>sl(f))}}async listInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Hy(e);return u=F("tuningJobs",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=t_(f),m=new Fs;return Object.assign(m,h),m})}else{const c=Vy(e);return u=F("tunedModels",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Xy(f),m=new Fs;return Object.assign(m,h),m})}}async tuneInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=Zy(e);return r=F("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Mi(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Gy(e);return r=F("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Qy(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i_{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const o_=1024*1024*8,s_=3,r_=1e3,a_=2,Qn="x-goog-upload-status";async function l_(t,e,n){var i,o,r;let l=0,u=0,d=new Ti(new Response),c="upload";for(l=t.size;u<l;){const h=Math.min(o_,l-u),m=t.slice(u,u+h);u+h>=l&&(c+=", finalize");let p=0,g=r_;for(;p<s_&&(d=await n.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(h)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[Qn]));)p++,await c_(g),g=g*a_;if(u+=h,((o=d==null?void 0:d.headers)===null||o===void 0?void 0:o[Qn])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((r=d==null?void 0:d.headers)===null||r===void 0?void 0:r[Qn])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function u_(t){return{size:t.size,type:t.type}}function c_(t){return new Promise(e=>setTimeout(e,t))}class d_{async upload(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await l_(e,n,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await u_(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f_{create(e,n,i){return new h_(e,n,i)}}class h_{constructor(e,n,i){this.url=e,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ar="x-goog-api-key";class m_{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(ar)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ar,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p_="gl-node/";class g_{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const i=hc(e,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new m_(this.apiKey);this.apiClient=new Pg({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:p_+"web",uploader:new d_,downloader:new i_}),this.models=new Yg(this.apiClient),this.live=new qg(this.apiClient,o,new f_),this.chats=new Bd(this.models,this.apiClient),this.caches=new Ud(this.apiClient),this.files=new jd(this.apiClient),this.operations=new sy(this.apiClient),this.authTokens=new Fy(this.apiClient),this.tunings=new n_(this.apiClient)}}let Ri=null;const Ut=async()=>(Ri??(Ri=await xn.getActiveApiKey("google")),Ri),W_=async()=>{Ri=await xn.getActiveApiKey("google"),ln=null};let ln=null;const On=async()=>{const t=await Ut();return!ln&&t&&(ln=new g_({apiKey:t})),ln},y_=t=>{const e=Array.isArray(t.text)?t.text.join(`
`):t.text;switch(t.sender){case"character":return{role:"model",parts:[{text:e}]};case"user":default:return{role:"user",parts:[{text:e}]}}},rl=t=>{const e=[];let n;if(t.characterInitialPrompt&&(n=t.characterInitialPrompt),t.characterInitialMessage&&t.characterInitialMessage.length>0&&e.push({role:"model",parts:[{text:t.characterInitialMessage.join(`
`)}]}),t.messages&&t.messages.length>0&&t.messages.forEach(i=>{e.push(y_(i))}),e.length>0&&e[e.length-1].role==="model"){let i=-1;for(let o=e.length-1;o>=0;o--)if(e[o].role==="user"){i=o;break}i>=0?e.splice(i+1):e.length===1&&e[0].role==="model"&&e.push({role:"user",parts:[{text:"Hello"}]})}return e.length===0&&e.push({role:"user",parts:[{text:"Hello"}]}),{messages:e,systemInstruction:n}},__=async(t,e="gemini-2.5-flash",n=1e3)=>{var i,o,r,l,u;try{if(!await Ut())throw new Error("Google AI API key is not configured. Please configure your API key in the application settings.");const c=await On();if(!c)throw new Error("Failed to initialize Google AI client");const{messages:f,systemInstruction:h}=rl(t),m=parseFloat(t.temperature)||.7,p=f.map(x=>({role:x.role,parts:x.parts})),g={model:e,contents:p,generationConfig:{temperature:m,maxOutputTokens:n}};h&&(g.systemInstruction={parts:[{text:h}]});const v=(u=(l=(r=(o=(i=(await c.models.generateContent(g)).candidates)==null?void 0:i[0])==null?void 0:o.content)==null?void 0:r.parts)==null?void 0:l[0])==null?void 0:u.text;if(!v)throw new Error("No response received from Google AI");return v}catch(d){throw console.error("Error getting chat completion:",d),d}},v_=async(t,e="gemini-2.5-flash",n=1e3,i)=>{var o,r,l,u,d;try{if(!await Ut())throw new Error("Google AI API key is not configured. Please configure your API key in the application settings.");const f=await On();if(!f)throw new Error("Failed to initialize Google AI client");const{messages:h,systemInstruction:m}=rl(t),p=parseFloat(t.temperature)||.7,g=h.map(C=>({role:C.role,parts:C.parts})),y={model:e,contents:g,generationConfig:{temperature:p,maxOutputTokens:n}};m&&(y.systemInstruction={parts:[{text:m}]});const v=await f.models.generateContentStream(y);let x="";for await(const C of v){const w=(d=(u=(l=(r=(o=C.candidates)==null?void 0:o[0])==null?void 0:r.content)==null?void 0:l.parts)==null?void 0:u[0])==null?void 0:d.text;w&&(x+=w,i==null||i(w))}return x}catch(c){throw console.error("Error getting streaming chat completion:",c),c}},C_=(t,e="character")=>({id:`msg_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,sender:e,text:[t]}),T_=async()=>{var t,e,n,i,o;try{if(!await Ut())return!1;const l=await On();return l?!!((o=(i=(n=(e=(t=(await l.models.generateContent({model:"gemini-1.5-flash",contents:[{role:"user",parts:[{text:"Hello"}]}]})).candidates)==null?void 0:t[0])==null?void 0:e.content)==null?void 0:n.parts)==null?void 0:i[0])!=null&&o.text):!1}catch(r){return console.error("Invalid Google AI API key:",r),!1}},w_=async()=>{try{if(!await Ut())throw new Error("Google AI API key not configured");const e=await On();if(!e)throw new Error("Failed to initialize Google AI client");const n=await e.models.list(),i=[];for await(const r of n)i.push(r);return i.filter(r=>{var l;return((l=r.supportedActions)==null?void 0:l.includes("generateContent"))&&!r.name.includes("embedding")&&!r.name.includes("tts")&&!r.name.includes("image")&&!r.name.includes("aqa")&&!r.name.includes("gemma")}).map(r=>r.name.replace("models/","")).sort((r,l)=>{const u=!r.includes("exp")&&!r.includes("preview"),d=!l.includes("exp")&&!l.includes("preview");return u&&!d?-1:!u&&d?1:r.localeCompare(l)})}catch(t){return console.error("Error fetching available models:",t),["gemini-2.5-pro","gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-pro","gemini-1.5-flash","gemini-1.5-flash-8b"]}},S_=t=>({"gemini-2.5-pro":{name:"Gemini 2.5 Pro",tier:"premium",description:"Most powerful thinking model with maximum response accuracy"},"gemini-2.5-flash":{name:"Gemini 2.5 Flash",tier:"pro",description:"Best model for price-performance with thinking capabilities"},"gemini-2.5-flash-lite-preview-06-17":{name:"Gemini 2.5 Flash Lite",tier:"free",description:"Most cost-efficient model optimized for high throughput"},"gemini-2.0-flash":{name:"Gemini 2.0 Flash",tier:"pro",description:"Next generation model with speed and realtime streaming"},"gemini-2.0-flash-lite":{name:"Gemini 2.0 Flash Lite",tier:"free",description:"Cost-efficient and low latency version of 2.0 Flash"},"gemini-1.5-flash":{name:"Gemini 1.5 Flash",tier:"free",description:"Fast and versatile model for most tasks"},"gemini-1.5-flash-8b":{name:"Gemini 1.5 Flash 8B",tier:"free",description:"Smaller, faster version of Flash for high volume tasks"},"gemini-1.5-pro":{name:"Gemini 1.5 Pro",tier:"pro",description:"Complex reasoning tasks requiring more intelligence"},"gemini-1.0-pro":{name:"Gemini 1.0 Pro",tier:"pro",description:"Previous generation pro model (legacy)"}})[t]||{name:t,tier:"pro",description:"Unknown model"};class A_{constructor(e="openai"){so(this,"provider");this.provider=e}async getChatCompletion(e,n){const{model:i,maxTokens:o=1e3}=n;switch(this.provider){case"openai":return Iu(e,i,o);case"google-ai":return __(e,i,o);default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async getStreamingChatCompletion(e,n,i){const{model:o,maxTokens:r=1e3}=i;switch(this.provider){case"openai":return Mu(e,o,r,n);case"google-ai":return v_(e,o,r,n);default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async validateApiKey(){switch(this.provider){case"openai":return Pu();case"google-ai":return T_();default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async getAvailableModels(){switch(this.provider){case"openai":return ku();case"google-ai":return w_();default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}createMessageFromResponse(e,n="character"){switch(this.provider){case"openai":return Ru(e,n);case"google-ai":return C_(e,n);default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}getProvider(){return this.provider}setProvider(e){this.provider=e}getDefaultModel(){switch(this.provider){case"openai":return"gpt-3.5-turbo";case"google-ai":return"gemini-1.5-flash";default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}getModelInfo(e){switch(this.provider){case"openai":{const n=e.includes("gpt-4");return{name:e,tier:n?"premium":"pro",description:n?"Advanced GPT-4 model":"Standard GPT model",provider:"openai"}}case"google-ai":return{...S_(e),provider:"google-ai"};default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}getProviderDisplayName(){switch(this.provider){case"openai":return"OpenAI";case"google-ai":return"Google AI (Gemini)";default:return this.provider}}}const x_=(t="openai")=>{const[e,n]=J.useState(!1),[i,o]=J.useState(null),[r]=J.useState(()=>new A_(t)),l=J.useCallback(()=>{o(null)},[]),u=J.useCallback(async(g,y={})=>{try{n(!0),o(null);const{model:v=r.getDefaultModel(),maxTokens:x=1e3}=y,C=await r.getChatCompletion(g,{model:v,maxTokens:x});return r.createMessageFromResponse(C)}catch(v){const x=v instanceof Error?v.message:"Unknown error occurred";return o(x),null}finally{n(!1)}},[r]),d=J.useCallback(async(g,y,v={})=>{try{n(!0),o(null);const{model:x=r.getDefaultModel(),maxTokens:C=1e3}=v,w=await r.getStreamingChatCompletion(g,y,{model:x,maxTokens:C});return r.createMessageFromResponse(w)}catch(x){const C=x instanceof Error?x.message:"Unknown error occurred";return o(C),null}finally{n(!1)}},[r]),c=J.useCallback(async()=>{try{return o(null),await r.validateApiKey()}catch(g){const y=g instanceof Error?g.message:"Connection validation failed";return o(y),!1}},[r]),f=J.useCallback(async()=>{try{return o(null),await r.getAvailableModels()}catch(g){const y=g instanceof Error?g.message:"Failed to fetch models";return o(y),[]}},[r]),h=J.useCallback(g=>{r.setProvider(g),l()},[r,l]),m=J.useCallback(()=>r.getProviderDisplayName(),[r]),p=J.useCallback(()=>r.getDefaultModel(),[r]);return{isLoading:e,error:i,currentProvider:r.getProvider(),generateResponse:u,generateStreamingResponse:d,validateConnection:c,getAvailableModels:f,switchProvider:h,getProviderDisplayName:m,getDefaultModel:p,clearError:l}};function E_(t){return Pi({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"},child:[]},{tag:"path",attr:{d:"M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"},child:[]}]})(t)}function K_(t){return Pi({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 1c-1.573 0-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4s.875 1.755 1.904 2.223C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777C13.125 5.755 14 5.007 14 4s-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1"},child:[]},{tag:"path",attr:{d:"M2 7v-.839c.457.432 1.004.751 1.49.972C4.722 7.693 6.318 8 8 8s3.278-.307 4.51-.867c.486-.22 1.033-.54 1.49-.972V7c0 .424-.155.802-.411 1.133a4.51 4.51 0 0 0-4.815 1.843A12 12 0 0 1 8 10c-1.573 0-3.022-.289-4.096-.777C2.875 8.755 2 8.007 2 7m6.257 3.998L8 11c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V10c0 1.007.875 1.755 1.904 2.223C4.978 12.711 6.427 13 8 13h.027a4.55 4.55 0 0 1 .23-2.002m-.002 3L8 14c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V13c0 1.007.875 1.755 1.904 2.223C4.978 15.711 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.5 4.5 0 0 1-1.3-1.905"},child:[]},{tag:"path",attr:{d:"M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0m-3.5-2a.5.5 0 0 0-.5.5v1.5a.5.5 0 0 0 1 0V11a.5.5 0 0 0-.5-.5m0 4a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"},child:[]}]})(t)}function I_(t){return Pi({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z"},child:[]}]})(t)}const M_=J.lazy(()=>En(()=>import("./CharacterSelect-BKEZXnOf.js"),__vite__mapDeps([0,1,2]))),R_=J.lazy(()=>En(()=>import("./AlertModal-NggDLZI1.js"),__vite__mapDeps([3,1,2]))),P_=J.lazy(()=>En(()=>import("./MessageList-iFxNbxM_.js"),__vite__mapDeps([4,1,2]))),k_=J.lazy(()=>En(()=>import("./ChatConfiguration-Ddk6zxZo.js"),__vite__mapDeps([5,1,2])));function N_(){var io,oo;const[t,e]=J.useState(()=>ml()),[n,i]=J.useState(()=>pl(t)),o=J.useRef(null),[r,l]=J.useState(!1),[u,d]=J.useState(!1),[c,f]=J.useState(null),{chats:h,currentChat:m,currentChatId:p,streamingResponse:g,setCurrentChat:y,addMessage:v,createChat:x,setStreamingResponse:C,clearStreamingResponse:w}=gl(),{isLoading:T,error:M,generateResponse:D,generateStreamingResponse:A,validateConnection:U,clearError:R,switchProvider:N}=x_(t),O=Z=>{f(Z),d(!0)},ge=()=>{d(!1),f(null)},Pe=Z=>{e(Z),N(Z),i(Z==="openai"?"gpt-3.5-turbo":"gemini-1.5-flash")},ce=Z=>{i(Z)};J.useEffect(()=>{const Z=()=>{const Ve=yl();y(Ve),setTimeout(()=>{l(!0)},50)};return Z(),window.addEventListener("hashchange",Z),()=>{window.removeEventListener("hashchange",Z)}},[y,h]),J.useEffect(()=>{var Z;(Z=o.current)==null||Z.setActiveTab(0)},[p]);const ke=async()=>{if(!m){O("No chat selected");return}const Z=await D(m,{model:n,maxTokens:1e3});Z&&p&&v(p,Z)},al=async()=>{if(!m||!p){O("No chat selected");return}w(p);const Z=await A(m,Ve=>{C(p,Ve)},{model:n,maxTokens:1e3});Z&&p&&(v(p,Z),w(p))},ll=async()=>{const Z=await U();O(Z?"OpenAI connection is valid!":"OpenAI connection failed!")},ul=()=>{const Z=prompt("Enter your message:");Z&&p&&v(p,{sender:"user",text:[Z]})};return K.jsxs("div",{className:"flex-1 w-full flex flex-col items-center justify-center bg-gray-200 dark:bg-gray-900",children:[K.jsx(J.Suspense,{fallback:K.jsx("div",{children:"Loading..."}),children:K.jsx(R_,{show:u,onClose:ge,okText:"OK",children:c})}),r?K.jsx("div",{className:"w-full flex-1 flex flex-col bg-fixed md:bg-cover md:bg-center bg-no-repeat",style:{backgroundImage:m!=null&&m.backgroundImage?`url(${m.backgroundImage})`:void 0},children:p&&m?K.jsxs("div",{className:"w-full h-auto flex-1 rounded-lg shadow-lg p-2 mt-10 mb-auto",children:[K.jsxs(cr,{ref:o,className:"[&>button]:cursor-pointer [&_[aria-label]]:bg-black/60 rounded-lg","aria-label":"Chat Tabs",variant:"underline",children:[K.jsx(jn,{active:!0,title:"Messages",icon:E_,children:K.jsx(J.Suspense,{fallback:K.jsx("div",{className:"flex items-center justify-center h-64 text-gray-600 dark:text-gray-400",children:"Loading messages..."}),children:K.jsx(P_,{messages:m.messages??[],selectedChat:m,streamingResponse:g})})}),K.jsx(jn,{title:"Configuration",icon:I_,children:K.jsx(J.Suspense,{fallback:K.jsx("div",{className:"flex items-center justify-center h-64 text-gray-600 dark:text-gray-400",children:"Loading configuration..."}),children:K.jsx(k_,{currentChat:m,isLoading:T,error:M,clearError:R,onModelChange:ce,onProviderChange:Pe,selectedModel:n,selectedProvider:t})})})]}),K.jsxs("div",{className:"flex flex-wrap gap-3 mt-6",children:[K.jsx($t,{onClick:ul,className:"bg-blue-500 hover:bg-blue-600 text-white",disabled:T,children:"Add User Message"}),K.jsx($t,{onClick:ke,className:"bg-green-500 hover:bg-green-600 text-white",disabled:T||(((io=m.messages)==null?void 0:io.length)??0)===0,children:T?"Generating...":"Generate Response"}),K.jsx($t,{onClick:al,className:"bg-purple-500 hover:bg-purple-600 text-white",disabled:T||(((oo=m.messages)==null?void 0:oo.length)??0)===0,children:T?"Streaming...":"Stream Response"}),K.jsx($t,{onClick:ll,className:"bg-yellow-500 hover:bg-yellow-600 text-white",disabled:T,children:"Test API Connection"})]})]}):K.jsxs("div",{className:"p-6",children:[K.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-200 mb-4 mt-6",children:"Select a Character to Start a New Chat"}),K.jsx(J.Suspense,{fallback:K.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading character selection..."}),children:K.jsx(M_,{onSelect:async Z=>{const Ve=await x(Z);window.location.hash=`#${Ve}`}})})]})}):K.jsx("div",{className:"flex m-auto items-center justify-center h-full",children:K.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})})]})}const Y_=Object.freeze(Object.defineProperty({__proto__:null,default:N_},Symbol.toStringTag,{value:"Module"}));export{K_ as B,Y_ as M,W_ as a,H_ as r,x_ as u};
