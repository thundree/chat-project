import{G as X,r as s,k as j,j as e,s as S,m as Y,n as F,D as m,o as Z}from"./index-A52IKbjY.js";import{u as ee,B as re,r as E,a as O}from"./MainContent-hCrgSHs0.js";const N=a=>!a||typeof a!="string"?!1:a.startsWith("sk-")&&a.length>=40,A=a=>!a||typeof a!="string"?!1:a.startsWith("AI")&&a.length>=35;function ae(a){return X({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"},child:[]},{tag:"path",attr:{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"},child:[]},{tag:"path",attr:{d:"M12 9l0 3"},child:[]},{tag:"path",attr:{d:"M12 15l.01 0"},child:[]}]})(a)}function oe({currentChat:a,isLoading:g,error:I,clearError:R,onModelChange:w,onProviderChange:T,selectedModel:u,selectedProvider:l}){const[h,K]=s.useState(!1),[D,x]=s.useState(()=>{const{models:r}=j(l);return r}),[B,p]=s.useState(!1),[o,M]=s.useState(""),[i,C]=s.useState(""),[$,f]=s.useState(!1),[W,y]=s.useState(!1),[n,d]=s.useState(!1),{getAvailableModels:b,switchProvider:z,getProviderDisplayName:H,getDefaultModel:_}=ee(l),q=r=>({"gpt-3.5-turbo":"GPT-3.5 Turbo (Recommended)","gpt-4":"GPT-4 (Premium)","gpt-4-turbo-preview":"GPT-4 Turbo (Premium)","gemini-1.5-flash":"Gemini 1.5 Flash (Fast & Free)","gemini-1.5-flash-8b":"Gemini 1.5 Flash 8B (Faster)","gemini-1.5-pro":"Gemini 1.5 Pro (Most Capable)","gemini-1.0-pro":"Gemini 1.0 Pro"})[r]||r,G=r=>r.includes("gpt-4")?"premium":r.includes("gpt")?"pro":r.includes("gemini-1.5-flash")?"free":(r.includes("gemini"),"pro"),J=r=>{w(r),S(r,l)},L=r=>{T(r),z(r),Y(r);const{models:t}=j(r);x(t);const c=_();w(c),S(c,r)},k=async()=>{try{K(!0);const r=await b();r.length>0&&(x(r),F(r,l),p(!1))}catch(r){console.error("Failed to refresh models:",r)}finally{K(!1)}},Q=async()=>{try{const[r,t]=await Promise.all([m.hasApiKey("openai"),m.hasApiKey("google")]);f(r),y(t)}catch(r){console.error("Error checking API keys:",r)}},U=async()=>{if(o.trim()){if(!N(o.trim())){alert("Invalid OpenAI API key format. Keys should start with 'sk-' and be at least 40 characters long.");return}d(!0);try{await m.saveApiKey("openai",o.trim()),await E(),M(""),f(!0),await k()}catch(r){console.error("Error saving OpenAI key:",r),alert("Error saving OpenAI API key. Please try again.")}finally{d(!1)}}},V=async()=>{if(i.trim()){if(!A(i.trim())){alert("Invalid Google AI API key format. Keys should start with 'AI' and be at least 35 characters long.");return}d(!0);try{await m.saveApiKey("google",i.trim()),await O(),C(""),y(!0),await k()}catch(r){console.error("Error saving Google AI key:",r),alert("Error saving Google AI API key. Please try again.")}finally{d(!1)}}},P=async r=>{d(!0);try{const t=await m.getAllApiKeys(r);for(const c of t)await m.deleteApiKey(c.id);r==="openai"?(await E(),f(!1)):(await O(),y(!1))}catch(t){console.error(`Error removing ${r} key:`,t)}finally{d(!1)}};return s.useEffect(()=>{(async()=>{try{const{models:t,timestamp:c}=j(l);if(!Z(c,24)&&t.length>0){x(t),p(!0);return}const v=await b();v.length>0&&(x(v),F(v,l),p(!1))}catch(t){console.log("Could not fetch models, using cached/defaults:",t)}})()},[l,b]),s.useEffect(()=>{Q()},[]),e.jsxs("div",{className:"w-full flex flex-col gap-3 bg-black/80 p-2 rounded-md",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("h2",{className:"text-gray-800 dark:text-gray-200",children:["Chat: ",e.jsx("b",{children:a.title})]}),e.jsxs("p",{className:"text-gray-800 dark:text-gray-200",children:["Character:"," ",e.jsx("b",{style:{color:a.characterColor},children:a.characterName})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Temperature: ",e.jsx("b",{children:a.temperature})]})]}),e.jsxs("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 pt-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"API Key Configuration"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"openai-key-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"OpenAI API Key"}),$?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"âœ“ Configured"}),e.jsx("button",{onClick:()=>P("openai"),disabled:n,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"openai-key-input",type:"password",value:o,onChange:r=>M(r.target.value),placeholder:"sk-...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${o&&!N(o)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:n}),e.jsx("button",{onClick:U,disabled:n||!o.trim()||!N(o),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:n?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"OpenAI Platform"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"google-key-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Google AI API Key"}),W?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"âœ“ Configured"}),e.jsx("button",{onClick:()=>P("google"),disabled:n,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"google-key-input",type:"password",value:i,onChange:r=>C(r.target.value),placeholder:"AI...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${i&&!A(i)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:n}),e.jsx("button",{onClick:V,disabled:n||!i.trim()||!A(i),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:n?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Google AI Studio"})]})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-start gap-2 mb-2",children:e.jsx("label",{htmlFor:"provider-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI Provider"})}),e.jsxs("select",{id:"provider-select",value:l,onChange:r=>L(r.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:g,children:[e.jsx("option",{value:"openai",children:"OpenAI (GPT Models)"}),e.jsx("option",{value:"google-ai",children:"Google AI (Gemini Models)"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Current: ",H()]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 mb-2",children:[e.jsx("label",{htmlFor:"model-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Model"}),G(u)==="premium"&&e.jsx("span",{title:"Premium models may be more expensive",className:"cursor-help text-amber-600 dark:text-amber-400",children:"âš¡ Premium"}),G(u)==="free"&&e.jsx("span",{title:"Free tier model",className:"cursor-help text-green-600 dark:text-green-400",children:"ðŸ†“ Free"})]}),e.jsx("select",{id:"model-select",value:u,onChange:r=>J(r.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:g,children:D.map(r=>e.jsx("option",{value:r,children:q(r)},r))}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex gap-2 mt-3",children:e.jsxs("div",{className:"flex flex-row items-start gap-5",children:[e.jsxs("button",{onClick:()=>{h||k()},disabled:g||h,className:"flex items-center justify-center gap-1 cursor-pointer text-xs text-blue-600 dark:text-blue-400 hover:underline disabled:opacity-50",title:"Refresh available models",children:[e.jsx(ae,{size:16}),e.jsx("span",{children:h?"Refreshing...":"Refresh list"})]}),B&&e.jsxs("span",{title:"Models list loaded from cache, might be outdated",className:"cursor-help flex items-center justify-center gap-1 text-blue-600 dark:text-blue-400",children:[e.jsx(re,{size:16})," Cached models"]})]})})]}),I&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:I}),e.jsx("button",{onClick:R,className:"cursor-pointer mt-2 text-sm hover:underline no-underline",children:"Clear Error"})]})]})}export{oe as default};
