const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MessageList-DtZRcve3.js","assets/index-CFjBsKiS.js","assets/index-D8H8jPvV.css","assets/ChatConfiguration-CJTQ9Leo.js","assets/CharacterSelect-D46iSs8w.js","assets/AlertModal-B6nFR2oo.js"])))=>i.map(i=>d[i]);
var hl=Object.defineProperty;var pl=(t,e,n)=>e in t?hl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oo=(t,e,n)=>pl(t,typeof e!="symbol"?e+"":e,n);import{r as H,u as ar,a as lr,j as q,c as ml,b as gl,g as so,t as Ot,G as ki,d as ur,R as cr,C as Gn,_ as In,D as Nt,l as yl,e as _l,f as vl}from"./index-CFjBsKiS.js";const ei=H.forwardRef((t,e)=>{var r;const n=ar(),{title:i,...o}=lr(t,(r=n.props)==null?void 0:r.tabItem);return q.jsx("div",{ref:e,...o})});ei.displayName="TabItem";const Cl=ml({base:"flex flex-col gap-2",tablist:{base:"flex text-center",variant:{default:"flex-wrap border-b border-gray-200 dark:border-gray-700",underline:"-mb-px flex-wrap border-b border-gray-200 dark:border-gray-700",pills:"flex-wrap space-x-2 text-sm font-medium text-gray-500 dark:text-gray-400",fullWidth:"grid w-full grid-flow-col divide-x divide-gray-200 rounded-none text-sm font-medium shadow dark:divide-gray-700 dark:text-gray-400"},tabitem:{base:"flex items-center justify-center rounded-t-lg p-4 text-sm font-medium first:ml-0 focus:outline-none disabled:cursor-not-allowed disabled:text-gray-400 disabled:dark:text-gray-500",variant:{default:{base:"rounded-t-lg",active:{on:"bg-gray-100 text-primary-600 dark:bg-gray-800 dark:text-primary-500",off:"text-gray-500 hover:bg-gray-50 hover:text-gray-600 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300"}},underline:{base:"rounded-t-lg",active:{on:"rounded-t-lg border-b-2 border-primary-600 text-primary-600 dark:border-primary-500 dark:text-primary-500",off:"border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300"}},pills:{base:"",active:{on:"rounded-lg bg-primary-600 text-white",off:"rounded-lg hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-white"}},fullWidth:{base:"ml-0 flex w-full rounded-none first:ml-0",active:{on:"rounded-none bg-gray-100 p-4 text-gray-900 dark:bg-gray-700 dark:text-white",off:"rounded-none bg-white hover:bg-gray-50 hover:text-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-white"}}},icon:"mr-2 h-5 w-5"}},tabitemcontainer:{base:"",variant:{default:"",underline:"",pills:"",fullWidth:""}},tabpanel:"py-3"}),dr=H.forwardRef((t,e)=>{var I,D;const n=ar(),i=gl([Cl,(I=n.theme)==null?void 0:I.tabs,t.theme],[so(n.clearTheme,"tabs"),t.clearTheme],[so(n.applyTheme,"tabs"),t.applyTheme]),{children:o,className:r,onActiveTabChange:l,variant:u="default",...d}=lr(t,(D=n.props)==null?void 0:D.tabs),c=H.useId(),f=H.useMemo(()=>H.Children.map(H.Children.toArray(o),({props:A})=>A),[o]),h=H.useRef([]),[p,m]=H.useState(Math.max(0,f.findIndex(A=>A.active))),[g,y]=H.useState(-1);function v(A){m(A),l&&l(A)}function x({target:A}){v(A),y(A)}function C({event:A,target:U}){A.key==="ArrowLeft"&&y(Math.max(0,g-1)),A.key==="ArrowRight"&&y(Math.min(f.length-1,g+1)),A.key==="Enter"&&(v(U),y(U))}const T=i.tablist.tabitem.variant[u],w=i.tabitemcontainer.variant[u];return H.useEffect(()=>{var A;(A=h.current[g])==null||A.focus()},[g]),H.useImperativeHandle(e,()=>({setActiveTab:v})),q.jsxs("div",{className:Ot(i.base,r),children:[q.jsx("div",{"aria-label":"Tabs",role:"tablist",className:Ot(i.tablist.base,i.tablist.variant[u],r),...d,children:f.map((A,U)=>q.jsxs("button",{type:"button","aria-controls":`${c}-tabpanel-${U}`,"aria-selected":U===p,className:Ot(i.tablist.tabitem.base,T.base,U===p&&T.active.on,U!==p&&!A.disabled&&T.active.off),disabled:A.disabled,id:`${c}-tab-${U}`,onClick:()=>x({target:U}),onKeyDown:R=>C({event:R,target:U}),ref:R=>{h.current[U]=R},role:"tab",tabIndex:U===g?0:-1,style:{zIndex:U===g?2:1},children:[A.icon&&q.jsx(A.icon,{className:i.tablist.tabitem.icon}),A.title]},U))}),q.jsx("div",{className:Ot(i.tabitemcontainer.base,w),children:f.map((A,U)=>q.jsx("div",{"aria-labelledby":`${c}-tab-${U}`,className:i.tabpanel,hidden:U!==p,id:`${c}-tabpanel-${U}`,role:"tabpanel",tabIndex:0,children:A.children},U))})]})});dr.displayName="Tabs";function Tl(t){return ki({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"},child:[]},{tag:"path",attr:{d:"M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"},child:[]}]})(t)}function B_(t){return ki({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 1c-1.573 0-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4s.875 1.755 1.904 2.223C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777C13.125 5.755 14 5.007 14 4s-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1"},child:[]},{tag:"path",attr:{d:"M2 7v-.839c.457.432 1.004.751 1.49.972C4.722 7.693 6.318 8 8 8s3.278-.307 4.51-.867c.486-.22 1.033-.54 1.49-.972V7c0 .424-.155.802-.411 1.133a4.51 4.51 0 0 0-4.815 1.843A12 12 0 0 1 8 10c-1.573 0-3.022-.289-4.096-.777C2.875 8.755 2 8.007 2 7m6.257 3.998L8 11c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V10c0 1.007.875 1.755 1.904 2.223C4.978 12.711 6.427 13 8 13h.027a4.55 4.55 0 0 1 .23-2.002m-.002 3L8 14c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V13c0 1.007.875 1.755 1.904 2.223C4.978 15.711 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.5 4.5 0 0 1-1.3-1.905"},child:[]},{tag:"path",attr:{d:"M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0m-3.5-2a.5.5 0 0 0-.5.5v1.5a.5.5 0 0 0 1 0V11a.5.5 0 0 0-.5-.5m0 4a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"},child:[]}]})(t)}function wl(t){return ki({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z"},child:[]}]})(t)}const Sl=cr.lazy(()=>In(()=>import("./MessageList-DtZRcve3.js"),__vite__mapDeps([0,1,2]))),Al=cr.lazy(()=>In(()=>import("./ChatConfiguration-CJTQ9Leo.js"),__vite__mapDeps([3,1,2]))),xl=({currentChat:t,streamingResponse:e,isLoading:n,error:i,clearError:o,onModelChange:r,onProviderChange:l,selectedModel:u,selectedProvider:d,addUserMessage:c,handleGenerateResponse:f,handleStreamingResponse:h,handleValidateConnection:p,onSendMessage:m,tabsRef:g})=>{var C,T;const{updateChat:y}=ur(),v=w=>{if(t){const I={...t,userName:w};y(t.id,I)}},x=w=>{if(t){const I={...t,title:w};y(t.id,I)}};return q.jsxs("div",{className:"w-full h-auto flex-1 rounded-lg shadow-lg p-2 mt-10 mb-auto",children:[q.jsxs(dr,{ref:g,className:"[&>button]:cursor-pointer [&_[aria-label]]:bg-black/60 rounded-lg","aria-label":"Chat Tabs",variant:"underline",children:[q.jsx(ei,{active:!0,title:"Messages",icon:Tl,children:q.jsx(H.Suspense,{fallback:q.jsx("div",{className:"flex items-center justify-center h-64 text-gray-600 dark:text-gray-400",children:"Loading messages..."}),children:q.jsx(Sl,{messages:t.messages??[],selectedChat:t,streamingResponse:e,onSendMessage:m,onGenerateResponse:f,isLoading:n})})}),q.jsx(ei,{title:"Configuration",icon:wl,children:q.jsx(H.Suspense,{fallback:q.jsx("div",{className:"flex items-center justify-center h-64 text-gray-600 dark:text-gray-400",children:"Loading configuration..."}),children:q.jsx(Al,{onUserNameChange:v,onTitleChange:x,currentChat:t,isLoading:n,error:i,clearError:o,onModelChange:r,onProviderChange:l,selectedModel:u,selectedProvider:d,onTestApiConnection:p})})})]}),q.jsxs("div",{className:"flex flex-wrap gap-3 mt-6",children:[q.jsx(Gn,{onClick:c,className:"bg-blue-500 hover:bg-blue-600 text-white",disabled:n,children:"Add User Message"}),q.jsx(Gn,{onClick:f,className:"bg-green-500 hover:bg-green-600 text-white",disabled:n||(((C=t.messages)==null?void 0:C.length)??0)===0,children:n?"Generating...":"Generate Response"}),q.jsx(Gn,{onClick:h,className:"bg-purple-500 hover:bg-purple-600 text-white",disabled:n||(((T=t.messages)==null?void 0:T.length)??0)===0,children:n?"Streaming...":"Stream Response"})]})]})};function V(t,e,n,i,o){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function _(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)}let fr=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return fr=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^n()&15>>+i/4).toString(16))};function ti(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const ni=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class L extends Error{}class se extends L{constructor(e,n,i,o){super(`${se.makeMessage(e,n,i)}`),this.status=e,this.headers=o,this.requestID=o==null?void 0:o.get("x-request-id"),this.error=n;const r=n;this.code=r==null?void 0:r.code,this.param=r==null?void 0:r.param,this.type=r==null?void 0:r.type}static makeMessage(e,n,i){const o=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,i,o){if(!e||!o)return new Mn({message:i,cause:ni(n)});const r=n==null?void 0:n.error;return e===400?new hr(e,r,i,o):e===401?new pr(e,r,i,o):e===403?new mr(e,r,i,o):e===404?new gr(e,r,i,o):e===409?new yr(e,r,i,o):e===422?new _r(e,r,i,o):e===429?new vr(e,r,i,o):e>=500?new Cr(e,r,i,o):new se(e,r,i,o)}}class ge extends se{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Mn extends se{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Ni extends Mn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class hr extends se{}class pr extends se{}class mr extends se{}class gr extends se{}class yr extends se{}class _r extends se{}class vr extends se{}class Cr extends se{}class Tr extends L{constructor(){super("Could not parse response content as the length limit was reached")}}class wr extends L{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}const El=/^[a-z][a-z0-9+.-]*:/i,Il=t=>El.test(t);let de=t=>(de=Array.isArray,de(t)),ro=de;function Ml(t){return typeof t!="object"?{}:t??{}}function Rl(t){if(!t)return!0;for(const e in t)return!1;return!0}function Pl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function qn(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const kl=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new L(`${t} must be an integer`);if(e<0)throw new L(`${t} must be a positive integer`);return e},Nl=t=>{try{return JSON.parse(t)}catch{return}},bt=t=>new Promise(e=>setTimeout(e,t)),Xe="5.5.1",bl=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Dl(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Fl=()=>{var n;const t=Dl();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":lo(Deno.build.os),"X-Stainless-Arch":ao(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":lo(globalThis.process.platform??"unknown"),"X-Stainless-Arch":ao(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=Ll();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Ll(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const i=n.exec(navigator.userAgent);if(i){const o=i[1]||0,r=i[2]||0,l=i[3]||0;return{browser:e,version:`${o}.${r}.${l}`}}}return null}const ao=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",lo=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let uo;const Ul=()=>uo??(uo=Fl());function Vl(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Sr(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function Ar(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Sr({start(){},async pull(n){const{done:i,value:o}=await e.next();i?n.close():n.enqueue(o)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function xr(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function $l(t){var i,o;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((o=(i=t[Symbol.asyncIterator]()).return)==null?void 0:o.call(i));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const Bl=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),Er="RFC3986",Ir=t=>String(t),co={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:Ir},Ol="RFC1738";let ii=(t,e)=>(ii=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),ii(t,e));const Ce=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),Jn=1024,Gl=(t,e,n,i,o)=>{if(t.length===0)return t;let r=t;if(typeof t=="symbol"?r=Symbol.prototype.toString.call(t):typeof t!="string"&&(r=String(t)),n==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});let l="";for(let u=0;u<r.length;u+=Jn){const d=r.length>=Jn?r.slice(u,u+Jn):r,c=[];for(let f=0;f<d.length;++f){let h=d.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||o===Ol&&(h===40||h===41)){c[c.length]=d.charAt(f);continue}if(h<128){c[c.length]=Ce[h];continue}if(h<2048){c[c.length]=Ce[192|h>>6]+Ce[128|h&63];continue}if(h<55296||h>=57344){c[c.length]=Ce[224|h>>12]+Ce[128|h>>6&63]+Ce[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|d.charCodeAt(f)&1023),c[c.length]=Ce[240|h>>18]+Ce[128|h>>12&63]+Ce[128|h>>6&63]+Ce[128|h&63]}l+=c.join("")}return l};function ql(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function fo(t,e){if(de(t)){const n=[];for(let i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)}const Mr={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Rr=function(t,e){Array.prototype.push.apply(t,de(e)?e:[e])};let ho;const te={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Gl,encodeValuesOnly:!1,format:Er,formatter:Ir,indices:!1,serializeDate(t){return(ho??(ho=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function Jl(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Hn={};function Pr(t,e,n,i,o,r,l,u,d,c,f,h,p,m,g,y,v,x){let C=t,T=x,w=0,I=!1;for(;(T=T.get(Hn))!==void 0&&!I;){const N=T.get(t);if(w+=1,typeof N<"u"){if(N===w)throw new RangeError("Cyclic object value");I=!0}typeof T.get(Hn)>"u"&&(w=0)}if(typeof c=="function"?C=c(e,C):C instanceof Date?C=p==null?void 0:p(C):n==="comma"&&de(C)&&(C=fo(C,function(N){return N instanceof Date?p==null?void 0:p(N):N})),C===null){if(r)return d&&!y?d(e,te.encoder,v,"key",m):e;C=""}if(Jl(C)||ql(C)){if(d){const N=y?e:d(e,te.encoder,v,"key",m);return[(g==null?void 0:g(N))+"="+(g==null?void 0:g(d(C,te.encoder,v,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(C)))]}const D=[];if(typeof C>"u")return D;let A;if(n==="comma"&&de(C))y&&d&&(C=fo(C,d)),A=[{value:C.length>0?C.join(",")||null:void 0}];else if(de(c))A=c;else{const N=Object.keys(C);A=f?N.sort(f):N}const U=u?String(e).replace(/\./g,"%2E"):String(e),R=i&&de(C)&&C.length===1?U+"[]":U;if(o&&de(C)&&C.length===0)return R+"[]";for(let N=0;N<A.length;++N){const G=A[N],ie=typeof G=="object"&&typeof G.value<"u"?G.value:C[G];if(l&&ie===null)continue;const ke=h&&u?G.replace(/\./g,"%2E"):G,fe=de(C)?typeof n=="function"?n(R,ke):R:R+(h?"."+ke:"["+ke+"]");x.set(t,w);const Ne=new WeakMap;Ne.set(Hn,x),Rr(D,Pr(ie,fe,n,i,o,r,l,u,n==="comma"&&y&&de(C)?null:d,c,f,h,p,m,g,y,v,Ne))}return D}function Hl(t=te){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||te.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=Er;if(typeof t.format<"u"){if(!ii(co,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const i=co[n];let o=te.filter;(typeof t.filter=="function"||de(t.filter))&&(o=t.filter);let r;if(t.arrayFormat&&t.arrayFormat in Mr?r=t.arrayFormat:"indices"in t?r=t.indices?"indices":"repeat":r=te.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const l=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:te.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:te.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:te.allowEmptyArrays,arrayFormat:r,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:te.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?te.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:te.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:te.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:te.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:te.encodeValuesOnly,filter:o,format:n,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:te.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:te.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:te.strictNullHandling}}function Wl(t,e={}){let n=t;const i=Hl(e);let o,r;typeof i.filter=="function"?(r=i.filter,n=r("",n)):de(i.filter)&&(r=i.filter,o=r);const l=[];if(typeof n!="object"||n===null)return"";const u=Mr[i.arrayFormat],d=u==="comma"&&i.commaRoundTrip;o||(o=Object.keys(n)),i.sort&&o.sort(i.sort);const c=new WeakMap;for(let p=0;p<o.length;++p){const m=o[p];i.skipNulls&&n[m]===null||Rr(l,Pr(n[m],m,u,d,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}const f=l.join(i.delimiter);let h=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),f.length>0?h+f:""}function Kl(t){let e=0;for(const o of t)e+=o.length;const n=new Uint8Array(e);let i=0;for(const o of t)n.set(o,i),i+=o.length;return n}let po;function bi(t){let e;return(po??(e=new globalThis.TextEncoder,po=e.encode.bind(e)))(t)}let mo;function go(t){let e;return(mo??(e=new globalThis.TextDecoder,mo=e.decode.bind(e)))(t)}var he,pe;class Rn{constructor(){he.set(this,void 0),pe.set(this,void 0),V(this,he,new Uint8Array),V(this,pe,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?bi(e):e;V(this,he,Kl([_(this,he,"f"),n]));const i=[];let o;for(;(o=Yl(_(this,he,"f"),_(this,pe,"f")))!=null;){if(o.carriage&&_(this,pe,"f")==null){V(this,pe,o.index);continue}if(_(this,pe,"f")!=null&&(o.index!==_(this,pe,"f")+1||o.carriage)){i.push(go(_(this,he,"f").subarray(0,_(this,pe,"f")-1))),V(this,he,_(this,he,"f").subarray(_(this,pe,"f"))),V(this,pe,null);continue}const r=_(this,pe,"f")!==null?o.preceding-1:o.preceding,l=go(_(this,he,"f").subarray(0,r));i.push(l),V(this,he,_(this,he,"f").subarray(o.index)),V(this,pe,null)}return i}flush(){return _(this,he,"f").length?this.decode(`
`):[]}}he=new WeakMap,pe=new WeakMap;Rn.NEWLINE_CHARS=new Set([`
`,"\r"]);Rn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Yl(t,e){for(let o=e??0;o<t.length;o++){if(t[o]===10)return{preceding:o,index:o+1,carriage:!1};if(t[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function Zl(t){for(let i=0;i<t.length-1;i++){if(t[i]===10&&t[i+1]===10||t[i]===13&&t[i+1]===13)return i+2;if(t[i]===13&&t[i+1]===10&&i+3<t.length&&t[i+2]===13&&t[i+3]===10)return i+4}return-1}class we{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let i=!1;async function*o(){if(i)throw new L("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let r=!1;try{for await(const l of zl(e,n))if(!r){if(l.data.startsWith("[DONE]")){r=!0;continue}if(l.event===null||l.event.startsWith("response.")||l.event.startsWith("transcript.")){let u;try{u=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(u&&u.error)throw new se(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(l.event=="error")throw new se(void 0,u.error,u.message,void 0);yield{event:l.event,data:u}}}r=!0}catch(l){if(ti(l))return;throw l}finally{r||n.abort()}}return new we(o,n)}static fromReadableStream(e,n){let i=!1;async function*o(){const l=new Rn,u=xr(e);for await(const d of u)for(const c of l.decode(d))yield c;for(const d of l.flush())yield d}async function*r(){if(i)throw new L("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let l=!1;try{for await(const u of o())l||u&&(yield JSON.parse(u));l=!0}catch(u){if(ti(u))return;throw u}finally{l||n.abort()}}return new we(r,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],i=this.iterator(),o=r=>({next:()=>{if(r.length===0){const l=i.next();e.push(l),n.push(l)}return r.shift()}});return[new we(()=>o(e),this.controller),new we(()=>o(n),this.controller)]}toReadableStream(){const e=this;let n;return Sr({async start(){n=e[Symbol.asyncIterator]()},async pull(i){try{const{value:o,done:r}=await n.next();if(r)return i.close();const l=bi(JSON.stringify(o)+`
`);i.enqueue(l)}catch(o){i.error(o)}},async cancel(){var i;await((i=n.return)==null?void 0:i.call(n))}})}}async function*zl(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new L("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new L("Attempted to iterate over a response with no body");const n=new Ql,i=new Rn,o=xr(t.body);for await(const r of Xl(o))for(const l of i.decode(r)){const u=n.decode(l);u&&(yield u)}for(const r of i.flush()){const l=n.decode(r);l&&(yield l)}}async function*Xl(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const i=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?bi(n):n;let o=new Uint8Array(e.length+i.length);o.set(e),o.set(i,e.length),e=o;let r;for(;(r=Zl(e))!==-1;)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}class Ql{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,i,o]=jl(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function jl(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const dn={off:0,error:200,warn:300,info:400,debug:500},yo=(t,e,n)=>{if(t){if(Pl(dn,t))return t;re(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(dn))}`)}};function gt(){}function Gt(t,e,n){return!e||dn[t]>dn[n]?gt:e[t].bind(e)}const eu={error:gt,warn:gt,info:gt,debug:gt};let _o=new WeakMap;function re(t){const e=t.logger,n=t.logLevel??"off";if(!e)return eu;const i=_o.get(e);if(i&&i[0]===n)return i[1];const o={error:Gt("error",e,n),warn:Gt("warn",e,n),info:Gt("info",e,n),debug:Gt("debug",e,n)};return _o.set(e,[n,o]),o}const Be=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);async function kr(t,e){const{response:n,requestLogID:i,retryOfRequestLogID:o,startTime:r}=e,l=await(async()=>{var h;if(e.options.stream)return re(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller):we.fromSSEResponse(n,e.controller);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const u=n.headers.get("content-type"),d=(h=u==null?void 0:u.split(";")[0])==null?void 0:h.trim();if((d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))){const p=await n.json();return Nr(p,n)}return await n.text()})();return re(t).debug(`[${i}] response parsed`,Be({retryOfRequestLogID:o,url:n.url,status:n.status,body:l,durationMs:Date.now()-r})),l}function Nr(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var yt;class Pn extends Promise{constructor(e,n,i=kr){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=i,yt.set(this,void 0),V(this,yt,e)}_thenUnwrap(e){return new Pn(_(this,yt,"f"),this.responsePromise,async(n,i)=>Nr(e(await this.parseResponse(n,i),i),i.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(_(this,yt,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}yt=new WeakMap;var qt;class br{constructor(e,n,i,o){qt.set(this,void 0),V(this,qt,e),this.options=o,this.response=n,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new L("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await _(this,qt,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(qt=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class tu extends Pn{constructor(e,n,i){super(e,n,async(o,r)=>new i(o,r.response,await kr(o,r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class kn extends br{constructor(e,n,i,o){super(e,n,i,o),this.data=i.data||[],this.object=i.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Q extends br{constructor(e,n,i,o){super(e,n,i,o),this.data=i.data||[],this.has_more=i.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var i;const e=this.getPaginatedItems(),n=(i=e[e.length-1])==null?void 0:i.id;return n?{...this.options,query:{...Ml(this.options.query),after:n}}:null}}const Dr=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Et(t,e,n){return Dr(),new File(t,e??"unknown_file",n)}function Xt(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Fr=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Je=async(t,e)=>({...t,body:await iu(t.body,e)}),vo=new WeakMap;function nu(t){const e=typeof t=="function"?t:t.fetch,n=vo.get(e);if(n)return n;const i=(async()=>{try{const o="Response"in e?e.Response:(await e("data:,")).constructor,r=new FormData;return r.toString()!==await new o(r).text()}catch{return!0}})();return vo.set(e,i),i}const iu=async(t,e)=>{if(!await nu(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([i,o])=>oi(n,i,o))),n},ou=t=>t instanceof Blob&&"name"in t,oi=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,Et([await n.blob()],Xt(n)));else if(Fr(n))t.append(e,Et([await new Response(Ar(n)).blob()],Xt(n)));else if(ou(n))t.append(e,n,Xt(n));else if(Array.isArray(n))await Promise.all(n.map(i=>oi(t,e+"[]",i)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([i,o])=>oi(t,`${e}[${i}]`,o)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},Lr=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",su=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Lr(t),ru=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function au(t,e,n){if(Dr(),t=await t,su(t))return t instanceof File?t:Et([await t.arrayBuffer()],t.name);if(ru(t)){const o=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Et(await si(o),e,n)}const i=await si(t);if(e||(e=Xt(t)),!(n!=null&&n.type)){const o=i.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof o=="string"&&(n={...n,type:o})}return Et(i,e,n)}async function si(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Lr(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(Fr(t))for await(const i of t)e.push(...await si(i));else{const i=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${i?`; constructor: ${i}`:""}${lu(t)}`)}return e}function lu(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class B{constructor(e){this._client=e}}function Ur(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const uu=(t=Ur)=>function(n,...i){if(n.length===1)return n[0];let o=!1;const r=n.reduce((f,h,p)=>(/[?#]/.test(h)&&(o=!0),f+h+(p===i.length?"":(o?encodeURIComponent:t)(String(i[p])))),""),l=r.split(/[?#]/,1)[0],u=[],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=d.exec(l))!==null;)u.push({start:c.index,length:c[0].length});if(u.length>0){let f=0;const h=u.reduce((p,m)=>{const g=" ".repeat(m.start-f),y="^".repeat(m.length);return f=m.start+m.length,p+g+y},"");throw new L(`Path parameters result in path with invalid segments:
${r}
${h}`)}return r},E=uu(Ur);let Vr=class extends B{list(e,n={},i){return this._client.getAPIList(E`/chat/completions/${e}/messages`,Q,{query:n,...i})}};function cu(t){return typeof t.parse=="function"}const fn=t=>(t==null?void 0:t.role)==="assistant",$r=t=>(t==null?void 0:t.role)==="tool";var ri,Qt,jt,_t,vt,en,Ct,Me,Tt,hn,pn,Qe,Br;class Di{constructor(){ri.add(this),this.controller=new AbortController,Qt.set(this,void 0),jt.set(this,()=>{}),_t.set(this,()=>{}),vt.set(this,void 0),en.set(this,()=>{}),Ct.set(this,()=>{}),Me.set(this,{}),Tt.set(this,!1),hn.set(this,!1),pn.set(this,!1),Qe.set(this,!1),V(this,Qt,new Promise((e,n)=>{V(this,jt,e,"f"),V(this,_t,n,"f")})),V(this,vt,new Promise((e,n)=>{V(this,en,e,"f"),V(this,Ct,n,"f")})),_(this,Qt,"f").catch(()=>{}),_(this,vt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},_(this,ri,"m",Br).bind(this))},0)}_connected(){this.ended||(_(this,jt,"f").call(this),this._emit("connect"))}get ended(){return _(this,Tt,"f")}get errored(){return _(this,hn,"f")}get aborted(){return _(this,pn,"f")}abort(){this.controller.abort()}on(e,n){return(_(this,Me,"f")[e]||(_(this,Me,"f")[e]=[])).push({listener:n}),this}off(e,n){const i=_(this,Me,"f")[e];if(!i)return this;const o=i.findIndex(r=>r.listener===n);return o>=0&&i.splice(o,1),this}once(e,n){return(_(this,Me,"f")[e]||(_(this,Me,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,i)=>{V(this,Qe,!0),e!=="error"&&this.once("error",i),this.once(e,n)})}async done(){V(this,Qe,!0),await _(this,vt,"f")}_emit(e,...n){if(_(this,Tt,"f"))return;e==="end"&&(V(this,Tt,!0),_(this,en,"f").call(this));const i=_(this,Me,"f")[e];if(i&&(_(this,Me,"f")[e]=i.filter(o=>!o.once),i.forEach(({listener:o})=>o(...n))),e==="abort"){const o=n[0];!_(this,Qe,"f")&&!(i!=null&&i.length)&&Promise.reject(o),_(this,_t,"f").call(this,o),_(this,Ct,"f").call(this,o),this._emit("end");return}if(e==="error"){const o=n[0];!_(this,Qe,"f")&&!(i!=null&&i.length)&&Promise.reject(o),_(this,_t,"f").call(this,o),_(this,Ct,"f").call(this,o),this._emit("end")}}_emitFinal(){}}Qt=new WeakMap,jt=new WeakMap,_t=new WeakMap,vt=new WeakMap,en=new WeakMap,Ct=new WeakMap,Me=new WeakMap,Tt=new WeakMap,hn=new WeakMap,pn=new WeakMap,Qe=new WeakMap,ri=new WeakSet,Br=function(e){if(V(this,hn,!0),e instanceof Error&&e.name==="AbortError"&&(e=new ge),e instanceof ge)return V(this,pn,!0),this._emit("abort",e);if(e instanceof L)return this._emit("error",e);if(e instanceof Error){const n=new L(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new L(String(e)))};function Fi(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Dt(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function du(t,e){return!e||!Or(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Li(t,e)}function Li(t,e){const n=t.choices.map(i=>{var o;if(i.finish_reason==="length")throw new Tr;if(i.finish_reason==="content_filter")throw new wr;return{...i,message:{...i.message,...i.message.tool_calls?{tool_calls:((o=i.message.tool_calls)==null?void 0:o.map(r=>hu(e,r)))??void 0}:void 0,parsed:i.message.content&&!i.message.refusal?fu(e,i.message.content):null}}});return{...t,choices:n}}function fu(t,e){var n,i;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((i=t.response_format)==null?void 0:i.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function hu(t,e){var i;const n=(i=t.tools)==null?void 0:i.find(o=>{var r;return((r=o.function)==null?void 0:r.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Dt(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function pu(t,e){var i;if(!t)return!1;const n=(i=t.tools)==null?void 0:i.find(o=>{var r;return((r=o.function)==null?void 0:r.name)===e.function.name});return Dt(n)||(n==null?void 0:n.function.strict)||!1}function Or(t){var e;return Fi(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Dt(n)||n.type==="function"&&n.function.strict===!0))??!1}function mu(t){for(const e of t??[]){if(e.type!=="function")throw new L(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new L(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var le,ai,mn,li,ui,ci,Gr,qr;const gu=10;class Jr extends Di{constructor(){super(...arguments),le.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var i;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(i=e.choices[0])==null?void 0:i.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),$r(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(fn(e)&&e.tool_calls)for(const i of e.tool_calls)i.type==="function"&&this._emit("functionToolCall",i.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new L("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),_(this,le,"m",ai).call(this)}async finalMessage(){return await this.done(),_(this,le,"m",mn).call(this)}async finalFunctionToolCall(){return await this.done(),_(this,le,"m",li).call(this)}async finalFunctionToolCallResult(){return await this.done(),_(this,le,"m",ui).call(this)}async totalUsage(){return await this.done(),_(this,le,"m",ci).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=_(this,le,"m",mn).call(this);n&&this._emit("finalMessage",n);const i=_(this,le,"m",ai).call(this);i&&this._emit("finalContent",i);const o=_(this,le,"m",li).call(this);o&&this._emit("finalFunctionToolCall",o);const r=_(this,le,"m",ui).call(this);r!=null&&this._emit("finalFunctionToolCallResult",r),this._chatCompletions.some(l=>l.usage)&&this._emit("totalUsage",_(this,le,"m",ci).call(this))}async _createChatCompletion(e,n,i){const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),_(this,le,"m",Gr).call(this,n);const r=await e.chat.completions.create({...n,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Li(r,n))}async _runChatCompletion(e,n,i){for(const o of n.messages)this._addMessage(o,!1);return await this._createChatCompletion(e,n,i)}async _runTools(e,n,i){var m,g,y;const o="tool",{tool_choice:r="auto",stream:l,...u}=n,d=typeof r!="string"&&((m=r==null?void 0:r.function)==null?void 0:m.name),{maxChatCompletions:c=gu}=i||{},f=n.tools.map(v=>{if(Dt(v)){if(!v.$callback)throw new L("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),h={};for(const v of f)v.type==="function"&&(h[v.function.name||v.function.function.name]=v.function);const p="tools"in n?f.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<c;++v){const C=(g=(await this._createChatCompletion(e,{...u,tool_choice:r,tools:p,messages:[...this.messages]},i)).choices[0])==null?void 0:g.message;if(!C)throw new L("missing message in ChatCompletion response");if(!((y=C.tool_calls)!=null&&y.length))return;for(const T of C.tool_calls){if(T.type!=="function")continue;const w=T.id,{name:I,arguments:D}=T.function,A=h[I];if(A){if(d&&d!==I){const G=`Invalid tool_call: ${JSON.stringify(I)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:o,tool_call_id:w,content:G});continue}}else{const G=`Invalid tool_call: ${JSON.stringify(I)}. Available options are: ${Object.keys(h).map(ie=>JSON.stringify(ie)).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:w,content:G});continue}let U;try{U=cu(A)?await A.parse(D):D}catch(G){const ie=G instanceof Error?G.message:String(G);this._addMessage({role:o,tool_call_id:w,content:ie});continue}const R=await A.function(U,this),N=_(this,le,"m",qr).call(this,R);if(this._addMessage({role:o,tool_call_id:w,content:N}),d)return}}}}le=new WeakSet,ai=function(){return _(this,le,"m",mn).call(this).content??null},mn=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(fn(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new L("stream ended without producing a ChatCompletionMessage with role=assistant")},li=function(){var e,n;for(let i=this.messages.length-1;i>=0;i--){const o=this.messages[i];if(fn(o)&&((e=o==null?void 0:o.tool_calls)!=null&&e.length))return(n=o.tool_calls.at(-1))==null?void 0:n.function}},ui=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if($r(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(i=>{var o;return i.role==="assistant"&&((o=i.tool_calls)==null?void 0:o.some(r=>r.type==="function"&&r.id===n.tool_call_id))}))return n.content}},ci=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Gr=function(e){if(e.n!=null&&e.n>1)throw new L("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},qr=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ui extends Jr{static runTools(e,n,i){const o=new Ui,r={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(e,n,r)),o}_addMessage(e,n=!0){super._addMessage(e,n),fn(e)&&e.content&&this._emit("content",e.content)}}const Hr=1,Wr=2,Kr=4,Yr=8,Zr=16,zr=32,Xr=64,Qr=128,jr=256,ea=Qr|jr,ta=Zr|zr|ea|Xr,na=Hr|Wr|ta,ia=Kr|Yr,yu=na|ia,ne={STR:Hr,NUM:Wr,ARR:Kr,OBJ:Yr,NULL:Zr,BOOL:zr,NAN:Xr,INFINITY:Qr,MINUS_INFINITY:jr,INF:ea,SPECIAL:ta,ATOM:na,COLLECTION:ia,ALL:yu};class _u extends Error{}class vu extends Error{}function Cu(t,e=ne.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return Tu(t.trim(),e)}const Tu=(t,e)=>{const n=t.length;let i=0;const o=p=>{throw new _u(`${p} at position ${i}`)},r=p=>{throw new vu(`${p} at position ${i}`)},l=()=>(h(),i>=n&&o("Unexpected end of input"),t[i]==='"'?u():t[i]==="{"?d():t[i]==="["?c():t.substring(i,i+4)==="null"||ne.NULL&e&&n-i<4&&"null".startsWith(t.substring(i))?(i+=4,null):t.substring(i,i+4)==="true"||ne.BOOL&e&&n-i<4&&"true".startsWith(t.substring(i))?(i+=4,!0):t.substring(i,i+5)==="false"||ne.BOOL&e&&n-i<5&&"false".startsWith(t.substring(i))?(i+=5,!1):t.substring(i,i+8)==="Infinity"||ne.INFINITY&e&&n-i<8&&"Infinity".startsWith(t.substring(i))?(i+=8,1/0):t.substring(i,i+9)==="-Infinity"||ne.MINUS_INFINITY&e&&1<n-i&&n-i<9&&"-Infinity".startsWith(t.substring(i))?(i+=9,-1/0):t.substring(i,i+3)==="NaN"||ne.NAN&e&&n-i<3&&"NaN".startsWith(t.substring(i))?(i+=3,NaN):f()),u=()=>{const p=i;let m=!1;for(i++;i<n&&(t[i]!=='"'||m&&t[i-1]==="\\");)m=t[i]==="\\"?!m:!1,i++;if(t.charAt(i)=='"')try{return JSON.parse(t.substring(p,++i-Number(m)))}catch(g){r(String(g))}else if(ne.STR&e)try{return JSON.parse(t.substring(p,i-Number(m))+'"')}catch{return JSON.parse(t.substring(p,t.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},d=()=>{i++,h();const p={};try{for(;t[i]!=="}";){if(h(),i>=n&&ne.OBJ&e)return p;const m=u();h(),i++;try{const g=l();Object.defineProperty(p,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(ne.OBJ&e)return p;throw g}h(),t[i]===","&&i++}}catch{if(ne.OBJ&e)return p;o("Expected '}' at end of object")}return i++,p},c=()=>{i++;const p=[];try{for(;t[i]!=="]";)p.push(l()),h(),t[i]===","&&i++}catch{if(ne.ARR&e)return p;o("Expected ']' at end of array")}return i++,p},f=()=>{if(i===0){t==="-"&&ne.NUM&e&&o("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(ne.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}r(String(m))}}const p=i;for(t[i]==="-"&&i++;t[i]&&!",]}".includes(t[i]);)i++;i==n&&!(ne.NUM&e)&&o("Unterminated number literal");try{return JSON.parse(t.substring(p,i))}catch{t.substring(p,i)==="-"&&ne.NUM&e&&o("Not sure what '-' is");try{return JSON.parse(t.substring(p,t.lastIndexOf("e")))}catch(g){r(String(g))}}},h=()=>{for(;i<n&&` 
\r	`.includes(t[i]);)i++};return l()},Co=t=>Cu(t,ne.ALL^ne.NUM);var ee,Ie,Ye,be,Wn,Jt,Kn,Yn,Zn,Ht,zn,To;class Pt extends Jr{constructor(e){super(),ee.add(this),Ie.set(this,void 0),Ye.set(this,void 0),be.set(this,void 0),V(this,Ie,e),V(this,Ye,[])}get currentChatCompletionSnapshot(){return _(this,be,"f")}static fromReadableStream(e){const n=new Pt(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,i){const o=new Pt(n);return o._run(()=>o._runChatCompletion(e,{...n,stream:!0},{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createChatCompletion(e,n,i){var l;super._createChatCompletion;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),_(this,ee,"m",Wn).call(this);const r=await e.chat.completions.create({...n,stream:!0},{...i,signal:this.controller.signal});this._connected();for await(const u of r)_(this,ee,"m",Kn).call(this,u);if((l=r.controller.signal)!=null&&l.aborted)throw new ge;return this._addChatCompletion(_(this,ee,"m",Ht).call(this))}async _fromReadableStream(e,n){var l;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),_(this,ee,"m",Wn).call(this),this._connected();const o=we.fromReadableStream(e,this.controller);let r;for await(const u of o)r&&r!==u.id&&this._addChatCompletion(_(this,ee,"m",Ht).call(this)),_(this,ee,"m",Kn).call(this,u),r=u.id;if((l=o.controller.signal)!=null&&l.aborted)throw new ge;return this._addChatCompletion(_(this,ee,"m",Ht).call(this))}[(Ie=new WeakMap,Ye=new WeakMap,be=new WeakMap,ee=new WeakSet,Wn=function(){this.ended||V(this,be,void 0)},Jt=function(n){let i=_(this,Ye,"f")[n.index];return i||(i={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},_(this,Ye,"f")[n.index]=i,i)},Kn=function(n){var o,r,l,u,d,c,f,h,p,m,g,y,v,x,C;if(this.ended)return;const i=_(this,ee,"m",To).call(this,n);this._emit("chunk",n,i);for(const T of n.choices){const w=i.choices[T.index];T.delta.content!=null&&((o=w.message)==null?void 0:o.role)==="assistant"&&((r=w.message)!=null&&r.content)&&(this._emit("content",T.delta.content,w.message.content),this._emit("content.delta",{delta:T.delta.content,snapshot:w.message.content,parsed:w.message.parsed})),T.delta.refusal!=null&&((l=w.message)==null?void 0:l.role)==="assistant"&&((u=w.message)!=null&&u.refusal)&&this._emit("refusal.delta",{delta:T.delta.refusal,snapshot:w.message.refusal}),((d=T.logprobs)==null?void 0:d.content)!=null&&((c=w.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=T.logprobs)==null?void 0:f.content,snapshot:((h=w.logprobs)==null?void 0:h.content)??[]}),((p=T.logprobs)==null?void 0:p.refusal)!=null&&((m=w.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=T.logprobs)==null?void 0:g.refusal,snapshot:((y=w.logprobs)==null?void 0:y.refusal)??[]});const I=_(this,ee,"m",Jt).call(this,w);w.finish_reason&&(_(this,ee,"m",Zn).call(this,w),I.current_tool_call_index!=null&&_(this,ee,"m",Yn).call(this,w,I.current_tool_call_index));for(const D of T.delta.tool_calls??[])I.current_tool_call_index!==D.index&&(_(this,ee,"m",Zn).call(this,w),I.current_tool_call_index!=null&&_(this,ee,"m",Yn).call(this,w,I.current_tool_call_index)),I.current_tool_call_index=D.index;for(const D of T.delta.tool_calls??[]){const A=(v=w.message.tool_calls)==null?void 0:v[D.index];A!=null&&A.type&&((A==null?void 0:A.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(x=A.function)==null?void 0:x.name,index:D.index,arguments:A.function.arguments,parsed_arguments:A.function.parsed_arguments,arguments_delta:((C=D.function)==null?void 0:C.arguments)??""}):(A==null||A.type,void 0))}}},Yn=function(n,i){var l,u,d;if(_(this,ee,"m",Jt).call(this,n).done_tool_calls.has(i))return;const r=(l=n.message.tool_calls)==null?void 0:l[i];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const c=(d=(u=_(this,Ie,"f"))==null?void 0:u.tools)==null?void 0:d.find(f=>f.type==="function"&&f.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:i,arguments:r.function.arguments,parsed_arguments:Dt(c)?c.$parseRaw(r.function.arguments):c!=null&&c.function.strict?JSON.parse(r.function.arguments):null})}else r.type},Zn=function(n){var o,r;const i=_(this,ee,"m",Jt).call(this,n);if(n.message.content&&!i.content_done){i.content_done=!0;const l=_(this,ee,"m",zn).call(this);this._emit("content.done",{content:n.message.content,parsed:l?l.$parseRaw(n.message.content):null})}n.message.refusal&&!i.refusal_done&&(i.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(o=n.logprobs)!=null&&o.content&&!i.logprobs_content_done&&(i.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(r=n.logprobs)!=null&&r.refusal&&!i.logprobs_refusal_done&&(i.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Ht=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");const n=_(this,be,"f");if(!n)throw new L("request ended without sending any chunks");return V(this,be,void 0),V(this,Ye,[]),wu(n,_(this,Ie,"f"))},zn=function(){var i;const n=(i=_(this,Ie,"f"))==null?void 0:i.response_format;return Fi(n)?n:null},To=function(n){var i,o,r,l;let u=_(this,be,"f");const{choices:d,...c}=n;u?Object.assign(u,c):u=V(this,be,{...c,choices:[]});for(const{delta:f,finish_reason:h,index:p,logprobs:m=null,...g}of n.choices){let y=u.choices[p];if(y||(y=u.choices[p]={finish_reason:h,index:p,message:{},logprobs:m,...g}),m)if(!y.logprobs)y.logprobs=Object.assign({},m);else{const{content:D,refusal:A,...U}=m;Object.assign(y.logprobs,U),D&&((i=y.logprobs).content??(i.content=[]),y.logprobs.content.push(...D)),A&&((o=y.logprobs).refusal??(o.refusal=[]),y.logprobs.refusal.push(...A))}if(h&&(y.finish_reason=h,_(this,Ie,"f")&&Or(_(this,Ie,"f")))){if(h==="length")throw new Tr;if(h==="content_filter")throw new wr}if(Object.assign(y,g),!f)continue;const{content:v,refusal:x,function_call:C,role:T,tool_calls:w,...I}=f;if(Object.assign(y.message,I),x&&(y.message.refusal=(y.message.refusal||"")+x),T&&(y.message.role=T),C&&(y.message.function_call?(C.name&&(y.message.function_call.name=C.name),C.arguments&&((r=y.message.function_call).arguments??(r.arguments=""),y.message.function_call.arguments+=C.arguments)):y.message.function_call=C),v&&(y.message.content=(y.message.content||"")+v,!y.message.refusal&&_(this,ee,"m",zn).call(this)&&(y.message.parsed=Co(y.message.content))),w){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:D,id:A,type:U,function:R,...N}of w){const G=(l=y.message.tool_calls)[D]??(l[D]={});Object.assign(G,N),A&&(G.id=A),U&&(G.type=U),R&&(G.function??(G.function={name:R.name??"",arguments:""})),R!=null&&R.name&&(G.function.name=R.name),R!=null&&R.arguments&&(G.function.arguments+=R.arguments,pu(_(this,Ie,"f"),G)&&(G.function.parsed_arguments=Co(G.function.arguments)))}}}return u},Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("chunk",o=>{const r=n.shift();r?r.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((r,l)=>n.push({resolve:r,reject:l})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new we(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function wu(t,e){const{id:n,choices:i,created:o,model:r,system_fingerprint:l,...u}=t,d={...u,id:n,choices:i.map(({message:c,finish_reason:f,index:h,logprobs:p,...m})=>{if(!f)throw new L(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:y,tool_calls:v,...x}=c,C=c.role;if(!C)throw new L(`missing role for choice ${h}`);if(y){const{arguments:T,name:w}=y;if(T==null)throw new L(`missing function_call.arguments for choice ${h}`);if(!w)throw new L(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:T,name:w},role:C,refusal:c.refusal??null},finish_reason:f,index:h,logprobs:p}}return v?{...m,index:h,finish_reason:f,logprobs:p,message:{...x,role:C,content:g,refusal:c.refusal??null,tool_calls:v.map((T,w)=>{const{function:I,type:D,id:A,...U}=T,{arguments:R,name:N,...G}=I||{};if(A==null)throw new L(`missing choices[${h}].tool_calls[${w}].id
${Wt(t)}`);if(D==null)throw new L(`missing choices[${h}].tool_calls[${w}].type
${Wt(t)}`);if(N==null)throw new L(`missing choices[${h}].tool_calls[${w}].function.name
${Wt(t)}`);if(R==null)throw new L(`missing choices[${h}].tool_calls[${w}].function.arguments
${Wt(t)}`);return{...U,id:A,type:D,function:{...G,name:N,arguments:R}}})}}:{...m,message:{...x,content:g,role:C,refusal:c.refusal??null},finish_reason:f,index:h,logprobs:p}}),created:o,model:r,object:"chat.completion",...l?{system_fingerprint:l}:{}};return du(d,e)}function Wt(t){return JSON.stringify(t)}class gn extends Pt{static fromReadableStream(e){const n=new gn(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,i){const o=new gn(n),r={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(e,n,r)),o}}let Vi=class extends B{constructor(){super(...arguments),this.messages=new Vr(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(E`/chat/completions/${e}`,n)}update(e,n,i){return this._client.post(E`/chat/completions/${e}`,{body:n,...i})}list(e={},n){return this._client.getAPIList("/chat/completions",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/chat/completions/${e}`,n)}parse(e,n){return mu(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(i=>Li(i,e))}runTools(e,n){return e.stream?gn.runTools(this._client,e,n):Ui.runTools(this._client,e,n)}stream(e,n){return Pt.createChatCompletion(this._client,e,n)}};Vi.Messages=Vr;let $i=class extends B{constructor(){super(...arguments),this.completions=new Vi(this._client)}};$i.Completions=Vi;const oa=Symbol("brand.privateNullableHeaders");function*Su(t){if(!t)return;if(oa in t){const{values:i,nulls:o}=t;yield*i.entries();for(const r of o)yield[r,null];return}let e=!1,n;t instanceof Headers?n=t.entries():ro(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let i of n){const o=i[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const r=ro(i[1])?i[1]:[i[1]];let l=!1;for(const u of r)u!==void 0&&(e&&!l&&(l=!0,yield[o,null]),yield[o,u])}}const b=t=>{const e=new Headers,n=new Set;for(const i of t){const o=new Set;for(const[r,l]of Su(i)){const u=r.toLowerCase();o.has(u)||(e.delete(r),o.add(u)),l===null?(e.delete(r),n.add(u)):(e.append(r,l),n.delete(u))}}return{[oa]:!0,values:e,nulls:n}};class sa extends B{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:b([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class ra extends B{create(e,n){return this._client.post("/audio/transcriptions",Je({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class aa extends B{create(e,n){return this._client.post("/audio/translations",Je({body:e,...n,__metadata:{model:e.model}},this._client))}}class Ft extends B{constructor(){super(...arguments),this.transcriptions=new ra(this._client),this.translations=new aa(this._client),this.speech=new sa(this._client)}}Ft.Transcriptions=ra;Ft.Translations=aa;Ft.Speech=sa;class la extends B{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(E`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Q,{query:e,...n})}cancel(e,n){return this._client.post(E`/batches/${e}/cancel`,n)}}class ua extends B{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(E`/assistants/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,i){return this._client.post(E`/assistants/${e}`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Q,{query:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(E`/assistants/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class ca extends B{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class da extends B{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class Nn extends B{constructor(){super(...arguments),this.sessions=new ca(this._client),this.transcriptionSessions=new da(this._client)}}Nn.Sessions=ca;Nn.TranscriptionSessions=da;class fa extends B{create(e,n,i){return this._client.post(E`/threads/${e}/messages`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(e,n,i){const{thread_id:o}=n;return this._client.get(E`/threads/${o}/messages/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(e,n,i){const{thread_id:o,...r}=n;return this._client.post(E`/threads/${o}/messages/${e}`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n={},i){return this._client.getAPIList(E`/threads/${e}/messages`,Q,{query:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(e,n,i){const{thread_id:o}=n;return this._client.delete(E`/threads/${o}/messages/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}class ha extends B{retrieve(e,n,i){const{thread_id:o,run_id:r,...l}=n;return this._client.get(E`/threads/${o}/runs/${r}/steps/${e}`,{query:l,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n,i){const{thread_id:o,...r}=n;return this._client.getAPIList(E`/threads/${o}/runs/${e}/steps`,Q,{query:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}const Au=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,i=new Uint8Array(n);for(let o=0;o<n;o++)i[o]=e.charCodeAt(o);return Array.from(new Float32Array(i.buffer))}};var Xn={};const pt=t=>{var e,n,i,o;if(typeof globalThis.process<"u")return((e=Xn==null?void 0:Xn[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(o=(i=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:i.call(n,t))==null?void 0:o.trim()};var oe,Ge,di,Te,tn,_e,qe,et,Oe,yn,me,nn,on,It,wt,St,wo,So,Ao,xo,Eo,Io,Mo;class Mt extends Di{constructor(){super(...arguments),oe.add(this),di.set(this,[]),Te.set(this,{}),tn.set(this,{}),_e.set(this,void 0),qe.set(this,void 0),et.set(this,void 0),Oe.set(this,void 0),yn.set(this,void 0),me.set(this,void 0),nn.set(this,void 0),on.set(this,void 0),It.set(this,void 0)}[(di=new WeakMap,Te=new WeakMap,tn=new WeakMap,_e=new WeakMap,qe=new WeakMap,et=new WeakMap,Oe=new WeakMap,yn=new WeakMap,me=new WeakMap,nn=new WeakMap,on=new WeakMap,It=new WeakMap,oe=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((r,l)=>n.push({resolve:r,reject:l})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Ge;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var r;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),this._connected();const o=we.fromReadableStream(e,this.controller);for await(const l of o)_(this,oe,"m",wt).call(this,l);if((r=o.controller.signal)!=null&&r.aborted)throw new ge;return this._addRun(_(this,oe,"m",St).call(this))}toReadableStream(){return new we(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,i,o){const r=new Ge;return r._run(()=>r._runToolAssistantStream(e,n,i,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createToolAssistantStream(e,n,i,o){var d;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const l={...i,stream:!0},u=await e.submitToolOutputs(n,l,{...o,signal:this.controller.signal});this._connected();for await(const c of u)_(this,oe,"m",wt).call(this,c);if((d=u.controller.signal)!=null&&d.aborted)throw new ge;return this._addRun(_(this,oe,"m",St).call(this))}static createThreadAssistantStream(e,n,i){const o=new Ge;return o._run(()=>o._threadAssistantStream(e,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}static createAssistantStream(e,n,i,o){const r=new Ge;return r._run(()=>r._runAssistantStream(e,n,i,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}currentEvent(){return _(this,nn,"f")}currentRun(){return _(this,on,"f")}currentMessageSnapshot(){return _(this,_e,"f")}currentRunStepSnapshot(){return _(this,It,"f")}async finalRunSteps(){return await this.done(),Object.values(_(this,Te,"f"))}async finalMessages(){return await this.done(),Object.values(_(this,tn,"f"))}async finalRun(){if(await this.done(),!_(this,qe,"f"))throw Error("Final run was not received.");return _(this,qe,"f")}async _createThreadAssistantStream(e,n,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const r={...n,stream:!0},l=await e.createAndRun(r,{...i,signal:this.controller.signal});this._connected();for await(const d of l)_(this,oe,"m",wt).call(this,d);if((u=l.controller.signal)!=null&&u.aborted)throw new ge;return this._addRun(_(this,oe,"m",St).call(this))}async _createAssistantStream(e,n,i,o){var d;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const l={...i,stream:!0},u=await e.create(n,l,{...o,signal:this.controller.signal});this._connected();for await(const c of u)_(this,oe,"m",wt).call(this,c);if((d=u.controller.signal)!=null&&d.aborted)throw new ge;return this._addRun(_(this,oe,"m",St).call(this))}static accumulateDelta(e,n){for(const[i,o]of Object.entries(n)){if(!e.hasOwnProperty(i)){e[i]=o;continue}let r=e[i];if(r==null){e[i]=o;continue}if(i==="index"||i==="type"){e[i]=o;continue}if(typeof r=="string"&&typeof o=="string")r+=o;else if(typeof r=="number"&&typeof o=="number")r+=o;else if(qn(r)&&qn(o))r=this.accumulateDelta(r,o);else if(Array.isArray(r)&&Array.isArray(o)){if(r.every(l=>typeof l=="string"||typeof l=="number")){r.push(...o);continue}for(const l of o){if(!qn(l))throw new Error(`Expected array delta entry to be an object but got: ${l}`);const u=l.index;if(u==null)throw console.error(l),new Error("Expected array delta entry to have an `index` property");if(typeof u!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${u}`);const d=r[u];d==null?r.push(l):r[u]=this.accumulateDelta(d,l)}continue}else throw Error(`Unhandled record type: ${i}, deltaValue: ${o}, accValue: ${r}`);e[i]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,n,i){return await this._createThreadAssistantStream(n,e,i)}async _runAssistantStream(e,n,i,o){return await this._createAssistantStream(n,e,i,o)}async _runToolAssistantStream(e,n,i,o){return await this._createToolAssistantStream(n,e,i,o)}}Ge=Mt,wt=function(e){if(!this.ended)switch(V(this,nn,e),_(this,oe,"m",Ao).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":_(this,oe,"m",Mo).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_(this,oe,"m",So).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":_(this,oe,"m",wo).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},St=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");if(!_(this,qe,"f"))throw Error("Final run has not been received");return _(this,qe,"f")},wo=function(e){const[n,i]=_(this,oe,"m",Eo).call(this,e,_(this,_e,"f"));V(this,_e,n),_(this,tn,"f")[n.id]=n;for(const o of i){const r=n.content[o.index];(r==null?void 0:r.type)=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const o of e.data.delta.content){if(o.type=="text"&&o.text){let r=o.text,l=n.content[o.index];if(l&&l.type=="text")this._emit("textDelta",r,l.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(o.index!=_(this,et,"f")){if(_(this,Oe,"f"))switch(_(this,Oe,"f").type){case"text":this._emit("textDone",_(this,Oe,"f").text,_(this,_e,"f"));break;case"image_file":this._emit("imageFileDone",_(this,Oe,"f").image_file,_(this,_e,"f"));break}V(this,et,o.index)}V(this,Oe,n.content[o.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(_(this,et,"f")!==void 0){const o=e.data.content[_(this,et,"f")];if(o)switch(o.type){case"image_file":this._emit("imageFileDone",o.image_file,_(this,_e,"f"));break;case"text":this._emit("textDone",o.text,_(this,_e,"f"));break}}_(this,_e,"f")&&this._emit("messageDone",e.data),V(this,_e,void 0)}},So=function(e){const n=_(this,oe,"m",xo).call(this,e);switch(V(this,It,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const i=e.data.delta;if(i.step_details&&i.step_details.type=="tool_calls"&&i.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const r of i.step_details.tool_calls)r.index==_(this,yn,"f")?this._emit("toolCallDelta",r,n.step_details.tool_calls[r.index]):(_(this,me,"f")&&this._emit("toolCallDone",_(this,me,"f")),V(this,yn,r.index),V(this,me,n.step_details.tool_calls[r.index]),_(this,me,"f")&&this._emit("toolCallCreated",_(this,me,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":V(this,It,void 0),e.data.step_details.type=="tool_calls"&&_(this,me,"f")&&(this._emit("toolCallDone",_(this,me,"f")),V(this,me,void 0)),this._emit("runStepDone",e.data,n);break}},Ao=function(e){_(this,di,"f").push(e),this._emit("event",e)},xo=function(e){switch(e.event){case"thread.run.step.created":return _(this,Te,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=_(this,Te,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let i=e.data;if(i.delta){const o=Ge.accumulateDelta(n,i.delta);_(this,Te,"f")[e.data.id]=o}return _(this,Te,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":_(this,Te,"f")[e.data.id]=e.data;break}if(_(this,Te,"f")[e.data.id])return _(this,Te,"f")[e.data.id];throw new Error("No snapshot available")},Eo=function(e,n){let i=[];switch(e.event){case"thread.message.created":return[e.data,i];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let o=e.data;if(o.delta.content)for(const r of o.delta.content)if(r.index in n.content){let l=n.content[r.index];n.content[r.index]=_(this,oe,"m",Io).call(this,r,l)}else n.content[r.index]=r,i.push(r);return[n,i];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,i];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Io=function(e,n){return Ge.accumulateDelta(n,e)},Mo=function(e){switch(V(this,on,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":V(this,qe,e.data),_(this,me,"f")&&(this._emit("toolCallDone",_(this,me,"f")),V(this,me,void 0));break}};let Bi=class extends B{constructor(){super(...arguments),this.steps=new ha(this._client)}create(e,n,i){const{include:o,...r}=n;return this._client.post(E`/threads/${e}/runs`,{query:{include:o},body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers]),stream:n.stream??!1})}retrieve(e,n,i){const{thread_id:o}=n;return this._client.get(E`/threads/${o}/runs/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(e,n,i){const{thread_id:o,...r}=n;return this._client.post(E`/threads/${o}/runs/${e}`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n={},i){return this._client.getAPIList(E`/threads/${e}/runs`,Q,{query:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}cancel(e,n,i){const{thread_id:o}=n;return this._client.post(E`/threads/${o}/runs/${e}/cancel`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(e,n,i){const o=await this.create(e,n,i);return await this.poll(o.id,{thread_id:e},i)}createAndStream(e,n,i){return Mt.createAssistantStream(e,this._client.beta.threads.runs,n,i)}async poll(e,n,i){var r;const o=b([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=i==null?void 0:i.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:l,response:u}=await this.retrieve(e,n,{...i,headers:{...i==null?void 0:i.headers,...o}}).withResponse();switch(l.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(i!=null&&i.pollIntervalMs)d=i.pollIntervalMs;else{const c=u.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(d=f)}}await bt(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return l}}}stream(e,n,i){return Mt.createAssistantStream(e,this._client.beta.threads.runs,n,i)}submitToolOutputs(e,n,i){const{thread_id:o,...r}=n;return this._client.post(E`/threads/${o}/runs/${e}/submit_tool_outputs`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,i){const o=await this.submitToolOutputs(e,n,i);return await this.poll(o.id,n,i)}submitToolOutputsStream(e,n,i){return Mt.createToolAssistantStream(e,this._client.beta.threads.runs,n,i)}};Bi.Steps=ha;class bn extends B{constructor(){super(...arguments),this.runs=new Bi(this._client),this.messages=new fa(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(E`/threads/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,i){return this._client.post(E`/threads/${e}`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(e,n){return this._client.delete(E`/threads/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const i=await this.createAndRun(e,n);return await this.runs.poll(i.id,{thread_id:i.thread_id},n)}createAndRunStream(e,n){return Mt.createThreadAssistantStream(e,this._client.beta.threads,n)}}bn.Runs=Bi;bn.Messages=fa;class Lt extends B{constructor(){super(...arguments),this.realtime=new Nn(this._client),this.assistants=new ua(this._client),this.threads=new bn(this._client)}}Lt.Realtime=Nn;Lt.Assistants=ua;Lt.Threads=bn;class pa extends B{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class ma extends B{retrieve(e,n,i){const{container_id:o}=n;return this._client.get(E`/containers/${o}/files/${e}/content`,{...i,headers:b([{Accept:"application/binary"},i==null?void 0:i.headers]),__binaryResponse:!0})}}let Oi=class extends B{constructor(){super(...arguments),this.content=new ma(this._client)}create(e,n,i){return this._client.post(E`/containers/${e}/files`,Je({body:n,...i},this._client))}retrieve(e,n,i){const{container_id:o}=n;return this._client.get(E`/containers/${o}/files/${e}`,i)}list(e,n={},i){return this._client.getAPIList(E`/containers/${e}/files`,Q,{query:n,...i})}delete(e,n,i){const{container_id:o}=n;return this._client.delete(E`/containers/${o}/files/${e}`,{...i,headers:b([{Accept:"*/*"},i==null?void 0:i.headers])})}};Oi.Content=ma;class Gi extends B{constructor(){super(...arguments),this.files=new Oi(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(E`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/containers/${e}`,{...n,headers:b([{Accept:"*/*"},n==null?void 0:n.headers])})}}Gi.Files=Oi;class ga extends B{create(e,n){const i=!!e.encoding_format;let o=i?e.encoding_format:"base64";i&&re(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const r=this._client.post("/embeddings",{body:{...e,encoding_format:o},...n});return i?r:(re(this._client).debug("embeddings/decoding base64 embeddings from base64"),r._thenUnwrap(l=>(l&&l.data&&l.data.forEach(u=>{const d=u.embedding;u.embedding=Au(d)}),l)))}}class ya extends B{retrieve(e,n,i){const{eval_id:o,run_id:r}=n;return this._client.get(E`/evals/${o}/runs/${r}/output_items/${e}`,i)}list(e,n,i){const{eval_id:o,...r}=n;return this._client.getAPIList(E`/evals/${o}/runs/${e}/output_items`,Q,{query:r,...i})}}class qi extends B{constructor(){super(...arguments),this.outputItems=new ya(this._client)}create(e,n,i){return this._client.post(E`/evals/${e}/runs`,{body:n,...i})}retrieve(e,n,i){const{eval_id:o}=n;return this._client.get(E`/evals/${o}/runs/${e}`,i)}list(e,n={},i){return this._client.getAPIList(E`/evals/${e}/runs`,Q,{query:n,...i})}delete(e,n,i){const{eval_id:o}=n;return this._client.delete(E`/evals/${o}/runs/${e}`,i)}cancel(e,n,i){const{eval_id:o}=n;return this._client.post(E`/evals/${o}/runs/${e}`,i)}}qi.OutputItems=ya;class Ji extends B{constructor(){super(...arguments),this.runs=new qi(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(E`/evals/${e}`,n)}update(e,n,i){return this._client.post(E`/evals/${e}`,{body:n,...i})}list(e={},n){return this._client.getAPIList("/evals",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/evals/${e}`,n)}}Ji.Runs=qi;let _a=class extends B{create(e,n){return this._client.post("/files",Je({body:e,...n},this._client))}retrieve(e,n){return this._client.get(E`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Q,{query:e,...n})}delete(e,n){return this._client.delete(E`/files/${e}`,n)}content(e,n){return this._client.get(E`/files/${e}/content`,{...n,headers:b([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:i=30*60*1e3}={}){const o=new Set(["processed","error","deleted"]),r=Date.now();let l=await this.retrieve(e);for(;!l.status||!o.has(l.status);)if(await bt(n),l=await this.retrieve(e),Date.now()-r>i)throw new Ni({message:`Giving up on waiting for file ${e} to finish processing after ${i} milliseconds.`});return l}};class va extends B{}let Ca=class extends B{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class Hi extends B{constructor(){super(...arguments),this.graders=new Ca(this._client)}}Hi.Graders=Ca;class Ta extends B{create(e,n,i){return this._client.getAPIList(E`/fine_tuning/checkpoints/${e}/permissions`,kn,{body:n,method:"post",...i})}retrieve(e,n={},i){return this._client.getAPIList(E`/fine_tuning/checkpoints/${e}/permissions`,Q,{query:n,...i})}delete(e,n,i){const{fine_tuned_model_checkpoint:o}=n;return this._client.delete(E`/fine_tuning/checkpoints/${o}/permissions/${e}`,i)}}let Wi=class extends B{constructor(){super(...arguments),this.permissions=new Ta(this._client)}};Wi.Permissions=Ta;class wa extends B{list(e,n={},i){return this._client.getAPIList(E`/fine_tuning/jobs/${e}/checkpoints`,Q,{query:n,...i})}}class Ki extends B{constructor(){super(...arguments),this.checkpoints=new wa(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(E`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Q,{query:e,...n})}cancel(e,n){return this._client.post(E`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},i){return this._client.getAPIList(E`/fine_tuning/jobs/${e}/events`,Q,{query:n,...i})}pause(e,n){return this._client.post(E`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(E`/fine_tuning/jobs/${e}/resume`,n)}}Ki.Checkpoints=wa;class ct extends B{constructor(){super(...arguments),this.methods=new va(this._client),this.jobs=new Ki(this._client),this.checkpoints=new Wi(this._client),this.alpha=new Hi(this._client)}}ct.Methods=va;ct.Jobs=Ki;ct.Checkpoints=Wi;ct.Alpha=Hi;class Sa extends B{}class Yi extends B{constructor(){super(...arguments),this.graderModels=new Sa(this._client)}}Yi.GraderModels=Sa;class Aa extends B{createVariation(e,n){return this._client.post("/images/variations",Je({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Je({body:e,...n},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}let xa=class extends B{retrieve(e,n){return this._client.get(E`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",kn,e)}delete(e,n){return this._client.delete(E`/models/${e}`,n)}};class Ea extends B{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function xu(t,e){return!e||!Iu(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(i=>({...i,parsed:null}))}:n)}:Ia(t,e)}function Ia(t,e){const n=t.output.map(o=>{if(o.type==="function_call")return{...o,parsed_arguments:Pu(e,o)};if(o.type==="message"){const r=o.content.map(l=>l.type==="output_text"?{...l,parsed:Eu(e,l.text)}:l);return{...o,content:r}}return o}),i=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||Ma(i),Object.defineProperty(i,"output_parsed",{enumerable:!0,get(){for(const o of i.output)if(o.type==="message"){for(const r of o.content)if(r.type==="output_text"&&r.parsed!==null)return r.parsed}return null}}),i}function Eu(t,e){var n,i,o,r;return((i=(n=t.text)==null?void 0:n.format)==null?void 0:i.type)!=="json_schema"?null:"$parseRaw"in((o=t.text)==null?void 0:o.format)?((r=t.text)==null?void 0:r.format).$parseRaw(e):JSON.parse(e)}function Iu(t){var e;return!!Fi((e=t.text)==null?void 0:e.format)}function Mu(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Ru(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function Pu(t,e){const n=Ru(t.tools??[],e.name);return{...e,...e,parsed_arguments:Mu(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function Ma(t){const e=[];for(const n of t.output)if(n.type==="message")for(const i of n.content)i.type==="output_text"&&e.push(i.text);t.output_text=e.join("")}var Ze,Kt,De,Yt,Ro,Po,ko,No;class Zi extends Di{constructor(e){super(),Ze.add(this),Kt.set(this,void 0),De.set(this,void 0),Yt.set(this,void 0),V(this,Kt,e)}static createResponse(e,n,i){const o=new Zi(n);return o._run(()=>o._createOrRetrieveResponse(e,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createOrRetrieveResponse(e,n,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),_(this,Ze,"m",Ro).call(this);let r,l=null;"response_id"in n?(r=await e.responses.retrieve(n.response_id,{stream:!0},{...i,signal:this.controller.signal,stream:!0}),l=n.starting_after??null):r=await e.responses.create({...n,stream:!0},{...i,signal:this.controller.signal}),this._connected();for await(const d of r)_(this,Ze,"m",Po).call(this,d,l);if((u=r.controller.signal)!=null&&u.aborted)throw new ge;return _(this,Ze,"m",ko).call(this)}[(Kt=new WeakMap,De=new WeakMap,Yt=new WeakMap,Ze=new WeakSet,Ro=function(){this.ended||V(this,De,void 0)},Po=function(n,i){if(this.ended)return;const o=(l,u)=>{(i==null||u.sequence_number>i)&&this._emit(l,u)},r=_(this,Ze,"m",No).call(this,n);switch(o("event",n),n.type){case"response.output_text.delta":{const l=r.output[n.output_index];if(!l)throw new L(`missing output at index ${n.output_index}`);if(l.type==="message"){const u=l.content[n.content_index];if(!u)throw new L(`missing content at index ${n.content_index}`);if(u.type!=="output_text")throw new L(`expected content to be 'output_text', got ${u.type}`);o("response.output_text.delta",{...n,snapshot:u.text})}break}case"response.function_call_arguments.delta":{const l=r.output[n.output_index];if(!l)throw new L(`missing output at index ${n.output_index}`);l.type==="function_call"&&o("response.function_call_arguments.delta",{...n,snapshot:l.arguments});break}default:o(n.type,n);break}},ko=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");const n=_(this,De,"f");if(!n)throw new L("request ended without sending any events");V(this,De,void 0);const i=ku(n,_(this,Kt,"f"));return V(this,Yt,i),i},No=function(n){let i=_(this,De,"f");if(!i){if(n.type!=="response.created")throw new L(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return i=V(this,De,n.response),i}switch(n.type){case"response.output_item.added":{i.output.push(n.item);break}case"response.content_part.added":{const o=i.output[n.output_index];if(!o)throw new L(`missing output at index ${n.output_index}`);o.type==="message"&&o.content.push(n.part);break}case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new L(`missing output at index ${n.output_index}`);if(o.type==="message"){const r=o.content[n.content_index];if(!r)throw new L(`missing content at index ${n.content_index}`);if(r.type!=="output_text")throw new L(`expected content to be 'output_text', got ${r.type}`);r.text+=n.delta}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new L(`missing output at index ${n.output_index}`);o.type==="function_call"&&(o.arguments+=n.delta);break}case"response.completed":{V(this,De,n.response);break}}return i},Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((r,l)=>n.push({resolve:r,reject:l})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=_(this,Yt,"f");if(!e)throw new L("stream ended without producing a ChatCompletion");return e}}function ku(t,e){return xu(t,e)}class Ra extends B{list(e,n={},i){return this._client.getAPIList(E`/responses/${e}/input_items`,Q,{query:n,...i})}}class zi extends B{constructor(){super(...arguments),this.inputItems=new Ra(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(i=>("object"in i&&i.object==="response"&&Ma(i),i))}retrieve(e,n={},i){return this._client.get(E`/responses/${e}`,{query:n,...i,stream:(n==null?void 0:n.stream)??!1})}delete(e,n){return this._client.delete(E`/responses/${e}`,{...n,headers:b([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(i=>Ia(i,e))}stream(e,n){return Zi.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(E`/responses/${e}/cancel`,n)}}zi.InputItems=Ra;class Pa extends B{create(e,n,i){return this._client.post(E`/uploads/${e}/parts`,Je({body:n,...i},this._client))}}class Xi extends B{constructor(){super(...arguments),this.parts=new Pa(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(E`/uploads/${e}/cancel`,n)}complete(e,n,i){return this._client.post(E`/uploads/${e}/complete`,{body:n,...i})}}Xi.Parts=Pa;const Nu=async t=>{const e=await Promise.allSettled(t),n=e.filter(o=>o.status==="rejected");if(n.length){for(const o of n)console.error(o.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const i=[];for(const o of e)o.status==="fulfilled"&&i.push(o.value);return i};class ka extends B{create(e,n,i){return this._client.post(E`/vector_stores/${e}/file_batches`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(e,n,i){const{vector_store_id:o}=n;return this._client.get(E`/vector_stores/${o}/file_batches/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}cancel(e,n,i){const{vector_store_id:o}=n;return this._client.post(E`/vector_stores/${o}/file_batches/${e}/cancel`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(e,n,i){const o=await this.create(e,n);return await this.poll(e,o.id,i)}listFiles(e,n,i){const{vector_store_id:o,...r}=n;return this._client.getAPIList(E`/vector_stores/${o}/file_batches/${e}/files`,Q,{query:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async poll(e,n,i){var r;const o=b([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=i==null?void 0:i.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:l,response:u}=await this.retrieve(n,{vector_store_id:e},{...i,headers:o}).withResponse();switch(l.status){case"in_progress":let d=5e3;if(i!=null&&i.pollIntervalMs)d=i.pollIntervalMs;else{const c=u.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(d=f)}}await bt(d);break;case"failed":case"cancelled":case"completed":return l}}}async uploadAndPoll(e,{files:n,fileIds:i=[]},o){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=(o==null?void 0:o.maxConcurrency)??5,l=Math.min(r,n.length),u=this._client,d=n.values(),c=[...i];async function f(p){for(let m of p){const g=await u.files.create({file:m,purpose:"assistants"},o);c.push(g.id)}}const h=Array(l).fill(d).map(f);return await Nu(h),await this.createAndPoll(e,{file_ids:c})}}let Na=class extends B{create(e,n,i){return this._client.post(E`/vector_stores/${e}/files`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(e,n,i){const{vector_store_id:o}=n;return this._client.get(E`/vector_stores/${o}/files/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(e,n,i){const{vector_store_id:o,...r}=n;return this._client.post(E`/vector_stores/${o}/files/${e}`,{body:r,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e,n={},i){return this._client.getAPIList(E`/vector_stores/${e}/files`,Q,{query:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(e,n,i){const{vector_store_id:o}=n;return this._client.delete(E`/vector_stores/${o}/files/${e}`,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(e,n,i){const o=await this.create(e,n,i);return await this.poll(e,o.id,i)}async poll(e,n,i){var r;const o=b([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=i==null?void 0:i.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const l=await this.retrieve(n,{vector_store_id:e},{...i,headers:o}).withResponse(),u=l.data;switch(u.status){case"in_progress":let d=5e3;if(i!=null&&i.pollIntervalMs)d=i.pollIntervalMs;else{const c=l.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(d=f)}}await bt(d);break;case"failed":case"completed":return u}}}async upload(e,n,i){const o=await this._client.files.create({file:n,purpose:"assistants"},i);return this.create(e,{file_id:o.id},i)}async uploadAndPoll(e,n,i){const o=await this.upload(e,n,i);return await this.poll(e,o.id,i)}content(e,n,i){const{vector_store_id:o}=n;return this._client.getAPIList(E`/vector_stores/${o}/files/${e}/content`,kn,{...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}};class Dn extends B{constructor(){super(...arguments),this.files=new Na(this._client),this.fileBatches=new ka(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(E`/vector_stores/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,i){return this._client.post(E`/vector_stores/${e}`,{body:n,...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Q,{query:e,...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(E`/vector_stores/${e}`,{...n,headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,i){return this._client.getAPIList(E`/vector_stores/${e}/search`,kn,{body:n,method:"post",...i,headers:b([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}Dn.Files=Na;Dn.FileBatches=ka;var fi,Qi,sn,ba;class K{constructor({baseURL:e=pt("OPENAI_BASE_URL"),apiKey:n=pt("OPENAI_API_KEY"),organization:i=pt("OPENAI_ORG_ID")??null,project:o=pt("OPENAI_PROJECT_ID")??null,...r}={}){if(fi.add(this),sn.set(this,void 0),this.completions=new pa(this),this.chat=new $i(this),this.embeddings=new ga(this),this.files=new _a(this),this.images=new Aa(this),this.audio=new Ft(this),this.moderations=new Ea(this),this.models=new xa(this),this.fineTuning=new ct(this),this.graders=new Yi(this),this.vectorStores=new Dn(this),this.beta=new Lt(this),this.batches=new la(this),this.uploads=new Xi(this),this.responses=new zi(this),this.evals=new Ji(this),this.containers=new Gi(this),n===void 0)throw new L("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:n,organization:i,project:o,...r,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&bl())throw new L(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=l.baseURL,this.timeout=l.timeout??Qi.DEFAULT_TIMEOUT,this.logger=l.logger??console;const u="warn";this.logLevel=u,this.logLevel=yo(l.logLevel,"ClientOptions.logLevel",this)??yo(pt("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??u,this.fetchOptions=l.fetchOptions,this.maxRetries=l.maxRetries??2,this.fetch=l.fetch??Vl(),V(this,sn,Bl),this._options=l,this.apiKey=n,this.organization=i,this.project=o}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}authHeaders(e){return b([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return Wl(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Xe}`}defaultIdempotencyKey(){return`stainless-node-retry-${fr()}`}makeStatusError(e,n,i,o){return se.generate(e,n,i,o)}buildURL(e,n,i){const o=!_(this,fi,"m",ba).call(this)&&i||this.baseURL,r=Il(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return Rl(l)||(n={...l,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:i}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,i){return this.request(Promise.resolve(i).then(o=>({method:e,path:n,...o})))}request(e,n=null){return new Pn(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,i){var x,C;const o=await e,r=o.maxRetries??this.maxRetries;n==null&&(n=r),await this.prepareOptions(o);const{req:l,url:u,timeout:d}=this.buildRequest(o,{retryCount:r-n});await this.prepareRequest(l,{url:u,options:o});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=i===void 0?"":`, retryOf: ${i}`,h=Date.now();if(re(this).debug(`[${c}] sending request`,Be({retryOfRequestLogID:i,method:o.method,url:u,options:o,headers:l.headers})),(x=o.signal)!=null&&x.aborted)throw new ge;const p=new AbortController,m=await this.fetchWithTimeout(u,l,d,p).catch(ni),g=Date.now();if(m instanceof Error){const T=`retrying, ${n} attempts remaining`;if((C=o.signal)!=null&&C.aborted)throw new ge;const w=ti(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(n)return re(this).info(`[${c}] connection ${w?"timed out":"failed"} - ${T}`),re(this).debug(`[${c}] connection ${w?"timed out":"failed"} (${T})`,Be({retryOfRequestLogID:i,url:u,durationMs:g-h,message:m.message})),this.retryRequest(o,n,i??c);throw re(this).info(`[${c}] connection ${w?"timed out":"failed"} - error; no more retries left`),re(this).debug(`[${c}] connection ${w?"timed out":"failed"} (error; no more retries left)`,Be({retryOfRequestLogID:i,url:u,durationMs:g-h,message:m.message})),w?new Ni:new Mn({cause:m})}const y=[...m.headers.entries()].filter(([T])=>T==="x-request-id").map(([T,w])=>", "+T+": "+JSON.stringify(w)).join(""),v=`[${c}${f}${y}] ${l.method} ${u} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${g-h}ms`;if(!m.ok){const T=this.shouldRetry(m);if(n&&T){const R=`retrying, ${n} attempts remaining`;return await $l(m.body),re(this).info(`${v} - ${R}`),re(this).debug(`[${c}] response error (${R})`,Be({retryOfRequestLogID:i,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),this.retryRequest(o,n,i??c,m.headers)}const w=T?"error; no more retries left":"error; not retryable";re(this).info(`${v} - ${w}`);const I=await m.text().catch(R=>ni(R).message),D=Nl(I),A=D?void 0:I;throw re(this).debug(`[${c}] response error (${w})`,Be({retryOfRequestLogID:i,url:m.url,status:m.status,headers:m.headers,message:A,durationMs:Date.now()-h})),this.makeStatusError(m.status,D,A,m.headers)}return re(this).info(v),re(this).debug(`[${c}] response start`,Be({retryOfRequestLogID:i,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),{response:m,options:o,controller:p,requestLogID:c,retryOfRequestLogID:i,startTime:h}}getAPIList(e,n,i){return this.requestAPIList(n,{method:"get",path:e,...i})}requestAPIList(e,n){const i=this.makeRequest(n,null,void 0);return new tu(this,i,e)}async fetchWithTimeout(e,n,i,o){const{signal:r,method:l,...u}=n||{};r&&r.addEventListener("abort",()=>o.abort());const d=setTimeout(()=>o.abort(),i),c=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,f={signal:o.signal,...c?{duplex:"half"}:{},method:"GET",...u};l&&(f.method=l.toUpperCase());try{return await this.fetch.call(void 0,e,f)}finally{clearTimeout(d)}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,i,o){let r;const l=o==null?void 0:o.get("retry-after-ms");if(l){const d=parseFloat(l);Number.isNaN(d)||(r=d)}const u=o==null?void 0:o.get("retry-after");if(u&&!r){const d=parseFloat(u);Number.isNaN(d)?r=Date.parse(u)-Date.now():r=d*1e3}if(!(r&&0<=r&&r<60*1e3)){const d=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(n,d)}return await bt(r),this.makeRequest(e,n-1,i)}calculateDefaultRetryTimeoutMillis(e,n){const r=n-e,l=Math.min(.5*Math.pow(2,r),8),u=1-Math.random()*.25;return l*u*1e3}buildRequest(e,{retryCount:n=0}={}){const i={...e},{method:o,path:r,query:l,defaultBaseURL:u}=i,d=this.buildURL(r,l,u);"timeout"in i&&kl("timeout",i.timeout),i.timeout=i.timeout??this.timeout;const{bodyHeaders:c,body:f}=this.buildBody({options:i}),h=this.buildHeaders({options:e,method:o,bodyHeaders:c,retryCount:n});return{req:{method:o,headers:h,...i.signal&&{signal:i.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...i.fetchOptions??{}},url:d,timeout:i.timeout}}buildHeaders({options:e,method:n,bodyHeaders:i,retryCount:o}){let r={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);const l=b([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...Ul(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},this.authHeaders(e),this._options.defaultHeaders,i,e.headers]);return this.validateHeaders(l),l.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=b([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Ar(e)}:_(this,sn,"f").call(this,{body:e,headers:i})}}Qi=K,sn=new WeakMap,fi=new WeakSet,ba=function(){return this.baseURL!=="https://api.openai.com/v1"};K.OpenAI=Qi;K.DEFAULT_TIMEOUT=6e5;K.OpenAIError=L;K.APIError=se;K.APIConnectionError=Mn;K.APIConnectionTimeoutError=Ni;K.APIUserAbortError=ge;K.NotFoundError=gr;K.ConflictError=yr;K.RateLimitError=vr;K.BadRequestError=hr;K.AuthenticationError=pr;K.InternalServerError=Cr;K.PermissionDeniedError=mr;K.UnprocessableEntityError=_r;K.toFile=au;K.Completions=pa;K.Chat=$i;K.Embeddings=ga;K.Files=_a;K.Images=Aa;K.Audio=Ft;K.Moderations=Ea;K.Models=xa;K.FineTuning=ct;K.Graders=Yi;K.VectorStores=Dn;K.Beta=Lt;K.Batches=la;K.Uploads=Xi;K.Responses=zi;K.Evals=Ji;K.Containers=Gi;let hi=null,rn=null;const Ut=async()=>(hi??(hi=await Nt.getActiveApiKey("openai")),hi),X_=async()=>{hi=await Nt.getActiveApiKey("openai"),rn=null},Fn=async()=>{const t=await Ut();return!rn&&t&&(rn=new K({apiKey:t,dangerouslyAllowBrowser:!0})),rn},bu=t=>{const e=Array.isArray(t.text)?t.text.join(`
`):t.text;switch(t.sender){case"character":return{role:"assistant",content:e};case"user":default:return{role:"user",content:e}}},Da=t=>{const e=[];return t.characterInitialPrompt&&e.push({role:"system",content:t.characterInitialPrompt}),t.characterInitialMessage&&t.characterInitialMessage.length>0&&e.push({role:"assistant",content:t.characterInitialMessage.join(`
`)}),t.messages&&t.messages.length>0&&t.messages.forEach(n=>{e.push(bu(n))}),e},Du=async(t,e="gpt-3.5-turbo",n=1e3)=>{var i,o;try{if(!await Ut())throw new Error("OpenAI API key is not configured. Please configure your API key in the application settings.");const l=await Fn();if(!l)throw new Error("Failed to initialize OpenAI client");const u=Da(t),d=parseFloat(t.temperature)||.7,f=(o=(i=(await l.chat.completions.create({model:e,messages:u,temperature:d,max_tokens:n})).choices[0])==null?void 0:i.message)==null?void 0:o.content;if(!f)throw new Error("No response received from OpenAI");return f}catch(r){throw console.error("Error getting chat completion:",r),r}},Fu=async(t,e="gpt-3.5-turbo",n=1e3,i)=>{var o,r;try{if(!await Ut())throw new Error("OpenAI API key is not configured. Please configure your API key in the application settings.");const u=await Fn();if(!u)throw new Error("Failed to initialize OpenAI client");const d=Da(t),c=parseFloat(t.temperature)||.7,f=await u.chat.completions.create({model:e,messages:d,temperature:c,max_tokens:n,stream:!0});let h="";for await(const p of f){const m=((r=(o=p.choices[0])==null?void 0:o.delta)==null?void 0:r.content)??"";m&&(h+=m,i==null||i(m))}return h}catch(l){throw console.error("Error getting streaming chat completion:",l),l}},Lu=(t,e="character")=>({id:`msg_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,sender:e,text:[t]}),Uu=async()=>{try{if(!await Ut())return!1;const e=await Fn();return e?(await e.models.list(),!0):!1}catch(t){return console.error("Invalid OpenAI API key:",t),!1}},Vu=async()=>!!await Ut(),$u=async()=>{try{const t=await Fn();return t?(await t.models.list()).data.filter(n=>n.id.includes("gpt")&&!n.id.includes("image")&&!n.id.includes("vision")&&!n.id.includes("dall-e")&&!n.id.includes("transcribe")).map(n=>n.id).sort((n,i)=>n.localeCompare(i)):["gpt-3.5-turbo","gpt-4","gpt-4-turbo-preview"]}catch(t){return console.error("Error fetching available models:",t),["gpt-3.5-turbo","gpt-4","gpt-4-turbo-preview"]}};var Y;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function n(o){throw new Error}t.assertNever=n,t.arrayToEnum=o=>{const r={};for(const l of o)r[l]=l;return r},t.getValidEnumValues=o=>{const r=t.objectKeys(o).filter(u=>typeof o[o[u]]!="number"),l={};for(const u of r)l[u]=o[u];return t.objectValues(l)},t.objectValues=o=>t.objectKeys(o).map(function(r){return o[r]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const r=[];for(const l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.push(l);return r},t.find=(o,r)=>{for(const l of o)if(r(l))return l},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function i(o,r=" | "){return o.map(l=>typeof l=="string"?`'${l}'`:l).join(r)}t.joinValues=i,t.jsonStringifyReplacer=(o,r)=>typeof r=="bigint"?r.toString():r})(Y||(Y={}));var bo;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(bo||(bo={}));const P=Y.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Fe=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return Number.isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},S=Y.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Re extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(r){return r.message},i={_errors:[]},o=r=>{for(const l of r.issues)if(l.code==="invalid_union")l.unionErrors.map(o);else if(l.code==="invalid_return_type")o(l.returnTypeError);else if(l.code==="invalid_arguments")o(l.argumentsError);else if(l.path.length===0)i._errors.push(n(l));else{let u=i,d=0;for(;d<l.path.length;){const c=l.path[d];d===l.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(n(l))):u[c]=u[c]||{_errors:[]},u=u[c],d++}}};return o(this),i}static assert(e){if(!(e instanceof Re))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Y.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const o of this.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(e(o))):i.push(e(o));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Re.create=t=>new Re(t);const pi=(t,e)=>{let n;switch(t.code){case S.invalid_type:t.received===P.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case S.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Y.jsonStringifyReplacer)}`;break;case S.unrecognized_keys:n=`Unrecognized key(s) in object: ${Y.joinValues(t.keys,", ")}`;break;case S.invalid_union:n="Invalid input";break;case S.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Y.joinValues(t.options)}`;break;case S.invalid_enum_value:n=`Invalid enum value. Expected ${Y.joinValues(t.options)}, received '${t.received}'`;break;case S.invalid_arguments:n="Invalid function arguments";break;case S.invalid_return_type:n="Invalid function return type";break;case S.invalid_date:n="Invalid date";break;case S.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Y.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case S.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case S.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case S.custom:n="Invalid input";break;case S.invalid_intersection_types:n="Intersection results could not be merged";break;case S.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case S.not_finite:n="Number must be finite";break;default:n=e.defaultError,Y.assertNever(t)}return{message:n}};let Bu=pi;function Ou(){return Bu}const Gu=t=>{const{data:e,path:n,errorMaps:i,issueData:o}=t,r=[...n,...o.path||[]],l={...o,path:r};if(o.message!==void 0)return{...o,path:r,message:o.message};let u="";const d=i.filter(c=>!!c).slice().reverse();for(const c of d)u=c(l,{data:e,defaultError:u}).message;return{...o,path:r,message:u}};function M(t,e){const n=Ou(),i=Gu({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===pi?void 0:pi].filter(o=>!!o)});t.common.issues.push(i)}class ce{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const o of n){if(o.status==="aborted")return O;o.status==="dirty"&&e.dirty(),i.push(o.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const o of n){const r=await o.key,l=await o.value;i.push({key:r,value:l})}return ce.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const o of n){const{key:r,value:l}=o;if(r.status==="aborted"||l.status==="aborted")return O;r.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof l.value<"u"||o.alwaysSet)&&(i[r.value]=l.value)}return{status:e.value,value:i}}}const O=Object.freeze({status:"aborted"}),At=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),Do=t=>t.status==="aborted",Fo=t=>t.status==="dirty",ot=t=>t.status==="valid",_n=t=>typeof Promise<"u"&&t instanceof Promise;var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(k||(k={}));class Ee{constructor(e,n,i,o){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Lo=(t,e)=>{if(ot(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Re(t.common.issues);return this._error=n,this._error}}};function J(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:o}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(l,u)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??u.defaultError}:typeof u.data>"u"?{message:d??i??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:d??n??u.defaultError}},description:o}}class W{get description(){return this._def.description}_getType(e){return Fe(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Fe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ce,ctx:{common:e.parent.common,data:e.data,parsedType:Fe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(_n(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fe(e)},o=this._parseSync({data:e,path:i.path,parent:i});return Lo(i,o)}"~validate"(e){var i,o;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fe(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return ot(r)?{value:r.value}:{issues:n.common.issues}}catch(r){(o=(i=r==null?void 0:r.message)==null?void 0:i.toLowerCase())!=null&&o.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>ot(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fe(e)},o=this._parse({data:e,path:i.path,parent:i}),r=await(_n(o)?o:Promise.resolve(o));return Lo(i,r)}refine(e,n){const i=o=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(o):n;return this._refinement((o,r)=>{const l=e(o),u=()=>r.addIssue({code:S.custom,...i(o)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(e,n){return this._refinement((i,o)=>e(i)?!0:(o.addIssue(typeof n=="function"?n(i,o):n),!1))}_refinement(e){return new at({schema:this,typeName:$.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Le.create(this,this._def)}nullable(){return lt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xe.create(this)}promise(){return Sn.create(this,this._def)}or(e){return Cn.create([this,e],this._def)}and(e){return Tn.create(this,e,this._def)}transform(e){return new at({...J(this._def),schema:this,typeName:$.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new _i({...J(this._def),innerType:this,defaultValue:n,typeName:$.ZodDefault})}brand(){return new dc({typeName:$.ZodBranded,type:this,...J(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new vi({...J(this._def),innerType:this,catchValue:n,typeName:$.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ji.create(this,e)}readonly(){return Ci.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const qu=/^c[^\s-]{8,}$/i,Ju=/^[0-9a-z]+$/,Hu=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Wu=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ku=/^[a-z0-9_-]{21}$/i,Yu=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Zu=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zu=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Xu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Qn;const Qu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ju=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ec=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,tc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ic=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Fa="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",oc=new RegExp(`^${Fa}$`);function La(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function sc(t){return new RegExp(`^${La(t)}$`)}function rc(t){let e=`${Fa}T${La(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function ac(t,e){return!!((e==="v4"||!e)&&Qu.test(t)||(e==="v6"||!e)&&ec.test(t))}function lc(t,e){if(!Yu.test(t))return!1;try{const[n]=t.split("."),i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(i));return!(typeof o!="object"||o===null||"typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function uc(t,e){return!!((e==="v4"||!e)&&ju.test(t)||(e==="v6"||!e)&&tc.test(t))}class Se extends W{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){const r=this._getOrReturnCtx(e);return M(r,{code:S.invalid_type,expected:P.string,received:r.parsedType}),O}const i=new ce;let o;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(o=this._getOrReturnCtx(e,o),M(o,{code:S.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),i.dirty());else if(r.kind==="max")e.data.length>r.value&&(o=this._getOrReturnCtx(e,o),M(o,{code:S.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),i.dirty());else if(r.kind==="length"){const l=e.data.length>r.value,u=e.data.length<r.value;(l||u)&&(o=this._getOrReturnCtx(e,o),l?M(o,{code:S.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):u&&M(o,{code:S.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),i.dirty())}else if(r.kind==="email")zu.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"email",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="emoji")Qn||(Qn=new RegExp(Xu,"u")),Qn.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"emoji",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="uuid")Wu.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"uuid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="nanoid")Ku.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"nanoid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="cuid")qu.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"cuid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="cuid2")Ju.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"cuid2",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="ulid")Hu.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"ulid",code:S.invalid_string,message:r.message}),i.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),M(o,{validation:"url",code:S.invalid_string,message:r.message}),i.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"regex",code:S.invalid_string,message:r.message}),i.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(o=this._getOrReturnCtx(e,o),M(o,{code:S.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),i.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(o=this._getOrReturnCtx(e,o),M(o,{code:S.invalid_string,validation:{startsWith:r.value},message:r.message}),i.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(o=this._getOrReturnCtx(e,o),M(o,{code:S.invalid_string,validation:{endsWith:r.value},message:r.message}),i.dirty()):r.kind==="datetime"?rc(r).test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{code:S.invalid_string,validation:"datetime",message:r.message}),i.dirty()):r.kind==="date"?oc.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{code:S.invalid_string,validation:"date",message:r.message}),i.dirty()):r.kind==="time"?sc(r).test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{code:S.invalid_string,validation:"time",message:r.message}),i.dirty()):r.kind==="duration"?Zu.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"duration",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="ip"?ac(e.data,r.version)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"ip",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="jwt"?lc(e.data,r.alg)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"jwt",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="cidr"?uc(e.data,r.version)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"cidr",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="base64"?nc.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"base64",code:S.invalid_string,message:r.message}),i.dirty()):r.kind==="base64url"?ic.test(e.data)||(o=this._getOrReturnCtx(e,o),M(o,{validation:"base64url",code:S.invalid_string,message:r.message}),i.dirty()):Y.assertNever(r);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(o=>e.test(o),{validation:n,code:S.invalid_string,...k.errToObj(i)})}_addCheck(e){return new Se({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...k.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...k.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...k.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...k.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...k.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...k.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...k.errToObj(n)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new Se({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Se({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Se({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Se.create=t=>new Se({checks:[],typeName:$.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...J(t)});function cc(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,o=n>i?n:i,r=Number.parseInt(t.toFixed(o).replace(".","")),l=Number.parseInt(e.toFixed(o).replace(".",""));return r%l/10**o}class He extends W{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){const r=this._getOrReturnCtx(e);return M(r,{code:S.invalid_type,expected:P.number,received:r.parsedType}),O}let i;const o=new ce;for(const r of this._def.checks)r.kind==="int"?Y.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{code:S.invalid_type,expected:"integer",received:"float",message:r.message}),o.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(i=this._getOrReturnCtx(e,i),M(i,{code:S.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),o.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(i=this._getOrReturnCtx(e,i),M(i,{code:S.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),o.dirty()):r.kind==="multipleOf"?cc(e.data,r.value)!==0&&(i=this._getOrReturnCtx(e,i),M(i,{code:S.not_multiple_of,multipleOf:r.value,message:r.message}),o.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{code:S.not_finite,message:r.message}),o.dirty()):Y.assertNever(r);return{status:o.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,k.toString(n))}gt(e,n){return this.setLimit("min",e,!1,k.toString(n))}lte(e,n){return this.setLimit("max",e,!0,k.toString(n))}lt(e,n){return this.setLimit("max",e,!1,k.toString(n))}setLimit(e,n,i,o){return new He({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:k.toString(o)}]})}_addCheck(e){return new He({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Y.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}He.create=t=>new He({checks:[],typeName:$.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...J(t)});class We extends W{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let i;const o=new ce;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(i=this._getOrReturnCtx(e,i),M(i,{code:S.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),o.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(i=this._getOrReturnCtx(e,i),M(i,{code:S.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),o.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),M(i,{code:S.not_multiple_of,multipleOf:r.value,message:r.message}),o.dirty()):Y.assertNever(r);return{status:o.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return M(n,{code:S.invalid_type,expected:P.bigint,received:n.parsedType}),O}gte(e,n){return this.setLimit("min",e,!0,k.toString(n))}gt(e,n){return this.setLimit("min",e,!1,k.toString(n))}lte(e,n){return this.setLimit("max",e,!0,k.toString(n))}lt(e,n){return this.setLimit("max",e,!1,k.toString(n))}setLimit(e,n,i,o){return new We({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:k.toString(o)}]})}_addCheck(e){return new We({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}We.create=t=>new We({checks:[],typeName:$.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...J(t)});class vn extends W{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){const i=this._getOrReturnCtx(e);return M(i,{code:S.invalid_type,expected:P.boolean,received:i.parsedType}),O}return ye(e.data)}}vn.create=t=>new vn({typeName:$.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...J(t)});class st extends W{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){const r=this._getOrReturnCtx(e);return M(r,{code:S.invalid_type,expected:P.date,received:r.parsedType}),O}if(Number.isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return M(r,{code:S.invalid_date}),O}const i=new ce;let o;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(o=this._getOrReturnCtx(e,o),M(o,{code:S.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),i.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(o=this._getOrReturnCtx(e,o),M(o,{code:S.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),i.dirty()):Y.assertNever(r);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new st({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}st.create=t=>new st({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:$.ZodDate,...J(t)});class Uo extends W{_parse(e){if(this._getType(e)!==P.symbol){const i=this._getOrReturnCtx(e);return M(i,{code:S.invalid_type,expected:P.symbol,received:i.parsedType}),O}return ye(e.data)}}Uo.create=t=>new Uo({typeName:$.ZodSymbol,...J(t)});class Vo extends W{_parse(e){if(this._getType(e)!==P.undefined){const i=this._getOrReturnCtx(e);return M(i,{code:S.invalid_type,expected:P.undefined,received:i.parsedType}),O}return ye(e.data)}}Vo.create=t=>new Vo({typeName:$.ZodUndefined,...J(t)});class $o extends W{_parse(e){if(this._getType(e)!==P.null){const i=this._getOrReturnCtx(e);return M(i,{code:S.invalid_type,expected:P.null,received:i.parsedType}),O}return ye(e.data)}}$o.create=t=>new $o({typeName:$.ZodNull,...J(t)});class Bo extends W{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}}Bo.create=t=>new Bo({typeName:$.ZodAny,...J(t)});class mi extends W{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}}mi.create=t=>new mi({typeName:$.ZodUnknown,...J(t)});class Ue extends W{_parse(e){const n=this._getOrReturnCtx(e);return M(n,{code:S.invalid_type,expected:P.never,received:n.parsedType}),O}}Ue.create=t=>new Ue({typeName:$.ZodNever,...J(t)});class Oo extends W{_parse(e){if(this._getType(e)!==P.undefined){const i=this._getOrReturnCtx(e);return M(i,{code:S.invalid_type,expected:P.void,received:i.parsedType}),O}return ye(e.data)}}Oo.create=t=>new Oo({typeName:$.ZodVoid,...J(t)});class xe extends W{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),o=this._def;if(n.parsedType!==P.array)return M(n,{code:S.invalid_type,expected:P.array,received:n.parsedType}),O;if(o.exactLength!==null){const l=n.data.length>o.exactLength.value,u=n.data.length<o.exactLength.value;(l||u)&&(M(n,{code:l?S.too_big:S.too_small,minimum:u?o.exactLength.value:void 0,maximum:l?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),i.dirty())}if(o.minLength!==null&&n.data.length<o.minLength.value&&(M(n,{code:S.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),i.dirty()),o.maxLength!==null&&n.data.length>o.maxLength.value&&(M(n,{code:S.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((l,u)=>o.type._parseAsync(new Ee(n,l,n.path,u)))).then(l=>ce.mergeArray(i,l));const r=[...n.data].map((l,u)=>o.type._parseSync(new Ee(n,l,n.path,u)));return ce.mergeArray(i,r)}get element(){return this._def.type}min(e,n){return new xe({...this._def,minLength:{value:e,message:k.toString(n)}})}max(e,n){return new xe({...this._def,maxLength:{value:e,message:k.toString(n)}})}length(e,n){return new xe({...this._def,exactLength:{value:e,message:k.toString(n)}})}nonempty(e){return this.min(1,e)}}xe.create=(t,e)=>new xe({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$.ZodArray,...J(e)});function je(t){if(t instanceof j){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=Le.create(je(i))}return new j({...t._def,shape:()=>e})}else return t instanceof xe?new xe({...t._def,type:je(t.element)}):t instanceof Le?Le.create(je(t.unwrap())):t instanceof lt?lt.create(je(t.unwrap())):t instanceof Ke?Ke.create(t.items.map(e=>je(e))):t}class j extends W{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Y.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==P.object){const c=this._getOrReturnCtx(e);return M(c,{code:S.invalid_type,expected:P.object,received:c.parsedType}),O}const{status:i,ctx:o}=this._processInputParams(e),{shape:r,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(const c in o.data)l.includes(c)||u.push(c);const d=[];for(const c of l){const f=r[c],h=o.data[c];d.push({key:{status:"valid",value:c},value:f._parse(new Ee(o,h,o.path,c)),alwaysSet:c in o.data})}if(this._def.catchall instanceof Ue){const c=this._def.unknownKeys;if(c==="passthrough")for(const f of u)d.push({key:{status:"valid",value:f},value:{status:"valid",value:o.data[f]}});else if(c==="strict")u.length>0&&(M(o,{code:S.unrecognized_keys,keys:u}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const f of u){const h=o.data[f];d.push({key:{status:"valid",value:f},value:c._parse(new Ee(o,h,o.path,f)),alwaysSet:f in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const c=[];for(const f of d){const h=await f.key,p=await f.value;c.push({key:h,value:p,alwaysSet:f.alwaysSet})}return c}).then(c=>ce.mergeObjectSync(i,c)):ce.mergeObjectSync(i,d)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new j({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var r,l;const o=((l=(r=this._def).errorMap)==null?void 0:l.call(r,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:k.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new j({...this._def,unknownKeys:"strip"})}passthrough(){return new j({...this._def,unknownKeys:"passthrough"})}extend(e){return new j({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new j({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new j({...this._def,catchall:e})}pick(e){const n={};for(const i of Y.objectKeys(e))e[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new j({...this._def,shape:()=>n})}omit(e){const n={};for(const i of Y.objectKeys(this.shape))e[i]||(n[i]=this.shape[i]);return new j({...this._def,shape:()=>n})}deepPartial(){return je(this)}partial(e){const n={};for(const i of Y.objectKeys(this.shape)){const o=this.shape[i];e&&!e[i]?n[i]=o:n[i]=o.optional()}return new j({...this._def,shape:()=>n})}required(e){const n={};for(const i of Y.objectKeys(this.shape))if(e&&!e[i])n[i]=this.shape[i];else{let r=this.shape[i];for(;r instanceof Le;)r=r._def.innerType;n[i]=r}return new j({...this._def,shape:()=>n})}keyof(){return Ua(Y.objectKeys(this.shape))}}j.create=(t,e)=>new j({shape:()=>t,unknownKeys:"strip",catchall:Ue.create(),typeName:$.ZodObject,...J(e)});j.strictCreate=(t,e)=>new j({shape:()=>t,unknownKeys:"strict",catchall:Ue.create(),typeName:$.ZodObject,...J(e)});j.lazycreate=(t,e)=>new j({shape:t,unknownKeys:"strip",catchall:Ue.create(),typeName:$.ZodObject,...J(e)});class Cn extends W{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function o(r){for(const u of r)if(u.result.status==="valid")return u.result;for(const u of r)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const l=r.map(u=>new Re(u.ctx.common.issues));return M(n,{code:S.invalid_union,unionErrors:l}),O}if(n.common.async)return Promise.all(i.map(async r=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await r._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(o);{let r;const l=[];for(const d of i){const c={...n,common:{...n.common,issues:[]},parent:null},f=d._parseSync({data:n.data,path:n.path,parent:c});if(f.status==="valid")return f;f.status==="dirty"&&!r&&(r={result:f,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(r)return n.common.issues.push(...r.ctx.common.issues),r.result;const u=l.map(d=>new Re(d));return M(n,{code:S.invalid_union,unionErrors:u}),O}}get options(){return this._def.options}}Cn.create=(t,e)=>new Cn({options:t,typeName:$.ZodUnion,...J(e)});function gi(t,e){const n=Fe(t),i=Fe(e);if(t===e)return{valid:!0,data:t};if(n===P.object&&i===P.object){const o=Y.objectKeys(e),r=Y.objectKeys(t).filter(u=>o.indexOf(u)!==-1),l={...t,...e};for(const u of r){const d=gi(t[u],e[u]);if(!d.valid)return{valid:!1};l[u]=d.data}return{valid:!0,data:l}}else if(n===P.array&&i===P.array){if(t.length!==e.length)return{valid:!1};const o=[];for(let r=0;r<t.length;r++){const l=t[r],u=e[r],d=gi(l,u);if(!d.valid)return{valid:!1};o.push(d.data)}return{valid:!0,data:o}}else return n===P.date&&i===P.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Tn extends W{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),o=(r,l)=>{if(Do(r)||Do(l))return O;const u=gi(r.value,l.value);return u.valid?((Fo(r)||Fo(l))&&n.dirty(),{status:n.value,value:u.data}):(M(i,{code:S.invalid_intersection_types}),O)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([r,l])=>o(r,l)):o(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}Tn.create=(t,e,n)=>new Tn({left:t,right:e,typeName:$.ZodIntersection,...J(n)});class Ke extends W{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.array)return M(i,{code:S.invalid_type,expected:P.array,received:i.parsedType}),O;if(i.data.length<this._def.items.length)return M(i,{code:S.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),O;!this._def.rest&&i.data.length>this._def.items.length&&(M(i,{code:S.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const r=[...i.data].map((l,u)=>{const d=this._def.items[u]||this._def.rest;return d?d._parse(new Ee(i,l,i.path,u)):null}).filter(l=>!!l);return i.common.async?Promise.all(r).then(l=>ce.mergeArray(n,l)):ce.mergeArray(n,r)}get items(){return this._def.items}rest(e){return new Ke({...this._def,rest:e})}}Ke.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ke({items:t,typeName:$.ZodTuple,rest:null,...J(e)})};class wn extends W{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.object)return M(i,{code:S.invalid_type,expected:P.object,received:i.parsedType}),O;const o=[],r=this._def.keyType,l=this._def.valueType;for(const u in i.data)o.push({key:r._parse(new Ee(i,u,i.path,u)),value:l._parse(new Ee(i,i.data[u],i.path,u)),alwaysSet:u in i.data});return i.common.async?ce.mergeObjectAsync(n,o):ce.mergeObjectSync(n,o)}get element(){return this._def.valueType}static create(e,n,i){return n instanceof W?new wn({keyType:e,valueType:n,typeName:$.ZodRecord,...J(i)}):new wn({keyType:Se.create(),valueType:e,typeName:$.ZodRecord,...J(n)})}}class Go extends W{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.map)return M(i,{code:S.invalid_type,expected:P.map,received:i.parsedType}),O;const o=this._def.keyType,r=this._def.valueType,l=[...i.data.entries()].map(([u,d],c)=>({key:o._parse(new Ee(i,u,i.path,[c,"key"])),value:r._parse(new Ee(i,d,i.path,[c,"value"]))}));if(i.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const d of l){const c=await d.key,f=await d.value;if(c.status==="aborted"||f.status==="aborted")return O;(c.status==="dirty"||f.status==="dirty")&&n.dirty(),u.set(c.value,f.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const d of l){const c=d.key,f=d.value;if(c.status==="aborted"||f.status==="aborted")return O;(c.status==="dirty"||f.status==="dirty")&&n.dirty(),u.set(c.value,f.value)}return{status:n.value,value:u}}}}Go.create=(t,e,n)=>new Go({valueType:e,keyType:t,typeName:$.ZodMap,...J(n)});class kt extends W{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==P.set)return M(i,{code:S.invalid_type,expected:P.set,received:i.parsedType}),O;const o=this._def;o.minSize!==null&&i.data.size<o.minSize.value&&(M(i,{code:S.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),n.dirty()),o.maxSize!==null&&i.data.size>o.maxSize.value&&(M(i,{code:S.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),n.dirty());const r=this._def.valueType;function l(d){const c=new Set;for(const f of d){if(f.status==="aborted")return O;f.status==="dirty"&&n.dirty(),c.add(f.value)}return{status:n.value,value:c}}const u=[...i.data.values()].map((d,c)=>r._parse(new Ee(i,d,i.path,c)));return i.common.async?Promise.all(u).then(d=>l(d)):l(u)}min(e,n){return new kt({...this._def,minSize:{value:e,message:k.toString(n)}})}max(e,n){return new kt({...this._def,maxSize:{value:e,message:k.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}kt.create=(t,e)=>new kt({valueType:t,minSize:null,maxSize:null,typeName:$.ZodSet,...J(e)});class yi extends W{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}yi.create=(t,e)=>new yi({getter:t,typeName:$.ZodLazy,...J(e)});class qo extends W{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return M(n,{received:n.data,code:S.invalid_literal,expected:this._def.value}),O}return{status:"valid",value:e.data}}get value(){return this._def.value}}qo.create=(t,e)=>new qo({value:t,typeName:$.ZodLiteral,...J(e)});function Ua(t,e){return new rt({values:t,typeName:$.ZodEnum,...J(e)})}class rt extends W{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return M(n,{expected:Y.joinValues(i),received:n.parsedType,code:S.invalid_type}),O}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return M(n,{received:n.data,code:S.invalid_enum_value,options:i}),O}return ye(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return rt.create(e,{...this._def,...n})}exclude(e,n=this._def){return rt.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}rt.create=Ua;class Jo extends W{_parse(e){const n=Y.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==P.string&&i.parsedType!==P.number){const o=Y.objectValues(n);return M(i,{expected:Y.joinValues(o),received:i.parsedType,code:S.invalid_type}),O}if(this._cache||(this._cache=new Set(Y.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const o=Y.objectValues(n);return M(i,{received:i.data,code:S.invalid_enum_value,options:o}),O}return ye(e.data)}get enum(){return this._def.values}}Jo.create=(t,e)=>new Jo({values:t,typeName:$.ZodNativeEnum,...J(e)});class Sn extends W{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==P.promise&&n.common.async===!1)return M(n,{code:S.invalid_type,expected:P.promise,received:n.parsedType}),O;const i=n.parsedType===P.promise?n.data:Promise.resolve(n.data);return ye(i.then(o=>this._def.type.parseAsync(o,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Sn.create=(t,e)=>new Sn({type:t,typeName:$.ZodPromise,...J(e)});class at extends W{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),o=this._def.effect||null,r={addIssue:l=>{M(i,l),l.fatal?n.abort():n.dirty()},get path(){return i.path}};if(r.addIssue=r.addIssue.bind(r),o.type==="preprocess"){const l=o.transform(i.data,r);if(i.common.async)return Promise.resolve(l).then(async u=>{if(n.value==="aborted")return O;const d=await this._def.schema._parseAsync({data:u,path:i.path,parent:i});return d.status==="aborted"?O:d.status==="dirty"||n.value==="dirty"?At(d.value):d});{if(n.value==="aborted")return O;const u=this._def.schema._parseSync({data:l,path:i.path,parent:i});return u.status==="aborted"?O:u.status==="dirty"||n.value==="dirty"?At(u.value):u}}if(o.type==="refinement"){const l=u=>{const d=o.refinement(u,r);if(i.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(i.common.async===!1){const u=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?O:(u.status==="dirty"&&n.dirty(),l(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(u=>u.status==="aborted"?O:(u.status==="dirty"&&n.dirty(),l(u.value).then(()=>({status:n.value,value:u.value}))))}if(o.type==="transform")if(i.common.async===!1){const l=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ot(l))return O;const u=o.transform(l.value,r);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(l=>ot(l)?Promise.resolve(o.transform(l.value,r)).then(u=>({status:n.value,value:u})):O);Y.assertNever(o)}}at.create=(t,e,n)=>new at({schema:t,typeName:$.ZodEffects,effect:e,...J(n)});at.createWithPreprocess=(t,e,n)=>new at({schema:e,effect:{type:"preprocess",transform:t},typeName:$.ZodEffects,...J(n)});class Le extends W{_parse(e){return this._getType(e)===P.undefined?ye(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Le.create=(t,e)=>new Le({innerType:t,typeName:$.ZodOptional,...J(e)});class lt extends W{_parse(e){return this._getType(e)===P.null?ye(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}lt.create=(t,e)=>new lt({innerType:t,typeName:$.ZodNullable,...J(e)});class _i extends W{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===P.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}_i.create=(t,e)=>new _i({innerType:t,typeName:$.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...J(e)});class vi extends W{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},o=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return _n(o)?o.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Re(i.common.issues)},input:i.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Re(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}vi.create=(t,e)=>new vi({innerType:t,typeName:$.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...J(e)});class Ho extends W{_parse(e){if(this._getType(e)!==P.nan){const i=this._getOrReturnCtx(e);return M(i,{code:S.invalid_type,expected:P.nan,received:i.parsedType}),O}return{status:"valid",value:e.data}}}Ho.create=t=>new Ho({typeName:$.ZodNaN,...J(t)});class dc extends W{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class ji extends W{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?O:r.status==="dirty"?(n.dirty(),At(r.value)):this._def.out._parseAsync({data:r.value,path:i.path,parent:i})})();{const o=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?O:o.status==="dirty"?(n.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:i.path,parent:i})}}static create(e,n){return new ji({in:e,out:n,typeName:$.ZodPipeline})}}class Ci extends W{_parse(e){const n=this._def.innerType._parse(e),i=o=>(ot(o)&&(o.value=Object.freeze(o.value)),o);return _n(n)?n.then(o=>i(o)):i(n)}unwrap(){return this._def.innerType}}Ci.create=(t,e)=>new Ci({innerType:t,typeName:$.ZodReadonly,...J(e)});var $;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($||($={}));const $e=Se.create,Wo=He.create;We.create;const fc=vn.create;st.create;const Ko=mi.create;Ue.create;const xt=xe.create,hc=j.create,pc=Cn.create;Tn.create;Ke.create;const mc=wn.create,gc=yi.create,yc=rt.create;Sn.create;Le.create;lt.create;const ze={string:t=>Se.create({...t,coerce:!0}),number:t=>He.create({...t,coerce:!0}),boolean:t=>vn.create({...t,coerce:!0}),bigint:t=>We.create({...t,coerce:!0}),date:t=>st.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let _c,vc;function Cc(){return{geminiUrl:_c,vertexUrl:vc}}function Tc(t,e,n){var i,o,r;if(!(!((i=t.httpOptions)===null||i===void 0)&&i.baseUrl)){const l=Cc();return t.vertexai?(o=l.vertexUrl)!==null&&o!==void 0?o:e:(r=l.geminiUrl)!==null&&r!==void 0?r:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dt{}function F(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const r=e[o];return r!=null?String(r):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function a(t,e,n){for(let r=0;r<e.length-1;r++){const l=e[r];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[u])){const d=t[u];if(Array.isArray(n))for(let c=0;c<d.length;c++){const f=d[c];a(f,e.slice(r+1),n[c])}else for(const c of d)a(c,e.slice(r+1),n)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in t||(t[u]=[{}]);const d=t[u];a(d[0],e.slice(r+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const i=e[e.length-1],o=t[i];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else t[i]=n}function s(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const i=e[n];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in t){const r=t[o];return Array.isArray(r)?r.map(l=>s(l,e.slice(n+1))):void 0}else return}else t=t[i]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Yo;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Yo||(Yo={}));var Zo;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Zo||(Zo={}));var Ae;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Ae||(Ae={}));var zo;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(zo||(zo={}));var Xo;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Xo||(Xo={}));var Qo;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Qo||(Qo={}));var jo;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(jo||(jo={}));var es;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(es||(es={}));var ts;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(ts||(ts={}));var ns;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(ns||(ns={}));var is;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(is||(is={}));var os;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(os||(os={}));var ss;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ss||(ss={}));var An;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(An||(An={}));var rs;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(rs||(rs={}));var Ti;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ti||(Ti={}));var as;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(as||(as={}));var ls;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(ls||(ls={}));var us;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(us||(us={}));var cs;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(cs||(cs={}));var ds;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(ds||(ds={}));var fs;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(fs||(fs={}));var hs;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(hs||(hs={}));var ps;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(ps||(ps={}));var ms;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(ms||(ms={}));var gs;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(gs||(gs={}));var ys;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(ys||(ys={}));var _s;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(_s||(_s={}));var vs;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(vs||(vs={}));var Cs;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Cs||(Cs={}));var Ts;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Ts||(Ts={}));var ws;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(ws||(ws={}));var Ss;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ss||(Ss={}));var As;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(As||(As={}));var xs;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(xs||(xs={}));var Es;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Es||(Es={}));var Is;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Is||(Is={}));var Ms;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Ms||(Ms={}));var tt;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(tt||(tt={}));class wi{constructor(e){const n={};for(const i of e.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class mt{get text(){var e,n,i,o,r,l,u,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const h=[];for(const p of(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,g]of Object.entries(p))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,c+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,n,i,o,r,l,u,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const h of(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&f.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,i,o,r,l,u,d;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,n,i,o,r,l,u,d,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,i,o,r,l,u,d,c;if(((o=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(u=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class Rs{}class Ps{}class wc{}class Sc{}class ks{}class Ns{}class bs{}class Ac{}class Ds{}class Fs{}class Ls{}class xc{}class Ec{}class Ic{}class Mc{get text(){var e,n,i;let o="",r=!1;const l=[];for(const u of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;r=!0,o+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?o:void 0}get data(){var e,n,i;let o="";const r=[];for(const l of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&r.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(o+=atob(l.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class Rc{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Va(t,e){const n=z(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function $a(t){return Array.isArray(t)?t.map(e=>xn(e)):[xn(t)]}function xn(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Pc(t){const e=xn(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function kc(t){const e=xn(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Us(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Ba(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Us(e)):[Us(t)]}function Si(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Vs(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function $s(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ue(t){if(t==null)throw new Error("ContentUnion is required");return Si(t)?t:{role:"user",parts:Ba(t)}}function Oa(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const i=ue(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(t.isVertexAI()){const n=ue(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ue(n)):[ue(e)]}function ve(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Vs(t)||$s(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ue(t)]}const e=[],n=[],i=Si(t[0]);for(const o of t){const r=Si(o);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(o);else{if(Vs(o)||$s(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return i||e.push({role:"user",parts:Ba(n)}),e}const Nc=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),Bs=yc(["string","number","integer","object","array","boolean","null"]),bc=pc([Bs,xt(Bs)]);function Dc(t=!0){const e=gc(()=>{const n=hc({type:bc.optional(),format:$e().optional(),title:$e().optional(),description:$e().optional(),default:Ko().optional(),items:e.optional(),minItems:ze.string().optional(),maxItems:ze.string().optional(),enum:xt(Ko()).optional(),properties:mc($e(),e).optional(),required:xt($e()).optional(),minProperties:ze.string().optional(),maxProperties:ze.string().optional(),propertyOrdering:xt($e()).optional(),minimum:Wo().optional(),maximum:Wo().optional(),minLength:ze.string().optional(),maxLength:ze.string().optional(),pattern:$e().optional(),anyOf:xt(e).optional(),additionalProperties:fc().optional()});return t?n.strict():n});return e}function Fc(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(i=>i!=="null");if(n.length===1)e.type=Object.values(Ae).includes(n[0].toUpperCase())?n[0].toUpperCase():Ae.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of n)e.anyOf.push({type:Object.values(Ae).includes(i.toUpperCase())?i.toUpperCase():Ae.TYPE_UNSPECIFIED})}}function nt(t){const e={},n=["items"],i=["anyOf"],o=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=t.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,t=r[1]):r[1].type==="null"&&(e.nullable=!0,t=r[0])),t.type instanceof Array&&Fc(t.type,e);for(const[l,u]of Object.entries(t))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Ae).includes(u.toUpperCase())?u.toUpperCase():Ae.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=nt(u);else if(i.includes(l)){const d=[];for(const c of u){if(c.type=="null"){e.nullable=!0;continue}d.push(nt(c))}e[l]=d}else if(o.includes(l)){const d={};for(const[c,f]of Object.entries(u))d[c]=nt(f);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function En(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=Dc().parse(t);return nt(e)}else return nt(t)}function Ga(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function eo(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Vt(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=En(e.parameters)),e.response&&(e.response=En(e.response));return t}function $t(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Lc(t,e,n,i=1){const o=!e.startsWith(`${n}/`)&&e.split("/").length===i;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:o?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:o?`${n}/${e}`:e}function Ve(t,e){if(typeof e!="string")throw new Error("name must be a string");return Lc(t,e,"cachedContents")}function qa(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Pe(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Uc(t){return t!=null&&typeof t=="object"&&"name"in t}function Vc(t){return t!=null&&typeof t=="object"&&"video"in t}function $c(t){return t!=null&&typeof t=="object"&&"uri"in t}function Ja(t){var e;let n;if(Uc(t)&&(n=t.name),!($c(t)&&(n=t.uri,n===void 0))&&!(Vc(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Ha(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Wa(t){for(const e of["models","tunedModels","publisherModels"])if(Bc(t,e))return t[e];return[]}function Bc(t,e){return t!==null&&typeof t=="object"&&e in t}function Oc(t,e={}){const n=t,i={name:n.name,description:n.description,parameters:nt(Ln(n.inputSchema))};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Gc(t,e={}){const n=[],i=new Set;for(const o of t){const r=o.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const l=Oc(o,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function qc(t){const e=[];for(const n of t)e.push(Ln(n));return e}function Jc(t){const e={};for(const[n,i]of Object.entries(t)){const o=i;e[n]=Ln(o)}return e}function Ln(t){const e=new Set(["items"]),n=new Set(["anyOf"]),i=new Set(["properties"]),o={};for(const[r,l]of Object.entries(t))if(e.has(r))o[r]=Ln(l);else if(n.has(r))o[r]=qc(l);else if(i.has(r))o[r]=Jc(l);else if(r==="type"){const u=l.toUpperCase();o[r]=Object.values(Ae).includes(u)?u:Ae.TYPE_UNSPECIFIED}else Nc.has(r)&&(o[r]=l);return o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hc(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Wc(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Kc(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Yc(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Hc(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Wc(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Kc(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Os(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Yc(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Zc(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function zc(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Xc(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],zc(n)),e}function Qc(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function jc(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Qc(n)),e}function ed(){return{}}function td(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>Zc(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],Xc(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],jc(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],ed());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function nd(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function id(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function od(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],id(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function sd(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],nd(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],od(i)),e}function rd(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);e!==void 0&&o!=null&&a(e,["expireTime"],o);const r=s(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const l=s(t,["contents"]);if(e!==void 0&&l!=null){let f=ve(l);Array.isArray(f)&&(f=f.map(h=>Os(h))),a(e,["contents"],f)}const u=s(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Os(ue(u)));const d=s(t,["tools"]);if(e!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(h=>td(h))),a(e,["tools"],f)}const c=s(t,["toolConfig"]);if(e!==void 0&&c!=null&&a(e,["toolConfig"],sd(c)),s(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function ad(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["model"],Va(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],rd(o,n)),n}function ld(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ve(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function ud(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ve(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function cd(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);return e!==void 0&&o!=null&&a(e,["expireTime"],o),n}function dd(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ve(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],cd(o,n)),n}function fd(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);return e!==void 0&&o!=null&&a(e,["_query","pageToken"],o),n}function hd(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],fd(n,e)),e}function pd(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function md(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function gd(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function yd(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],pd(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],md(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],gd(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Gs(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>yd(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function _d(t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&a(e,["description"],n);const i=s(t,["name"]);i!=null&&a(e,["name"],i);const o=s(t,["parameters"]);o!=null&&a(e,["parameters"],o);const r=s(t,["parametersJsonSchema"]);r!=null&&a(e,["parametersJsonSchema"],r);const l=s(t,["response"]);l!=null&&a(e,["response"],l);const u=s(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function vd(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Cd(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],vd(n)),e}function Td(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function wd(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Td(n)),e}function Sd(){return{}}function Ad(t){const e={},n=s(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function xd(t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],Ad(n));const i=s(t,["authType"]);i!=null&&a(e,["authType"],i);const o=s(t,["googleServiceAccountConfig"]);o!=null&&a(e,["googleServiceAccountConfig"],o);const r=s(t,["httpBasicAuthConfig"]);r!=null&&a(e,["httpBasicAuthConfig"],r);const l=s(t,["oauthConfig"]);l!=null&&a(e,["oauthConfig"],l);const u=s(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function Ed(t){const e={},n=s(t,["authConfig"]);return n!=null&&a(e,["authConfig"],xd(n)),e}function Id(){return{}}function Md(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>_d(h))),a(e,["functionDeclarations"],f)}const i=s(t,["retrieval"]);i!=null&&a(e,["retrieval"],i);const o=s(t,["googleSearch"]);o!=null&&a(e,["googleSearch"],Cd(o));const r=s(t,["googleSearchRetrieval"]);r!=null&&a(e,["googleSearchRetrieval"],wd(r)),s(t,["enterpriseWebSearch"])!=null&&a(e,["enterpriseWebSearch"],Sd());const u=s(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],Ed(u)),s(t,["urlContext"])!=null&&a(e,["urlContext"],Id());const c=s(t,["codeExecution"]);return c!=null&&a(e,["codeExecution"],c),e}function Rd(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function Pd(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function kd(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],Pd(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function Nd(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],Rd(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],kd(i)),e}function bd(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);e!==void 0&&o!=null&&a(e,["expireTime"],o);const r=s(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const l=s(t,["contents"]);if(e!==void 0&&l!=null){let h=ve(l);Array.isArray(h)&&(h=h.map(p=>Gs(p))),a(e,["contents"],h)}const u=s(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Gs(ue(u)));const d=s(t,["tools"]);if(e!==void 0&&d!=null){let h=d;Array.isArray(h)&&(h=h.map(p=>Md(p))),a(e,["tools"],h)}const c=s(t,["toolConfig"]);e!==void 0&&c!=null&&a(e,["toolConfig"],Nd(c));const f=s(t,["kmsKeyName"]);return e!==void 0&&f!=null&&a(e,["encryption_spec","kmsKeyName"],f),n}function Dd(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["model"],Va(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],bd(o,n)),n}function Fd(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ve(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Ld(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ve(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Ud(t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&a(e,["ttl"],i);const o=s(t,["expireTime"]);return e!==void 0&&o!=null&&a(e,["expireTime"],o),n}function Vd(t,e){const n={},i=s(e,["name"]);i!=null&&a(n,["_url","name"],Ve(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Ud(o,n)),n}function $d(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);return e!==void 0&&o!=null&&a(e,["_query","pageToken"],o),n}function Bd(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],$d(n,e)),e}function an(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["model"]);o!=null&&a(e,["model"],o);const r=s(t,["createTime"]);r!=null&&a(e,["createTime"],r);const l=s(t,["updateTime"]);l!=null&&a(e,["updateTime"],l);const u=s(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const d=s(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function Od(){return{}}function Gd(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>an(r))),a(e,["cachedContents"],o)}return e}function ln(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["model"]);o!=null&&a(e,["model"],o);const r=s(t,["createTime"]);r!=null&&a(e,["createTime"],r);const l=s(t,["updateTime"]);l!=null&&a(e,["updateTime"],l);const u=s(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const d=s(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function qd(){return{}}function Jd(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>ln(r))),a(e,["cachedContents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ut;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(ut||(ut={}));class Un{constructor(e,n,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,i,o)}init(e,n,i){var o,r;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};i?typeof i=="object"?l=Object.assign({},i):l=i:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(r=(o=l.config)===null||o===void 0?void 0:o.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hd extends dt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Un(ut.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Dd(this.apiClient,e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>ln(f))}else{const c=ad(this.apiClient,e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>an(f))}}async get(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Fd(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>ln(f))}else{const c=ld(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>an(f))}}async delete(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ld(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(()=>{const f=qd(),h=new Fs;return Object.assign(h,f),h})}else{const c=ud(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Od(),h=new Fs;return Object.assign(h,f),h})}}async update(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Vd(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>ln(f))}else{const c=dd(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>an(f))}}async listInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Bd(e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Jd(f),p=new Ls;return Object.assign(p,h),p})}else{const c=hd(e);return u=F("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Gd(f),p=new Ls;return Object.assign(p,h),p})}}}function qs(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(t){return this instanceof X?(this.v=t,this):new X(t)}function it(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),o[Symbol.asyncIterator]=function(){return this},o;function l(m){return function(g){return Promise.resolve(g).then(m,h)}}function u(m,g){i[m]&&(o[m]=function(y){return new Promise(function(v,x){r.push([m,y,v,x])>1||d(m,y)})},g&&(o[m]=g(o[m])))}function d(m,g){try{c(i[m](g))}catch(y){p(r[0][3],y)}}function c(m){m.value instanceof X?Promise.resolve(m.value.v).then(f,h):p(r[0][2],m)}function f(m){d("next",m)}function h(m){d("throw",m)}function p(m,g){m(g),r.shift(),r.length&&d(r[0][0],r[0][1])}}function Rt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof qs=="function"?qs(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(r){n[r]=t[r]&&function(l){return new Promise(function(u,d){l=t[r](l),o(u,d,l.done,l.value)})}}function o(r,l,u,d){Promise.resolve(d).then(function(c){r({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wd(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Ka(n)}function Ka(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function Kd(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Js(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let i=0;for(;i<n;)if(t[i].role==="user")e.push(t[i]),i++;else{const o=[];let r=!0;for(;i<n&&t[i].role==="model";)o.push(t[i]),r&&!Ka(t[i])&&(r=!1),i++;r?e.push(...o):e.pop()}return e}class Yd{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new Zd(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Zd{constructor(e,n,i,o={},r=[]){this.apiClient=e,this.modelsModule=n,this.model=i,this.config=o,this.history=r,this.sendPromise=Promise.resolve(),Kd(r)}async sendMessage(e){var n;await this.sendPromise;const i=ue(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var r,l,u;const d=await o,c=(l=(r=d.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content,f=d.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];f!=null&&(p=(u=f.slice(h))!==null&&u!==void 0?u:[]);const m=c?[c]:[];this.recordHistory(i,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var n;await this.sendPromise;const i=ue(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const r=await o;return this.processStreamResponse(r,i)}getHistory(e=!1){const n=e?Js(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var i,o;return it(this,arguments,function*(){var l,u,d,c;const f=[];try{for(var h=!0,p=Rt(e),m;m=yield X(p.next()),l=m.done,!l;h=!0){c=m.value,h=!1;const g=c;if(Wd(g)){const y=(o=(i=g.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;y!==void 0&&f.push(y)}yield yield X(g)}}catch(g){u={error:g}}finally{try{!h&&!l&&(d=p.return)&&(yield X(d.call(p)))}finally{if(u)throw u.error}}this.recordHistory(n,f)})}recordHistory(e,n,i){let o=[];n.length>0&&n.every(r=>r.role!==void 0)?o=n:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...Js(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vn extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Vn.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zd(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);return e!==void 0&&o!=null&&a(e,["_query","pageToken"],o),n}function Xd(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],zd(n,e)),e}function Qd(t){const e={},n=s(t,["details"]);n!=null&&a(e,["details"],n);const i=s(t,["message"]);i!=null&&a(e,["message"],i);const o=s(t,["code"]);return o!=null&&a(e,["code"],o),e}function jd(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["mimeType"]);o!=null&&a(e,["mimeType"],o);const r=s(t,["sizeBytes"]);r!=null&&a(e,["sizeBytes"],r);const l=s(t,["createTime"]);l!=null&&a(e,["createTime"],l);const u=s(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const d=s(t,["updateTime"]);d!=null&&a(e,["updateTime"],d);const c=s(t,["sha256Hash"]);c!=null&&a(e,["sha256Hash"],c);const f=s(t,["uri"]);f!=null&&a(e,["uri"],f);const h=s(t,["downloadUri"]);h!=null&&a(e,["downloadUri"],h);const p=s(t,["state"]);p!=null&&a(e,["state"],p);const m=s(t,["source"]);m!=null&&a(e,["source"],m);const g=s(t,["videoMetadata"]);g!=null&&a(e,["videoMetadata"],g);const y=s(t,["error"]);return y!=null&&a(e,["error"],Qd(y)),e}function ef(t){const e={},n=s(t,["file"]);n!=null&&a(e,["file"],jd(n));const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function tf(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","file"],Ja(n));const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function nf(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","file"],Ja(n));const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function of(t){const e={},n=s(t,["details"]);n!=null&&a(e,["details"],n);const i=s(t,["message"]);i!=null&&a(e,["message"],i);const o=s(t,["code"]);return o!=null&&a(e,["code"],o),e}function Ai(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["mimeType"]);o!=null&&a(e,["mimeType"],o);const r=s(t,["sizeBytes"]);r!=null&&a(e,["sizeBytes"],r);const l=s(t,["createTime"]);l!=null&&a(e,["createTime"],l);const u=s(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const d=s(t,["updateTime"]);d!=null&&a(e,["updateTime"],d);const c=s(t,["sha256Hash"]);c!=null&&a(e,["sha256Hash"],c);const f=s(t,["uri"]);f!=null&&a(e,["uri"],f);const h=s(t,["downloadUri"]);h!=null&&a(e,["downloadUri"],h);const p=s(t,["state"]);p!=null&&a(e,["state"],p);const m=s(t,["source"]);m!=null&&a(e,["source"],m);const g=s(t,["videoMetadata"]);g!=null&&a(e,["videoMetadata"],g);const y=s(t,["error"]);return y!=null&&a(e,["error"],of(y)),e}function sf(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>Ai(r))),a(e,["files"],o)}return e}function rf(){return{}}function af(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lf extends dt{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Un(ut.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Ai(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Xd(e);return r=F("files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=sf(d),f=new xc;return Object.assign(f,c),f})}}async createInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ef(e);return r=F("upload/v1beta/files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=rf(),c=new Ec;return Object.assign(c,d),c})}}async get(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=tf(e);return r=F("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Ai(d))}}async delete(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=nf(e);return r=F("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=af(),c=new Ic;return Object.assign(c,d),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uf(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function cf(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function Ya(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],uf(n)),e}function df(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],cf(n)),e}function ff(t){const e={},n=s(t,["speaker"]);n!=null&&a(e,["speaker"],n);const i=s(t,["voiceConfig"]);return i!=null&&a(e,["voiceConfig"],Ya(i)),e}function hf(t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>ff(o))),a(e,["speakerVoiceConfigs"],i)}return e}function pf(t){const e={},n=s(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],Ya(n));const i=s(t,["multiSpeakerVoiceConfig"]);i!=null&&a(e,["multiSpeakerVoiceConfig"],hf(i));const o=s(t,["languageCode"]);return o!=null&&a(e,["languageCode"],o),e}function mf(t){const e={},n=s(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],df(n)),s(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function gf(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function yf(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function _f(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function vf(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Cf(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Tf(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function wf(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],gf(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],_f(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Cf(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Sf(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],yf(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],vf(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Tf(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Af(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>wf(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function xf(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Sf(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Ef(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function If(t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&a(e,["description"],n);const i=s(t,["name"]);i!=null&&a(e,["name"],i);const o=s(t,["parameters"]);o!=null&&a(e,["parameters"],o);const r=s(t,["parametersJsonSchema"]);r!=null&&a(e,["parametersJsonSchema"],r);const l=s(t,["response"]);l!=null&&a(e,["response"],l);const u=s(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function Mf(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Rf(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Pf(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Mf(n)),e}function kf(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Rf(n)),e}function Nf(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function bf(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function Df(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Nf(n)),e}function Ff(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],bf(n)),e}function Lf(){return{}}function Uf(t){const e={},n=s(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function Vf(t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],Uf(n));const i=s(t,["authType"]);i!=null&&a(e,["authType"],i);const o=s(t,["googleServiceAccountConfig"]);o!=null&&a(e,["googleServiceAccountConfig"],o);const r=s(t,["httpBasicAuthConfig"]);r!=null&&a(e,["httpBasicAuthConfig"],r);const l=s(t,["oauthConfig"]);l!=null&&a(e,["oauthConfig"],l);const u=s(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function $f(t){const e={},n=s(t,["authConfig"]);return n!=null&&a(e,["authConfig"],Vf(n)),e}function Bf(){return{}}function Of(){return{}}function Gf(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>Ef(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],Pf(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],Df(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],Bf());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function qf(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>If(h))),a(e,["functionDeclarations"],f)}const i=s(t,["retrieval"]);i!=null&&a(e,["retrieval"],i);const o=s(t,["googleSearch"]);o!=null&&a(e,["googleSearch"],kf(o));const r=s(t,["googleSearchRetrieval"]);r!=null&&a(e,["googleSearchRetrieval"],Ff(r)),s(t,["enterpriseWebSearch"])!=null&&a(e,["enterpriseWebSearch"],Lf());const u=s(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],$f(u)),s(t,["urlContext"])!=null&&a(e,["urlContext"],Of());const c=s(t,["codeExecution"]);return c!=null&&a(e,["codeExecution"],c),e}function Jf(t){const e={},n=s(t,["handle"]);if(n!=null&&a(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Hf(t){const e={},n=s(t,["handle"]);n!=null&&a(e,["handle"],n);const i=s(t,["transparent"]);return i!=null&&a(e,["transparent"],i),e}function Hs(){return{}}function Ws(){return{}}function Wf(t){const e={},n=s(t,["disabled"]);n!=null&&a(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&a(e,["startOfSpeechSensitivity"],i);const o=s(t,["endOfSpeechSensitivity"]);o!=null&&a(e,["endOfSpeechSensitivity"],o);const r=s(t,["prefixPaddingMs"]);r!=null&&a(e,["prefixPaddingMs"],r);const l=s(t,["silenceDurationMs"]);return l!=null&&a(e,["silenceDurationMs"],l),e}function Kf(t){const e={},n=s(t,["disabled"]);n!=null&&a(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&a(e,["startOfSpeechSensitivity"],i);const o=s(t,["endOfSpeechSensitivity"]);o!=null&&a(e,["endOfSpeechSensitivity"],o);const r=s(t,["prefixPaddingMs"]);r!=null&&a(e,["prefixPaddingMs"],r);const l=s(t,["silenceDurationMs"]);return l!=null&&a(e,["silenceDurationMs"],l),e}function Yf(t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],Wf(n));const i=s(t,["activityHandling"]);i!=null&&a(e,["activityHandling"],i);const o=s(t,["turnCoverage"]);return o!=null&&a(e,["turnCoverage"],o),e}function Zf(t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],Kf(n));const i=s(t,["activityHandling"]);i!=null&&a(e,["activityHandling"],i);const o=s(t,["turnCoverage"]);return o!=null&&a(e,["turnCoverage"],o),e}function zf(t){const e={},n=s(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function Xf(t){const e={},n=s(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function Qf(t){const e={},n=s(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&a(e,["slidingWindow"],zf(i)),e}function jf(t){const e={},n=s(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&a(e,["slidingWindow"],Xf(i)),e}function eh(t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function th(t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function nh(t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig"],i);const o=s(t,["responseModalities"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","responseModalities"],o);const r=s(t,["temperature"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig","temperature"],r);const l=s(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=s(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=s(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=s(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=s(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],pf(eo(h)));const p=s(t,["enableAffectiveDialog"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],p);const m=s(t,["systemInstruction"]);e!==void 0&&m!=null&&a(e,["setup","systemInstruction"],Af(ue(m)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let I=$t(g);Array.isArray(I)&&(I=I.map(D=>Gf(Vt(D)))),a(e,["setup","tools"],I)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&a(e,["setup","sessionResumption"],Jf(y));const v=s(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&a(e,["setup","inputAudioTranscription"],Hs());const x=s(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&a(e,["setup","outputAudioTranscription"],Hs());const C=s(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&a(e,["setup","realtimeInputConfig"],Yf(C));const T=s(t,["contextWindowCompression"]);e!==void 0&&T!=null&&a(e,["setup","contextWindowCompression"],Qf(T));const w=s(t,["proactivity"]);return e!==void 0&&w!=null&&a(e,["setup","proactivity"],eh(w)),n}function ih(t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig"],i);const o=s(t,["responseModalities"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","responseModalities"],o);const r=s(t,["temperature"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig","temperature"],r);const l=s(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=s(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=s(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=s(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=s(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],mf(eo(h)));const p=s(t,["enableAffectiveDialog"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],p);const m=s(t,["systemInstruction"]);e!==void 0&&m!=null&&a(e,["setup","systemInstruction"],xf(ue(m)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let I=$t(g);Array.isArray(I)&&(I=I.map(D=>qf(Vt(D)))),a(e,["setup","tools"],I)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&a(e,["setup","sessionResumption"],Hf(y));const v=s(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&a(e,["setup","inputAudioTranscription"],Ws());const x=s(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&a(e,["setup","outputAudioTranscription"],Ws());const C=s(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&a(e,["setup","realtimeInputConfig"],Zf(C));const T=s(t,["contextWindowCompression"]);e!==void 0&&T!=null&&a(e,["setup","contextWindowCompression"],jf(T));const w=s(t,["proactivity"]);return e!==void 0&&w!=null&&a(e,["setup","proactivity"],th(w)),n}function oh(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["setup","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],nh(o,n)),n}function sh(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["setup","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],ih(o,n)),n}function rh(){return{}}function ah(){return{}}function lh(){return{}}function uh(){return{}}function ch(t){const e={},n=s(t,["media"]);n!=null&&a(e,["mediaChunks"],$a(n));const i=s(t,["audio"]);i!=null&&a(e,["audio"],kc(i));const o=s(t,["audioStreamEnd"]);o!=null&&a(e,["audioStreamEnd"],o);const r=s(t,["video"]);r!=null&&a(e,["video"],Pc(r));const l=s(t,["text"]);return l!=null&&a(e,["text"],l),s(t,["activityStart"])!=null&&a(e,["activityStart"],rh()),s(t,["activityEnd"])!=null&&a(e,["activityEnd"],lh()),e}function dh(t){const e={},n=s(t,["media"]);if(n!=null&&a(e,["mediaChunks"],$a(n)),s(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=s(t,["audioStreamEnd"]);if(i!=null&&a(e,["audioStreamEnd"],i),s(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(s(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return s(t,["activityStart"])!=null&&a(e,["activityStart"],ah()),s(t,["activityEnd"])!=null&&a(e,["activityEnd"],uh()),e}function Za(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["weight"]);return i!=null&&a(e,["weight"],i),e}function fh(t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Za(o))),a(e,["weightedPrompts"],i)}return e}function za(t){const e={},n=s(t,["temperature"]);n!=null&&a(e,["temperature"],n);const i=s(t,["topK"]);i!=null&&a(e,["topK"],i);const o=s(t,["seed"]);o!=null&&a(e,["seed"],o);const r=s(t,["guidance"]);r!=null&&a(e,["guidance"],r);const l=s(t,["bpm"]);l!=null&&a(e,["bpm"],l);const u=s(t,["density"]);u!=null&&a(e,["density"],u);const d=s(t,["brightness"]);d!=null&&a(e,["brightness"],d);const c=s(t,["scale"]);c!=null&&a(e,["scale"],c);const f=s(t,["muteBass"]);f!=null&&a(e,["muteBass"],f);const h=s(t,["muteDrums"]);h!=null&&a(e,["muteDrums"],h);const p=s(t,["onlyBassAndDrums"]);return p!=null&&a(e,["onlyBassAndDrums"],p),e}function hh(t){const e={},n=s(t,["musicGenerationConfig"]);return n!=null&&a(e,["musicGenerationConfig"],za(n)),e}function Xa(t){const e={},n=s(t,["model"]);return n!=null&&a(e,["model"],n),e}function Qa(t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Za(o))),a(e,["weightedPrompts"],i)}return e}function xi(t){const e={},n=s(t,["setup"]);n!=null&&a(e,["setup"],Xa(n));const i=s(t,["clientContent"]);i!=null&&a(e,["clientContent"],Qa(i));const o=s(t,["musicGenerationConfig"]);o!=null&&a(e,["musicGenerationConfig"],za(o));const r=s(t,["playbackControl"]);return r!=null&&a(e,["playbackControl"],r),e}function ph(){return{}}function mh(){return{}}function gh(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function yh(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function _h(t){const e={},n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function vh(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Ch(t){const e={},n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Th(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function wh(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],gh(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],_h(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Ch(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Sh(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],yh(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],vh(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Th(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Ah(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>wh(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function xh(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Sh(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Ks(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["finished"]);return i!=null&&a(e,["finished"],i),e}function Ys(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["finished"]);return i!=null&&a(e,["finished"],i),e}function Eh(t){const e={},n=s(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const i=s(t,["urlRetrievalStatus"]);return i!=null&&a(e,["urlRetrievalStatus"],i),e}function Ih(t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Eh(o))),a(e,["urlMetadata"],i)}return e}function Mh(t){const e={},n=s(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],Ah(n));const i=s(t,["turnComplete"]);i!=null&&a(e,["turnComplete"],i);const o=s(t,["interrupted"]);o!=null&&a(e,["interrupted"],o);const r=s(t,["groundingMetadata"]);r!=null&&a(e,["groundingMetadata"],r);const l=s(t,["generationComplete"]);l!=null&&a(e,["generationComplete"],l);const u=s(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],Ks(u));const d=s(t,["outputTranscription"]);d!=null&&a(e,["outputTranscription"],Ks(d));const c=s(t,["urlContextMetadata"]);return c!=null&&a(e,["urlContextMetadata"],Ih(c)),e}function Rh(t){const e={},n=s(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],xh(n));const i=s(t,["turnComplete"]);i!=null&&a(e,["turnComplete"],i);const o=s(t,["interrupted"]);o!=null&&a(e,["interrupted"],o);const r=s(t,["groundingMetadata"]);r!=null&&a(e,["groundingMetadata"],r);const l=s(t,["generationComplete"]);l!=null&&a(e,["generationComplete"],l);const u=s(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],Ys(u));const d=s(t,["outputTranscription"]);return d!=null&&a(e,["outputTranscription"],Ys(d)),e}function Ph(t){const e={},n=s(t,["id"]);n!=null&&a(e,["id"],n);const i=s(t,["args"]);i!=null&&a(e,["args"],i);const o=s(t,["name"]);return o!=null&&a(e,["name"],o),e}function kh(t){const e={},n=s(t,["args"]);n!=null&&a(e,["args"],n);const i=s(t,["name"]);return i!=null&&a(e,["name"],i),e}function Nh(t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Ph(o))),a(e,["functionCalls"],i)}return e}function bh(t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>kh(o))),a(e,["functionCalls"],i)}return e}function Dh(t){const e={},n=s(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function Fh(t){const e={},n=s(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function Zt(t){const e={},n=s(t,["modality"]);n!=null&&a(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&a(e,["tokenCount"],i),e}function zt(t){const e={},n=s(t,["modality"]);n!=null&&a(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&a(e,["tokenCount"],i),e}function Lh(t){const e={},n=s(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&a(e,["cachedContentTokenCount"],i);const o=s(t,["responseTokenCount"]);o!=null&&a(e,["responseTokenCount"],o);const r=s(t,["toolUsePromptTokenCount"]);r!=null&&a(e,["toolUsePromptTokenCount"],r);const l=s(t,["thoughtsTokenCount"]);l!=null&&a(e,["thoughtsTokenCount"],l);const u=s(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const d=s(t,["promptTokensDetails"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>Zt(m))),a(e,["promptTokensDetails"],p)}const c=s(t,["cacheTokensDetails"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>Zt(m))),a(e,["cacheTokensDetails"],p)}const f=s(t,["responseTokensDetails"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>Zt(m))),a(e,["responseTokensDetails"],p)}const h=s(t,["toolUsePromptTokensDetails"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Zt(m))),a(e,["toolUsePromptTokensDetails"],p)}return e}function Uh(t){const e={},n=s(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&a(e,["cachedContentTokenCount"],i);const o=s(t,["candidatesTokenCount"]);o!=null&&a(e,["responseTokenCount"],o);const r=s(t,["toolUsePromptTokenCount"]);r!=null&&a(e,["toolUsePromptTokenCount"],r);const l=s(t,["thoughtsTokenCount"]);l!=null&&a(e,["thoughtsTokenCount"],l);const u=s(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const d=s(t,["promptTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>zt(g))),a(e,["promptTokensDetails"],m)}const c=s(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>zt(g))),a(e,["cacheTokensDetails"],m)}const f=s(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>zt(g))),a(e,["responseTokensDetails"],m)}const h=s(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>zt(g))),a(e,["toolUsePromptTokensDetails"],m)}const p=s(t,["trafficType"]);return p!=null&&a(e,["trafficType"],p),e}function Vh(t){const e={},n=s(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function $h(t){const e={},n=s(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function Bh(t){const e={},n=s(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&a(e,["resumable"],i);const o=s(t,["lastConsumedClientMessageIndex"]);return o!=null&&a(e,["lastConsumedClientMessageIndex"],o),e}function Oh(t){const e={},n=s(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&a(e,["resumable"],i);const o=s(t,["lastConsumedClientMessageIndex"]);return o!=null&&a(e,["lastConsumedClientMessageIndex"],o),e}function Gh(t){const e={};s(t,["setupComplete"])!=null&&a(e,["setupComplete"],ph());const i=s(t,["serverContent"]);i!=null&&a(e,["serverContent"],Mh(i));const o=s(t,["toolCall"]);o!=null&&a(e,["toolCall"],Nh(o));const r=s(t,["toolCallCancellation"]);r!=null&&a(e,["toolCallCancellation"],Dh(r));const l=s(t,["usageMetadata"]);l!=null&&a(e,["usageMetadata"],Lh(l));const u=s(t,["goAway"]);u!=null&&a(e,["goAway"],Vh(u));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&a(e,["sessionResumptionUpdate"],Bh(d)),e}function qh(t){const e={};s(t,["setupComplete"])!=null&&a(e,["setupComplete"],mh());const i=s(t,["serverContent"]);i!=null&&a(e,["serverContent"],Rh(i));const o=s(t,["toolCall"]);o!=null&&a(e,["toolCall"],bh(o));const r=s(t,["toolCallCancellation"]);r!=null&&a(e,["toolCallCancellation"],Fh(r));const l=s(t,["usageMetadata"]);l!=null&&a(e,["usageMetadata"],Uh(l));const u=s(t,["goAway"]);u!=null&&a(e,["goAway"],$h(u));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&a(e,["sessionResumptionUpdate"],Oh(d)),e}function Jh(){return{}}function Hh(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["weight"]);return i!=null&&a(e,["weight"],i),e}function Wh(t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Hh(o))),a(e,["weightedPrompts"],i)}return e}function Kh(t){const e={},n=s(t,["temperature"]);n!=null&&a(e,["temperature"],n);const i=s(t,["topK"]);i!=null&&a(e,["topK"],i);const o=s(t,["seed"]);o!=null&&a(e,["seed"],o);const r=s(t,["guidance"]);r!=null&&a(e,["guidance"],r);const l=s(t,["bpm"]);l!=null&&a(e,["bpm"],l);const u=s(t,["density"]);u!=null&&a(e,["density"],u);const d=s(t,["brightness"]);d!=null&&a(e,["brightness"],d);const c=s(t,["scale"]);c!=null&&a(e,["scale"],c);const f=s(t,["muteBass"]);f!=null&&a(e,["muteBass"],f);const h=s(t,["muteDrums"]);h!=null&&a(e,["muteDrums"],h);const p=s(t,["onlyBassAndDrums"]);return p!=null&&a(e,["onlyBassAndDrums"],p),e}function Yh(t){const e={},n=s(t,["clientContent"]);n!=null&&a(e,["clientContent"],Wh(n));const i=s(t,["musicGenerationConfig"]);return i!=null&&a(e,["musicGenerationConfig"],Kh(i)),e}function Zh(t){const e={},n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);i!=null&&a(e,["mimeType"],i);const o=s(t,["sourceMetadata"]);return o!=null&&a(e,["sourceMetadata"],Yh(o)),e}function zh(t){const e={},n=s(t,["audioChunks"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Zh(o))),a(e,["audioChunks"],i)}return e}function Xh(t){const e={},n=s(t,["text"]);n!=null&&a(e,["text"],n);const i=s(t,["filteredReason"]);return i!=null&&a(e,["filteredReason"],i),e}function Qh(t){const e={};s(t,["setupComplete"])!=null&&a(e,["setupComplete"],Jh());const i=s(t,["serverContent"]);i!=null&&a(e,["serverContent"],zh(i));const o=s(t,["filteredPrompt"]);return o!=null&&a(e,["filteredPrompt"],Xh(o)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jh(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function ep(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function tp(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function np(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],jh(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],ep(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],tp(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function $n(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>np(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function ip(t){const e={},n=s(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const i=s(t,["default"]);i!=null&&a(e,["default"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["enum"]);r!=null&&a(e,["enum"],r);const l=s(t,["example"]);l!=null&&a(e,["example"],l);const u=s(t,["format"]);u!=null&&a(e,["format"],u);const d=s(t,["items"]);d!=null&&a(e,["items"],d);const c=s(t,["maxItems"]);c!=null&&a(e,["maxItems"],c);const f=s(t,["maxLength"]);f!=null&&a(e,["maxLength"],f);const h=s(t,["maxProperties"]);h!=null&&a(e,["maxProperties"],h);const p=s(t,["maximum"]);p!=null&&a(e,["maximum"],p);const m=s(t,["minItems"]);m!=null&&a(e,["minItems"],m);const g=s(t,["minLength"]);g!=null&&a(e,["minLength"],g);const y=s(t,["minProperties"]);y!=null&&a(e,["minProperties"],y);const v=s(t,["minimum"]);v!=null&&a(e,["minimum"],v);const x=s(t,["nullable"]);x!=null&&a(e,["nullable"],x);const C=s(t,["pattern"]);C!=null&&a(e,["pattern"],C);const T=s(t,["properties"]);T!=null&&a(e,["properties"],T);const w=s(t,["propertyOrdering"]);w!=null&&a(e,["propertyOrdering"],w);const I=s(t,["required"]);I!=null&&a(e,["required"],I);const D=s(t,["title"]);D!=null&&a(e,["title"],D);const A=s(t,["type"]);return A!=null&&a(e,["type"],A),e}function op(t){const e={};if(s(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(t,["category"]);n!=null&&a(e,["category"],n);const i=s(t,["threshold"]);return i!=null&&a(e,["threshold"],i),e}function sp(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function rp(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function ap(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],rp(n)),e}function lp(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function up(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],lp(n)),e}function cp(){return{}}function dp(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>sp(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],ap(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],up(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],cp());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function fp(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function hp(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function pp(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],hp(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function mp(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],fp(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],pp(i)),e}function gp(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function ja(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],gp(n)),e}function yp(t){const e={},n=s(t,["speaker"]);n!=null&&a(e,["speaker"],n);const i=s(t,["voiceConfig"]);return i!=null&&a(e,["voiceConfig"],ja(i)),e}function _p(t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>yp(o))),a(e,["speakerVoiceConfigs"],i)}return e}function vp(t){const e={},n=s(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],ja(n));const i=s(t,["multiSpeakerVoiceConfig"]);i!=null&&a(e,["multiSpeakerVoiceConfig"],_p(i));const o=s(t,["languageCode"]);return o!=null&&a(e,["languageCode"],o),e}function Cp(t){const e={},n=s(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&a(e,["thinkingBudget"],i),e}function Tp(t,e,n){const i={},o=s(e,["systemInstruction"]);n!==void 0&&o!=null&&a(n,["systemInstruction"],$n(ue(o)));const r=s(e,["temperature"]);r!=null&&a(i,["temperature"],r);const l=s(e,["topP"]);l!=null&&a(i,["topP"],l);const u=s(e,["topK"]);u!=null&&a(i,["topK"],u);const d=s(e,["candidateCount"]);d!=null&&a(i,["candidateCount"],d);const c=s(e,["maxOutputTokens"]);c!=null&&a(i,["maxOutputTokens"],c);const f=s(e,["stopSequences"]);f!=null&&a(i,["stopSequences"],f);const h=s(e,["responseLogprobs"]);h!=null&&a(i,["responseLogprobs"],h);const p=s(e,["logprobs"]);p!=null&&a(i,["logprobs"],p);const m=s(e,["presencePenalty"]);m!=null&&a(i,["presencePenalty"],m);const g=s(e,["frequencyPenalty"]);g!=null&&a(i,["frequencyPenalty"],g);const y=s(e,["seed"]);y!=null&&a(i,["seed"],y);const v=s(e,["responseMimeType"]);v!=null&&a(i,["responseMimeType"],v);const x=s(e,["responseSchema"]);if(x!=null&&a(i,["responseSchema"],ip(En(x))),s(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=s(e,["safetySettings"]);if(n!==void 0&&C!=null){let N=C;Array.isArray(N)&&(N=N.map(G=>op(G))),a(n,["safetySettings"],N)}const T=s(e,["tools"]);if(n!==void 0&&T!=null){let N=$t(T);Array.isArray(N)&&(N=N.map(G=>dp(Vt(G)))),a(n,["tools"],N)}const w=s(e,["toolConfig"]);if(n!==void 0&&w!=null&&a(n,["toolConfig"],mp(w)),s(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=s(e,["cachedContent"]);n!==void 0&&I!=null&&a(n,["cachedContent"],Ve(t,I));const D=s(e,["responseModalities"]);D!=null&&a(i,["responseModalities"],D);const A=s(e,["mediaResolution"]);A!=null&&a(i,["mediaResolution"],A);const U=s(e,["speechConfig"]);if(U!=null&&a(i,["speechConfig"],vp(Ga(U))),s(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=s(e,["thinkingConfig"]);return R!=null&&a(i,["thinkingConfig"],Cp(R)),i}function Zs(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=ve(o);Array.isArray(l)&&(l=l.map(u=>$n(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["generationConfig"],Tp(t,r,n)),n}function wp(t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&a(e,["requests[]","taskType"],i);const o=s(t,["title"]);e!==void 0&&o!=null&&a(e,["requests[]","title"],o);const r=s(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&a(e,["requests[]","outputDimensionality"],r),s(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Sp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);o!=null&&a(n,["requests[]","content"],Oa(t,o));const r=s(e,["config"]);r!=null&&a(n,["config"],wp(r,n));const l=s(e,["model"]);return l!==void 0&&a(n,["requests[]","model"],z(t,l)),n}function Ap(t,e){const n={};if(s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=s(t,["numberOfImages"]);e!==void 0&&i!=null&&a(e,["parameters","sampleCount"],i);const o=s(t,["aspectRatio"]);e!==void 0&&o!=null&&a(e,["parameters","aspectRatio"],o);const r=s(t,["guidanceScale"]);if(e!==void 0&&r!=null&&a(e,["parameters","guidanceScale"],r),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=s(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&a(e,["parameters","safetySetting"],l);const u=s(t,["personGeneration"]);e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u);const d=s(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&a(e,["parameters","includeSafetyAttributes"],d);const c=s(t,["includeRaiReason"]);e!==void 0&&c!=null&&a(e,["parameters","includeRaiReason"],c);const f=s(t,["language"]);e!==void 0&&f!=null&&a(e,["parameters","language"],f);const h=s(t,["outputMimeType"]);e!==void 0&&h!=null&&a(e,["parameters","outputOptions","mimeType"],h);const p=s(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&a(e,["parameters","outputOptions","compressionQuality"],p),s(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function xp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["config"]);return r!=null&&a(n,["config"],Ap(r,n)),n}function Ep(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Ip(t,e,n){const i={},o=s(e,["pageSize"]);n!==void 0&&o!=null&&a(n,["_query","pageSize"],o);const r=s(e,["pageToken"]);n!==void 0&&r!=null&&a(n,["_query","pageToken"],r);const l=s(e,["filter"]);n!==void 0&&l!=null&&a(n,["_query","filter"],l);const u=s(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Ha(t,u)),i}function Mp(t,e){const n={},i=s(e,["config"]);return i!=null&&a(n,["config"],Ip(t,i,n)),n}function Rp(t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);e!==void 0&&o!=null&&a(e,["description"],o);const r=s(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&a(e,["defaultCheckpointId"],r),n}function Pp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Rp(o,n)),n}function kp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Np(t){const e={};if(s(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function bp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=ve(o);Array.isArray(l)&&(l=l.map(u=>$n(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["config"],Np(r)),n}function Dp(t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["imageBytes"]);n!=null&&a(e,["bytesBase64Encoded"],Pe(n));const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Fp(t,e){const n={},i=s(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&a(e,["parameters","sampleCount"],i),s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=s(t,["durationSeconds"]);if(e!==void 0&&o!=null&&a(e,["parameters","durationSeconds"],o),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=s(t,["aspectRatio"]);if(e!==void 0&&r!=null&&a(e,["parameters","aspectRatio"],r),s(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=s(t,["personGeneration"]);if(e!==void 0&&l!=null&&a(e,["parameters","personGeneration"],l),s(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=s(t,["negativePrompt"]);e!==void 0&&u!=null&&a(e,["parameters","negativePrompt"],u);const d=s(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&a(e,["parameters","enhancePrompt"],d),s(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(s(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");return n}function Lp(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["image"]);if(r!=null&&a(n,["instances[0]","image"],Dp(r)),s(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=s(e,["config"]);return l!=null&&a(n,["config"],Fp(l,n)),n}function Up(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Vp(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function $p(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Bp(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Up(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Vp(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],$p(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function ft(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Bp(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Op(t){const e={},n=s(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const i=s(t,["default"]);i!=null&&a(e,["default"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["enum"]);r!=null&&a(e,["enum"],r);const l=s(t,["example"]);l!=null&&a(e,["example"],l);const u=s(t,["format"]);u!=null&&a(e,["format"],u);const d=s(t,["items"]);d!=null&&a(e,["items"],d);const c=s(t,["maxItems"]);c!=null&&a(e,["maxItems"],c);const f=s(t,["maxLength"]);f!=null&&a(e,["maxLength"],f);const h=s(t,["maxProperties"]);h!=null&&a(e,["maxProperties"],h);const p=s(t,["maximum"]);p!=null&&a(e,["maximum"],p);const m=s(t,["minItems"]);m!=null&&a(e,["minItems"],m);const g=s(t,["minLength"]);g!=null&&a(e,["minLength"],g);const y=s(t,["minProperties"]);y!=null&&a(e,["minProperties"],y);const v=s(t,["minimum"]);v!=null&&a(e,["minimum"],v);const x=s(t,["nullable"]);x!=null&&a(e,["nullable"],x);const C=s(t,["pattern"]);C!=null&&a(e,["pattern"],C);const T=s(t,["properties"]);T!=null&&a(e,["properties"],T);const w=s(t,["propertyOrdering"]);w!=null&&a(e,["propertyOrdering"],w);const I=s(t,["required"]);I!=null&&a(e,["required"],I);const D=s(t,["title"]);D!=null&&a(e,["title"],D);const A=s(t,["type"]);return A!=null&&a(e,["type"],A),e}function Gp(t){const e={},n=s(t,["featureSelectionPreference"]);return n!=null&&a(e,["featureSelectionPreference"],n),e}function qp(t){const e={},n=s(t,["method"]);n!=null&&a(e,["method"],n);const i=s(t,["category"]);i!=null&&a(e,["category"],i);const o=s(t,["threshold"]);return o!=null&&a(e,["threshold"],o),e}function Jp(t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&a(e,["description"],n);const i=s(t,["name"]);i!=null&&a(e,["name"],i);const o=s(t,["parameters"]);o!=null&&a(e,["parameters"],o);const r=s(t,["parametersJsonSchema"]);r!=null&&a(e,["parametersJsonSchema"],r);const l=s(t,["response"]);l!=null&&a(e,["response"],l);const u=s(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function Hp(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function Wp(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Hp(n)),e}function Kp(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function Yp(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Kp(n)),e}function Zp(){return{}}function zp(t){const e={},n=s(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function Xp(t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],zp(n));const i=s(t,["authType"]);i!=null&&a(e,["authType"],i);const o=s(t,["googleServiceAccountConfig"]);o!=null&&a(e,["googleServiceAccountConfig"],o);const r=s(t,["httpBasicAuthConfig"]);r!=null&&a(e,["httpBasicAuthConfig"],r);const l=s(t,["oauthConfig"]);l!=null&&a(e,["oauthConfig"],l);const u=s(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function Qp(t){const e={},n=s(t,["authConfig"]);return n!=null&&a(e,["authConfig"],Xp(n)),e}function jp(){return{}}function el(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>Jp(h))),a(e,["functionDeclarations"],f)}const i=s(t,["retrieval"]);i!=null&&a(e,["retrieval"],i);const o=s(t,["googleSearch"]);o!=null&&a(e,["googleSearch"],Wp(o));const r=s(t,["googleSearchRetrieval"]);r!=null&&a(e,["googleSearchRetrieval"],Yp(r)),s(t,["enterpriseWebSearch"])!=null&&a(e,["enterpriseWebSearch"],Zp());const u=s(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],Qp(u)),s(t,["urlContext"])!=null&&a(e,["urlContext"],jp());const c=s(t,["codeExecution"]);return c!=null&&a(e,["codeExecution"],c),e}function em(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&a(e,["allowedFunctionNames"],i),e}function tm(t){const e={},n=s(t,["latitude"]);n!=null&&a(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&a(e,["longitude"],i),e}function nm(t){const e={},n=s(t,["latLng"]);n!=null&&a(e,["latLng"],tm(n));const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function im(t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],em(n));const i=s(t,["retrievalConfig"]);return i!=null&&a(e,["retrievalConfig"],nm(i)),e}function om(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function sm(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],om(n)),e}function rm(t){const e={},n=s(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],sm(n)),s(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=s(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function am(t){const e={},n=s(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&a(e,["thinkingBudget"],i),e}function lm(t,e,n){const i={},o=s(e,["systemInstruction"]);n!==void 0&&o!=null&&a(n,["systemInstruction"],ft(ue(o)));const r=s(e,["temperature"]);r!=null&&a(i,["temperature"],r);const l=s(e,["topP"]);l!=null&&a(i,["topP"],l);const u=s(e,["topK"]);u!=null&&a(i,["topK"],u);const d=s(e,["candidateCount"]);d!=null&&a(i,["candidateCount"],d);const c=s(e,["maxOutputTokens"]);c!=null&&a(i,["maxOutputTokens"],c);const f=s(e,["stopSequences"]);f!=null&&a(i,["stopSequences"],f);const h=s(e,["responseLogprobs"]);h!=null&&a(i,["responseLogprobs"],h);const p=s(e,["logprobs"]);p!=null&&a(i,["logprobs"],p);const m=s(e,["presencePenalty"]);m!=null&&a(i,["presencePenalty"],m);const g=s(e,["frequencyPenalty"]);g!=null&&a(i,["frequencyPenalty"],g);const y=s(e,["seed"]);y!=null&&a(i,["seed"],y);const v=s(e,["responseMimeType"]);v!=null&&a(i,["responseMimeType"],v);const x=s(e,["responseSchema"]);x!=null&&a(i,["responseSchema"],Op(En(x)));const C=s(e,["routingConfig"]);C!=null&&a(i,["routingConfig"],C);const T=s(e,["modelSelectionConfig"]);T!=null&&a(i,["modelConfig"],Gp(T));const w=s(e,["safetySettings"]);if(n!==void 0&&w!=null){let fe=w;Array.isArray(fe)&&(fe=fe.map(Ne=>qp(Ne))),a(n,["safetySettings"],fe)}const I=s(e,["tools"]);if(n!==void 0&&I!=null){let fe=$t(I);Array.isArray(fe)&&(fe=fe.map(Ne=>el(Vt(Ne)))),a(n,["tools"],fe)}const D=s(e,["toolConfig"]);n!==void 0&&D!=null&&a(n,["toolConfig"],im(D));const A=s(e,["labels"]);n!==void 0&&A!=null&&a(n,["labels"],A);const U=s(e,["cachedContent"]);n!==void 0&&U!=null&&a(n,["cachedContent"],Ve(t,U));const R=s(e,["responseModalities"]);R!=null&&a(i,["responseModalities"],R);const N=s(e,["mediaResolution"]);N!=null&&a(i,["mediaResolution"],N);const G=s(e,["speechConfig"]);G!=null&&a(i,["speechConfig"],rm(Ga(G)));const ie=s(e,["audioTimestamp"]);ie!=null&&a(i,["audioTimestamp"],ie);const ke=s(e,["thinkingConfig"]);return ke!=null&&a(i,["thinkingConfig"],am(ke)),i}function zs(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=ve(o);Array.isArray(l)&&(l=l.map(u=>ft(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["generationConfig"],lm(t,r,n)),n}function um(t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&a(e,["instances[]","task_type"],i);const o=s(t,["title"]);e!==void 0&&o!=null&&a(e,["instances[]","title"],o);const r=s(t,["outputDimensionality"]);e!==void 0&&r!=null&&a(e,["parameters","outputDimensionality"],r);const l=s(t,["mimeType"]);e!==void 0&&l!=null&&a(e,["instances[]","mimeType"],l);const u=s(t,["autoTruncate"]);return e!==void 0&&u!=null&&a(e,["parameters","autoTruncate"],u),n}function cm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);o!=null&&a(n,["instances[]","content"],Oa(t,o));const r=s(e,["config"]);return r!=null&&a(n,["config"],um(r,n)),n}function dm(t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const o=s(t,["negativePrompt"]);e!==void 0&&o!=null&&a(e,["parameters","negativePrompt"],o);const r=s(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const u=s(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const d=s(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const c=s(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const f=s(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=s(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&a(e,["parameters","includeSafetyAttributes"],h);const p=s(t,["includeRaiReason"]);e!==void 0&&p!=null&&a(e,["parameters","includeRaiReason"],p);const m=s(t,["language"]);e!==void 0&&m!=null&&a(e,["parameters","language"],m);const g=s(t,["outputMimeType"]);e!==void 0&&g!=null&&a(e,["parameters","outputOptions","mimeType"],g);const y=s(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&a(e,["parameters","outputOptions","compressionQuality"],y);const v=s(t,["addWatermark"]);e!==void 0&&v!=null&&a(e,["parameters","addWatermark"],v);const x=s(t,["enhancePrompt"]);return e!==void 0&&x!=null&&a(e,["parameters","enhancePrompt"],x),n}function fm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["config"]);return r!=null&&a(n,["config"],dm(r,n)),n}function Bn(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const i=s(t,["imageBytes"]);i!=null&&a(e,["bytesBase64Encoded"],Pe(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function hm(t){const e={},n=s(t,["maskMode"]);n!=null&&a(e,["maskMode"],n);const i=s(t,["segmentationClasses"]);i!=null&&a(e,["maskClasses"],i);const o=s(t,["maskDilation"]);return o!=null&&a(e,["dilation"],o),e}function pm(t){const e={},n=s(t,["controlType"]);n!=null&&a(e,["controlType"],n);const i=s(t,["enableControlImageComputation"]);return i!=null&&a(e,["computeControl"],i),e}function mm(t){const e={},n=s(t,["styleDescription"]);return n!=null&&a(e,["styleDescription"],n),e}function gm(t){const e={},n=s(t,["subjectType"]);n!=null&&a(e,["subjectType"],n);const i=s(t,["subjectDescription"]);return i!=null&&a(e,["subjectDescription"],i),e}function ym(t){const e={},n=s(t,["referenceImage"]);n!=null&&a(e,["referenceImage"],Bn(n));const i=s(t,["referenceId"]);i!=null&&a(e,["referenceId"],i);const o=s(t,["referenceType"]);o!=null&&a(e,["referenceType"],o);const r=s(t,["maskImageConfig"]);r!=null&&a(e,["maskImageConfig"],hm(r));const l=s(t,["controlImageConfig"]);l!=null&&a(e,["controlImageConfig"],pm(l));const u=s(t,["styleImageConfig"]);u!=null&&a(e,["styleImageConfig"],mm(u));const d=s(t,["subjectImageConfig"]);return d!=null&&a(e,["subjectImageConfig"],gm(d)),e}function _m(t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const o=s(t,["negativePrompt"]);e!==void 0&&o!=null&&a(e,["parameters","negativePrompt"],o);const r=s(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const u=s(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const d=s(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const c=s(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const f=s(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=s(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&a(e,["parameters","includeSafetyAttributes"],h);const p=s(t,["includeRaiReason"]);e!==void 0&&p!=null&&a(e,["parameters","includeRaiReason"],p);const m=s(t,["language"]);e!==void 0&&m!=null&&a(e,["parameters","language"],m);const g=s(t,["outputMimeType"]);e!==void 0&&g!=null&&a(e,["parameters","outputOptions","mimeType"],g);const y=s(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&a(e,["parameters","outputOptions","compressionQuality"],y);const v=s(t,["editMode"]);e!==void 0&&v!=null&&a(e,["parameters","editMode"],v);const x=s(t,["baseSteps"]);return e!==void 0&&x!=null&&a(e,["parameters","editConfig","baseSteps"],x),n}function vm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["referenceImages"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>ym(d))),a(n,["instances[0]","referenceImages"],u)}const l=s(e,["config"]);return l!=null&&a(n,["config"],_m(l,n)),n}function Cm(t,e){const n={},i=s(t,["includeRaiReason"]);e!==void 0&&i!=null&&a(e,["parameters","includeRaiReason"],i);const o=s(t,["outputMimeType"]);e!==void 0&&o!=null&&a(e,["parameters","outputOptions","mimeType"],o);const r=s(t,["outputCompressionQuality"]);e!==void 0&&r!=null&&a(e,["parameters","outputOptions","compressionQuality"],r);const l=s(t,["numberOfImages"]);e!==void 0&&l!=null&&a(e,["parameters","sampleCount"],l);const u=s(t,["mode"]);return e!==void 0&&u!=null&&a(e,["parameters","mode"],u),n}function Tm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["image"]);o!=null&&a(n,["instances[0]","image"],Bn(o));const r=s(e,["upscaleFactor"]);r!=null&&a(n,["parameters","upscaleConfig","upscaleFactor"],r);const l=s(e,["config"]);return l!=null&&a(n,["config"],Cm(l,n)),n}function wm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Sm(t,e,n){const i={},o=s(e,["pageSize"]);n!==void 0&&o!=null&&a(n,["_query","pageSize"],o);const r=s(e,["pageToken"]);n!==void 0&&r!=null&&a(n,["_query","pageToken"],r);const l=s(e,["filter"]);n!==void 0&&l!=null&&a(n,["_query","filter"],l);const u=s(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Ha(t,u)),i}function Am(t,e){const n={},i=s(e,["config"]);return i!=null&&a(n,["config"],Sm(t,i,n)),n}function xm(t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);e!==void 0&&o!=null&&a(e,["description"],o);const r=s(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&a(e,["defaultCheckpointId"],r),n}function Em(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],xm(o,n)),n}function Im(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","name"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],o),n}function Mm(t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&a(e,["systemInstruction"],ft(ue(i)));const o=s(t,["tools"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>el(u))),a(e,["tools"],l)}const r=s(t,["generationConfig"]);return e!==void 0&&r!=null&&a(e,["generationConfig"],r),n}function Rm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=ve(o);Array.isArray(l)&&(l=l.map(u=>ft(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["config"],Mm(r,n)),n}function Pm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["contents"]);if(o!=null){let l=ve(o);Array.isArray(l)&&(l=l.map(u=>ft(u))),a(n,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(n,["config"],r),n}function km(t){const e={},n=s(t,["uri"]);n!=null&&a(e,["gcsUri"],n);const i=s(t,["videoBytes"]);i!=null&&a(e,["bytesBase64Encoded"],Pe(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Nm(t,e){const n={},i=s(t,["numberOfVideos"]);e!==void 0&&i!=null&&a(e,["parameters","sampleCount"],i);const o=s(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const r=s(t,["fps"]);e!==void 0&&r!=null&&a(e,["parameters","fps"],r);const l=s(t,["durationSeconds"]);e!==void 0&&l!=null&&a(e,["parameters","durationSeconds"],l);const u=s(t,["seed"]);e!==void 0&&u!=null&&a(e,["parameters","seed"],u);const d=s(t,["aspectRatio"]);e!==void 0&&d!=null&&a(e,["parameters","aspectRatio"],d);const c=s(t,["resolution"]);e!==void 0&&c!=null&&a(e,["parameters","resolution"],c);const f=s(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=s(t,["pubsubTopic"]);e!==void 0&&h!=null&&a(e,["parameters","pubsubTopic"],h);const p=s(t,["negativePrompt"]);e!==void 0&&p!=null&&a(e,["parameters","negativePrompt"],p);const m=s(t,["enhancePrompt"]);e!==void 0&&m!=null&&a(e,["parameters","enhancePrompt"],m);const g=s(t,["generateAudio"]);e!==void 0&&g!=null&&a(e,["parameters","generateAudio"],g);const y=s(t,["lastFrame"]);return e!==void 0&&y!=null&&a(e,["instances[0]","lastFrame"],Bn(y)),n}function bm(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["_url","model"],z(t,i));const o=s(e,["prompt"]);o!=null&&a(n,["instances[0]","prompt"],o);const r=s(e,["image"]);r!=null&&a(n,["instances[0]","image"],Bn(r));const l=s(e,["video"]);l!=null&&a(n,["instances[0]","video"],km(l));const u=s(e,["config"]);return u!=null&&a(n,["config"],Nm(u,n)),n}function Dm(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function Fm(t){const e={},n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Lm(t){const e={},n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Um(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Dm(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],Fm(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Lm(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function Vm(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Um(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function $m(t){const e={},n=s(t,["citationSources"]);return n!=null&&a(e,["citations"],n),e}function Bm(t){const e={},n=s(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const i=s(t,["urlRetrievalStatus"]);return i!=null&&a(e,["urlRetrievalStatus"],i),e}function Om(t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Bm(o))),a(e,["urlMetadata"],i)}return e}function Gm(t){const e={},n=s(t,["content"]);n!=null&&a(e,["content"],Vm(n));const i=s(t,["citationMetadata"]);i!=null&&a(e,["citationMetadata"],$m(i));const o=s(t,["tokenCount"]);o!=null&&a(e,["tokenCount"],o);const r=s(t,["finishReason"]);r!=null&&a(e,["finishReason"],r);const l=s(t,["urlContextMetadata"]);l!=null&&a(e,["urlContextMetadata"],Om(l));const u=s(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const d=s(t,["groundingMetadata"]);d!=null&&a(e,["groundingMetadata"],d);const c=s(t,["index"]);c!=null&&a(e,["index"],c);const f=s(t,["logprobsResult"]);f!=null&&a(e,["logprobsResult"],f);const h=s(t,["safetyRatings"]);return h!=null&&a(e,["safetyRatings"],h),e}function Xs(t){const e={},n=s(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Gm(u))),a(e,["candidates"],l)}const i=s(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const o=s(t,["promptFeedback"]);o!=null&&a(e,["promptFeedback"],o);const r=s(t,["usageMetadata"]);return r!=null&&a(e,["usageMetadata"],r),e}function qm(t){const e={},n=s(t,["values"]);return n!=null&&a(e,["values"],n),e}function Jm(){return{}}function Hm(t){const e={},n=s(t,["embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>qm(r))),a(e,["embeddings"],o)}return s(t,["metadata"])!=null&&a(e,["metadata"],Jm()),e}function Wm(t){const e={},n=s(t,["bytesBase64Encoded"]);n!=null&&a(e,["imageBytes"],Pe(n));const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function tl(t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&a(e,["scores"],i);const o=s(t,["contentType"]);return o!=null&&a(e,["contentType"],o),e}function Km(t){const e={},n=s(t,["_self"]);n!=null&&a(e,["image"],Wm(n));const i=s(t,["raiFilteredReason"]);i!=null&&a(e,["raiFilteredReason"],i);const o=s(t,["_self"]);return o!=null&&a(e,["safetyAttributes"],tl(o)),e}function Ym(t){const e={},n=s(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Km(r))),a(e,["generatedImages"],o)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],tl(i)),e}function Zm(t){const e={},n=s(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=s(t,["updateTime"]);return o!=null&&a(e,["updateTime"],o),e}function Ei(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["version"]);r!=null&&a(e,["version"],r);const l=s(t,["_self"]);l!=null&&a(e,["tunedModelInfo"],Zm(l));const u=s(t,["inputTokenLimit"]);u!=null&&a(e,["inputTokenLimit"],u);const d=s(t,["outputTokenLimit"]);d!=null&&a(e,["outputTokenLimit"],d);const c=s(t,["supportedGenerationMethods"]);return c!=null&&a(e,["supportedActions"],c),e}function zm(t,e){const n={},i=s(e,["nextPageToken"]);i!=null&&a(n,["nextPageToken"],i);const o=s(e,["_self"]);if(o!=null){let r=Wa(o);Array.isArray(r)&&(r=r.map(l=>Ei(l))),a(n,["models"],r)}return n}function Xm(){return{}}function Qm(t){const e={},n=s(t,["totalTokens"]);n!=null&&a(e,["totalTokens"],n);const i=s(t,["cachedContentTokenCount"]);return i!=null&&a(e,["cachedContentTokenCount"],i),e}function jm(t){const e={},n=s(t,["video","uri"]);n!=null&&a(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&a(e,["videoBytes"],Pe(i));const o=s(t,["encoding"]);return o!=null&&a(e,["mimeType"],o),e}function eg(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],jm(n)),e}function tg(t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>eg(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function ng(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response","generateVideoResponse"]);return l!=null&&a(e,["response"],tg(l)),e}function ig(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function og(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["data"]);i!=null&&a(e,["data"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function sg(t){const e={},n=s(t,["displayName"]);n!=null&&a(e,["displayName"],n);const i=s(t,["fileUri"]);i!=null&&a(e,["fileUri"],i);const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function rg(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],ig(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],og(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],sg(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function ag(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>rg(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function lg(t){const e={},n=s(t,["citations"]);return n!=null&&a(e,["citations"],n),e}function ug(t){const e={},n=s(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const i=s(t,["urlRetrievalStatus"]);return i!=null&&a(e,["urlRetrievalStatus"],i),e}function cg(t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>ug(o))),a(e,["urlMetadata"],i)}return e}function dg(t){const e={},n=s(t,["content"]);n!=null&&a(e,["content"],ag(n));const i=s(t,["citationMetadata"]);i!=null&&a(e,["citationMetadata"],lg(i));const o=s(t,["finishMessage"]);o!=null&&a(e,["finishMessage"],o);const r=s(t,["finishReason"]);r!=null&&a(e,["finishReason"],r);const l=s(t,["urlContextMetadata"]);l!=null&&a(e,["urlContextMetadata"],cg(l));const u=s(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const d=s(t,["groundingMetadata"]);d!=null&&a(e,["groundingMetadata"],d);const c=s(t,["index"]);c!=null&&a(e,["index"],c);const f=s(t,["logprobsResult"]);f!=null&&a(e,["logprobsResult"],f);const h=s(t,["safetyRatings"]);return h!=null&&a(e,["safetyRatings"],h),e}function Qs(t){const e={},n=s(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>dg(c))),a(e,["candidates"],d)}const i=s(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=s(t,["responseId"]);o!=null&&a(e,["responseId"],o);const r=s(t,["modelVersion"]);r!=null&&a(e,["modelVersion"],r);const l=s(t,["promptFeedback"]);l!=null&&a(e,["promptFeedback"],l);const u=s(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function fg(t){const e={},n=s(t,["truncated"]);n!=null&&a(e,["truncated"],n);const i=s(t,["token_count"]);return i!=null&&a(e,["tokenCount"],i),e}function hg(t){const e={},n=s(t,["values"]);n!=null&&a(e,["values"],n);const i=s(t,["statistics"]);return i!=null&&a(e,["statistics"],fg(i)),e}function pg(t){const e={},n=s(t,["billableCharacterCount"]);return n!=null&&a(e,["billableCharacterCount"],n),e}function mg(t){const e={},n=s(t,["predictions[]","embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>hg(r))),a(e,["embeddings"],o)}const i=s(t,["metadata"]);return i!=null&&a(e,["metadata"],pg(i)),e}function gg(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&a(e,["imageBytes"],Pe(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function nl(t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&a(e,["scores"],i);const o=s(t,["contentType"]);return o!=null&&a(e,["contentType"],o),e}function to(t){const e={},n=s(t,["_self"]);n!=null&&a(e,["image"],gg(n));const i=s(t,["raiFilteredReason"]);i!=null&&a(e,["raiFilteredReason"],i);const o=s(t,["_self"]);o!=null&&a(e,["safetyAttributes"],nl(o));const r=s(t,["prompt"]);return r!=null&&a(e,["enhancedPrompt"],r),e}function yg(t){const e={},n=s(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>to(r))),a(e,["generatedImages"],o)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],nl(i)),e}function _g(t){const e={},n=s(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>to(o))),a(e,["generatedImages"],i)}return e}function vg(t){const e={},n=s(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>to(o))),a(e,["generatedImages"],i)}return e}function Cg(t){const e={},n=s(t,["endpoint"]);n!=null&&a(e,["name"],n);const i=s(t,["deployedModelId"]);return i!=null&&a(e,["deployedModelId"],i),e}function Tg(t){const e={},n=s(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=s(t,["updateTime"]);return o!=null&&a(e,["updateTime"],o),e}function wg(t){const e={},n=s(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const i=s(t,["epoch"]);i!=null&&a(e,["epoch"],i);const o=s(t,["step"]);return o!=null&&a(e,["step"],o),e}function Ii(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["displayName"]);i!=null&&a(e,["displayName"],i);const o=s(t,["description"]);o!=null&&a(e,["description"],o);const r=s(t,["versionId"]);r!=null&&a(e,["version"],r);const l=s(t,["deployedModels"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>Cg(p))),a(e,["endpoints"],h)}const u=s(t,["labels"]);u!=null&&a(e,["labels"],u);const d=s(t,["_self"]);d!=null&&a(e,["tunedModelInfo"],Tg(d));const c=s(t,["defaultCheckpointId"]);c!=null&&a(e,["defaultCheckpointId"],c);const f=s(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(p=>wg(p))),a(e,["checkpoints"],h)}return e}function Sg(t,e){const n={},i=s(e,["nextPageToken"]);i!=null&&a(n,["nextPageToken"],i);const o=s(e,["_self"]);if(o!=null){let r=Wa(o);Array.isArray(r)&&(r=r.map(l=>Ii(l))),a(n,["models"],r)}return n}function Ag(){return{}}function xg(t){const e={},n=s(t,["totalTokens"]);return n!=null&&a(e,["totalTokens"],n),e}function Eg(t){const e={},n=s(t,["tokensInfo"]);return n!=null&&a(e,["tokensInfo"],n),e}function Ig(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&a(e,["videoBytes"],Pe(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Mg(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],Ig(n)),e}function Rg(t){const e={},n=s(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>Mg(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function Pg(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response"]);return l!=null&&a(e,["response"],Rg(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kg="Content-Type",Ng="X-Server-Timeout",bg="User-Agent",Mi="x-goog-api-client",Dg="1.6.0",Fg=`google-genai-sdk/${Dg}`,Lg="v1beta1",Ug="v1beta",js=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Vg{constructor(e){var n,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Lg,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Ug,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,i){const o=[this.getRequestUrlInternal(n)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,i);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))o.searchParams.append(l,String(u));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,n,e.abortSignal),this.unaryApiCall(o,r,e.httpMethod)}patchHttpOptions(e,n){const i=JSON.parse(JSON.stringify(e));for(const[o,r]of Object.entries(n))typeof r=="object"?i[o]=Object.assign(Object.assign({},i[o]),r):r!==void 0&&(i[o]=r);return i}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,n,e.abortSignal),this.streamApiCall(o,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,i){if(n&&n.timeout||i){const o=new AbortController,r=o.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>o.abort(),n.timeout),i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=r}return n&&n.extraBody!==null&&$g(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await er(o),new wi(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await er(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var n;return it(this,arguments,function*(){const o=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),r=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let l="";for(;;){const{done:u,value:d}=yield X(o.read());if(u){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=r.decode(d);try{const h=JSON.parse(c);if("error"in h){const p=JSON.parse(JSON.stringify(h.error)),m=p.status,g=p.code,y=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<600)throw new Vn({message:y,status:g})}}catch(h){if(h.name==="ApiError")throw h}l+=c;let f=l.match(js);for(;f;){const h=f[1];try{const p=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield X(new wi(p)),l=l.slice(f[0].length),f=l.match(js)}catch(p){throw new Error(`exception parsing stream chunk ${h}. ${p}`)}}}}finally{o.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},n=Fg+" "+this.clientOptions.userAgentExtra;return e[bg]=n,e[Mi]=n,e[kg]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))n.append(i,o);e.timeout&&e.timeout>0&&n.append(Ng,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var i;const o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const r=this.clientOptions.uploader,l=await r.stat(e);o.sizeBytes=String(l.size);const u=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=u;const d=await this.fetchUploadUrl(o,n);return r.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var i;let o={};n!=null&&n.httpOptions?o=n.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const r={file:e},l=await this.request({path:F("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:o});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(i=l==null?void 0:l.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function er(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let i;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await t.json():i={error:{message:await t.text(),code:t.status,status:t.statusText}};const o=JSON.stringify(i);throw n>=400&&n<600?new Vn({message:o,status:n}):new Error(o)}}function $g(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const r=JSON.parse(t.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))n=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,l){const u=Object.assign({},r);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const c=l[d],f=u[d];c&&typeof c=="object"&&!Array.isArray(c)&&f&&typeof f=="object"&&!Array.isArray(f)?u[d]=i(f,c):(f&&c&&typeof f!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof f}, New type: ${typeof c}. Overwriting.`),u[d]=c)}return u}const o=i(n,e);t.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bg="mcp_used/unknown";function il(t){for(const e of t)if(no(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function ol(t){var e;const n=(e=t[Mi])!==null&&e!==void 0?e:"";t[Mi]=(n+` ${Bg}`).trimStart()}function Og(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>no(o)))!==null&&i!==void 0?i:!1}function Gg(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>!no(o)))!==null&&i!==void 0?i:!1}function no(t){return t!==null&&typeof t=="object"&&t instanceof io}function qg(t,e=100){return it(this,arguments,function*(){let i,o=0;for(;o<e;){const r=yield X(t.listTools({cursor:i}));for(const l of r.tools)yield yield X(l),o++;if(!r.nextCursor)break;i=r.nextCursor}})}class io{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new io(e,n)}async initialize(){var e,n,i,o;if(this.mcpTools.length>0)return;const r={},l=[];for(const f of this.mcpClients)try{for(var u=!0,d=(n=void 0,Rt(qg(f))),c;c=await d.next(),e=c.done,!e;u=!0){o=c.value,u=!1;const h=o;l.push(h);const p=h.name;if(r[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);r[p]=f}}catch(h){n={error:h}}finally{try{!u&&!e&&(i=d.return)&&await i.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),Gc(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const l=await o.callTool({name:i.name,arguments:i.args},void 0,r);n.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Jg(t,e,n){const i=new Rc;let o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data);const r=Qh(o);Object.assign(i,r),e(i)}class Hg{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i}async connect(e){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),l=Yg(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${o}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const f=new Promise(T=>{c=T}),h=e.callbacks,p=function(){c({})},m=this.apiClient,g={onopen:p,onmessage:T=>{Jg(m,h.onmessage,T)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(T){},onclose:(i=h==null?void 0:h.onclose)!==null&&i!==void 0?i:function(T){}},y=this.webSocketFactory.create(d,Kg(l),g);y.connect(),await f;const v=z(this.apiClient,e.model),x=Xa({model:v}),C=xi({setup:x});return y.send(JSON.stringify(C)),new Wg(y,this.apiClient)}}class Wg{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=fh(e),i=Qa(n);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=hh(e),i=xi(n);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const n=xi({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(tt.PLAY)}pause(){this.sendPlaybackControl(tt.PAUSE)}stop(){this.sendPlaybackControl(tt.STOP)}resetContext(){this.sendPlaybackControl(tt.RESET_CONTEXT)}close(){this.conn.close()}}function Kg(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function Yg(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zg="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function zg(t,e,n){const i=new Mc;let o;if(n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),t.isVertexAI()){const r=qh(o);Object.assign(i,r)}else{const r=Gh(o);Object.assign(i,r)}e(i)}class Xg{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i,this.music=new Hg(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,i,o,r,l,u;const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const h=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&il(e.config.tools)&&ol(h);const p=ty(h);if(this.apiClient.isVertexAI())f=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p);else{const R=this.apiClient.getApiKey();let N="BidiGenerateContent",G="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),N="BidiGenerateContentConstrained",G="access_token"),f=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.${N}?${G}=${R}`}let m=()=>{};const g=new Promise(R=>{m=R}),y=e.callbacks,v=function(){var R;(R=y==null?void 0:y.onopen)===null||R===void 0||R.call(y),m({})},x=this.apiClient,C={onopen:v,onmessage:R=>{zg(x,y.onmessage,R)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(R){},onclose:(i=y==null?void 0:y.onclose)!==null&&i!==void 0?i:function(R){}},T=this.webSocketFactory.create(f,ey(p),C);T.connect(),await g;let w=z(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&w.startsWith("publishers/")){const R=this.apiClient.getProject(),N=this.apiClient.getLocation();w=`projects/${R}/locations/${N}/`+w}let I={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[An.AUDIO]}:e.config.responseModalities=[An.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const D=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],A=[];for(const R of D)if(this.isCallableTool(R)){const N=R;A.push(await N.tool())}else A.push(R);A.length>0&&(e.config.tools=A);const U={model:w,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?I=sh(this.apiClient,U):I=oh(this.apiClient,U),delete I.config,T.send(JSON.stringify(I)),new jg(T,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Qg={turnComplete:!0};class jg{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=ve(n.turns),e.isVertexAI()?i=i.map(o=>ft(o)):i=i.map(o=>$n(o))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(Zg)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Qg),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:dh(e)}:n={realtimeInput:ch(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function ey(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function ty(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tr=10;function nr(t){var e,n,i;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(un(l)){o=!0;break}if(!o)return!0;const r=(i=t==null?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function un(t){return"callTool"in t&&typeof t.callTool=="function"}function ir(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ny extends dt{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var i,o,r,l,u;const d=await this.processParamsForMcpUsage(n);if(!Og(n)||nr(n.config))return await this.generateContentInternal(d);if(Gg(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let c,f;const h=ve(d.contents),p=(r=(o=(i=d.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&r!==void 0?r:tr;let m=0;for(;m<p&&(c=await this.generateContentInternal(d),!(!c.functionCalls||c.functionCalls.length===0));){const g=c.candidates[0].content,y=[];for(const v of(u=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(un(v)){const C=await v.callTool(c.functionCalls);y.push(...C)}m++,f={role:"user",parts:y},d.contents=ve(d.contents),d.contents.push(g),d.contents.push(f),ir(d.config)&&(h.push(g),h.push(f))}return ir(d.config)&&(c.automaticFunctionCallingHistory=h),c},this.generateContentStream=async n=>{if(nr(n.config)){const i=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var o;let r;const l=[];if(i!=null&&i.generatedImages)for(const d of i.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((o=d==null?void 0:d.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?r=d==null?void 0:d.safetyAttributes:l.push(d);let u;return r?u={generatedImages:l,positivePromptSafetyAttributes:r}:u={generatedImages:l},u}),this.list=async n=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Un(ut.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(o)}}async processParamsForMcpUsage(e){var n,i,o;const r=(n=e.config)===null||n===void 0?void 0:n.tools;if(!r)return e;const l=await Promise.all(r.map(async d=>un(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&il(e.config.tools)){const d=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let c=Object.assign({},d);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),ol(c),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return u}async initAfcToolsMap(e){var n,i,o;const r=new Map;for(const l of(i=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(un(l)){const u=l,d=await u.tool();for(const c of(o=d.functionDeclarations)!==null&&o!==void 0?o:[]){if(!c.name)throw new Error("Function declaration name is required.");if(r.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);r.set(c.name,u)}}return r}async processAfcStream(e){var n,i,o;const r=(o=(i=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:tr;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return function(c,f,h){var p,m;return it(this,arguments,function*(){for(var g,y,v,x;u<r;){l&&(u++,l=!1);const I=yield X(c.processParamsForMcpUsage(h)),D=yield X(c.generateContentStreamInternal(I)),A=[],U=[];try{for(var C=!0,T=(y=void 0,Rt(D)),w;w=yield X(T.next()),g=w.done,!g;C=!0){x=w.value,C=!1;const R=x;if(yield yield X(R),R.candidates&&(!((p=R.candidates[0])===null||p===void 0)&&p.content)){U.push(R.candidates[0].content);for(const N of(m=R.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(u<r&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(N.functionCall.name)){const G=yield X(f.get(N.functionCall.name).callTool([N.functionCall]));A.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(R){y={error:R}}finally{try{!C&&!g&&(v=T.return)&&(yield X(v.call(T)))}finally{if(y)throw y.error}}if(A.length>0){l=!0;const R=new mt;R.candidates=[{content:{role:"user",parts:A}}],yield yield X(R);const N=[];N.push(...U),N.push({role:"user",parts:A});const G=ve(h.contents).concat(N);h.contents=G}else break}})}(this,d,e)}async generateContentInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=zs(this.apiClient,e);return u=F("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Qs(f),p=new mt;return Object.assign(p,h),p})}else{const c=Zs(this.apiClient,e);return u=F("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Xs(f),p=new mt;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=zs(this.apiClient,e);return u=F("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(h){return it(this,arguments,function*(){var p,m,g,y;try{for(var v=!0,x=Rt(h),C;C=yield X(x.next()),p=C.done,!p;v=!0){y=C.value,v=!1;const w=Qs(yield X(y.json())),I=new mt;Object.assign(I,w),yield yield X(I)}}catch(T){m={error:T}}finally{try{!v&&!p&&(g=x.return)&&(yield X(g.call(x)))}finally{if(m)throw m.error}}})})}else{const c=Zs(this.apiClient,e);return u=F("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(h){return it(this,arguments,function*(){var p,m,g,y;try{for(var v=!0,x=Rt(h),C;C=yield X(x.next()),p=C.done,!p;v=!0){y=C.value,v=!1;const w=Xs(yield X(y.json())),I=new mt;Object.assign(I,w),yield yield X(I)}}catch(T){m={error:T}}finally{try{!v&&!p&&(g=x.return)&&(yield X(g.call(x)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=cm(this.apiClient,e);return u=F("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=mg(f),p=new Rs;return Object.assign(p,h),p})}else{const c=Sp(this.apiClient,e);return u=F("{model}:batchEmbedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Hm(f),p=new Rs;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=fm(this.apiClient,e);return u=F("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=yg(f),p=new Ps;return Object.assign(p,h),p})}else{const c=xp(this.apiClient,e);return u=F("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Ym(f),p=new Ps;return Object.assign(p,h),p})}}async editImageInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=vm(this.apiClient,e);return r=F("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=_g(d),f=new wc;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=Tm(this.apiClient,e);return r=F("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=vg(d),f=new Sc;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=wm(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Ii(f))}else{const c=Ep(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>Ei(f))}}async listInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Am(this.apiClient,e);return u=F("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Sg(this.apiClient,f),p=new ks;return Object.assign(p,h),p})}else{const c=Mp(this.apiClient,e);return u=F("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=zm(this.apiClient,f),p=new ks;return Object.assign(p,h),p})}}async update(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Em(this.apiClient,e);return u=F("{model}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Ii(f))}else{const c=Pp(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>Ei(f))}}async delete(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Im(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Ag(),h=new Ns;return Object.assign(h,f),h})}else{const c=kp(this.apiClient,e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Xm(),h=new Ns;return Object.assign(h,f),h})}}async countTokens(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Rm(this.apiClient,e);return u=F("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=xg(f),p=new bs;return Object.assign(p,h),p})}else{const c=bp(this.apiClient,e);return u=F("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Qm(f),p=new bs;return Object.assign(p,h),p})}}async computeTokens(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=Pm(this.apiClient,e);return r=F("{model}:computeTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const c=Eg(d),f=new Ac;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=bm(this.apiClient,e);return u=F("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Pg(f))}else{const c=Lp(this.apiClient,e);return u=F("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>ng(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iy(t){const e={},n=s(t,["operationName"]);n!=null&&a(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function oy(t){const e={},n=s(t,["operationName"]);n!=null&&a(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function sy(t){const e={},n=s(t,["operationName"]);n!=null&&a(e,["operationName"],n);const i=s(t,["resourceName"]);i!=null&&a(e,["_url","resourceName"],i);const o=s(t,["config"]);return o!=null&&a(e,["config"],o),e}function ry(t){const e={},n=s(t,["video","uri"]);n!=null&&a(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&a(e,["videoBytes"],Pe(i));const o=s(t,["encoding"]);return o!=null&&a(e,["mimeType"],o),e}function ay(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],ry(n)),e}function ly(t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>ay(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function uy(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response","generateVideoResponse"]);return l!=null&&a(e,["response"],ly(l)),e}function cy(t){const e={},n=s(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&a(e,["videoBytes"],Pe(i));const o=s(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function dy(t){const e={},n=s(t,["_self"]);return n!=null&&a(e,["video"],cy(n)),e}function fy(t){const e={},n=s(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>dy(l))),a(e,["generatedVideos"],r)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&a(e,["raiMediaFilteredCount"],i);const o=s(t,["raiMediaFilteredReasons"]);return o!=null&&a(e,["raiMediaFilteredReasons"],o),e}function or(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);r!=null&&a(e,["error"],r);const l=s(t,["response"]);return l!=null&&a(e,["response"],fy(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hy extends dt{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let r;return i&&"httpOptions"in i&&(r=i.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:r}})}else return this.getVideosOperationInternal({operationName:n.name,config:i})}async getVideosOperationInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=oy(e);return u=F("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>or(f))}else{const c=iy(e);return u=F("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>uy(f))}}async fetchPredictVideosOperationInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=sy(e);return r=F("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>or(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function py(t){const e={},n=s(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function sl(t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],py(n)),e}function my(t){const e={},n=s(t,["speaker"]);n!=null&&a(e,["speaker"],n);const i=s(t,["voiceConfig"]);return i!=null&&a(e,["voiceConfig"],sl(i)),e}function gy(t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>my(o))),a(e,["speakerVoiceConfigs"],i)}return e}function yy(t){const e={},n=s(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],sl(n));const i=s(t,["multiSpeakerVoiceConfig"]);i!=null&&a(e,["multiSpeakerVoiceConfig"],gy(i));const o=s(t,["languageCode"]);return o!=null&&a(e,["languageCode"],o),e}function _y(t){const e={},n=s(t,["fps"]);n!=null&&a(e,["fps"],n);const i=s(t,["endOffset"]);i!=null&&a(e,["endOffset"],i);const o=s(t,["startOffset"]);return o!=null&&a(e,["startOffset"],o),e}function vy(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&a(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Cy(t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const i=s(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Ty(t){const e={},n=s(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],_y(n));const i=s(t,["thought"]);i!=null&&a(e,["thought"],i);const o=s(t,["inlineData"]);o!=null&&a(e,["inlineData"],vy(o));const r=s(t,["fileData"]);r!=null&&a(e,["fileData"],Cy(r));const l=s(t,["thoughtSignature"]);l!=null&&a(e,["thoughtSignature"],l);const u=s(t,["codeExecutionResult"]);u!=null&&a(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&a(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&a(e,["functionResponse"],f);const h=s(t,["text"]);return h!=null&&a(e,["text"],h),e}function wy(t){const e={},n=s(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Ty(r))),a(e,["parts"],o)}const i=s(t,["role"]);return i!=null&&a(e,["role"],i),e}function Sy(t){const e={},n=s(t,["behavior"]);n!=null&&a(e,["behavior"],n);const i=s(t,["description"]);i!=null&&a(e,["description"],i);const o=s(t,["name"]);o!=null&&a(e,["name"],o);const r=s(t,["parameters"]);r!=null&&a(e,["parameters"],r);const l=s(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const u=s(t,["response"]);u!=null&&a(e,["response"],u);const d=s(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function Ay(t){const e={},n=s(t,["startTime"]);n!=null&&a(e,["startTime"],n);const i=s(t,["endTime"]);return i!=null&&a(e,["endTime"],i),e}function xy(t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],Ay(n)),e}function Ey(t){const e={},n=s(t,["mode"]);n!=null&&a(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&a(e,["dynamicThreshold"],i),e}function Iy(t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Ey(n)),e}function My(){return{}}function Ry(t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>Sy(d))),a(e,["functionDeclarations"],u)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=s(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],xy(i));const o=s(t,["googleSearchRetrieval"]);if(o!=null&&a(e,["googleSearchRetrieval"],Iy(o)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&a(e,["urlContext"],My());const l=s(t,["codeExecution"]);return l!=null&&a(e,["codeExecution"],l),e}function Py(t){const e={},n=s(t,["handle"]);if(n!=null&&a(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function sr(){return{}}function ky(t){const e={},n=s(t,["disabled"]);n!=null&&a(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&a(e,["startOfSpeechSensitivity"],i);const o=s(t,["endOfSpeechSensitivity"]);o!=null&&a(e,["endOfSpeechSensitivity"],o);const r=s(t,["prefixPaddingMs"]);r!=null&&a(e,["prefixPaddingMs"],r);const l=s(t,["silenceDurationMs"]);return l!=null&&a(e,["silenceDurationMs"],l),e}function Ny(t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],ky(n));const i=s(t,["activityHandling"]);i!=null&&a(e,["activityHandling"],i);const o=s(t,["turnCoverage"]);return o!=null&&a(e,["turnCoverage"],o),e}function by(t){const e={},n=s(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function Dy(t){const e={},n=s(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&a(e,["slidingWindow"],by(i)),e}function Fy(t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function Ly(t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig"],i);const o=s(t,["responseModalities"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","responseModalities"],o);const r=s(t,["temperature"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig","temperature"],r);const l=s(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=s(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=s(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=s(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=s(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],yy(eo(h)));const p=s(t,["enableAffectiveDialog"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],p);const m=s(t,["systemInstruction"]);e!==void 0&&m!=null&&a(e,["setup","systemInstruction"],wy(ue(m)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let I=$t(g);Array.isArray(I)&&(I=I.map(D=>Ry(Vt(D)))),a(e,["setup","tools"],I)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&a(e,["setup","sessionResumption"],Py(y));const v=s(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&a(e,["setup","inputAudioTranscription"],sr());const x=s(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&a(e,["setup","outputAudioTranscription"],sr());const C=s(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&a(e,["setup","realtimeInputConfig"],Ny(C));const T=s(t,["contextWindowCompression"]);e!==void 0&&T!=null&&a(e,["setup","contextWindowCompression"],Dy(T));const w=s(t,["proactivity"]);return e!==void 0&&w!=null&&a(e,["setup","proactivity"],Fy(w)),n}function Uy(t,e){const n={},i=s(e,["model"]);i!=null&&a(n,["setup","model"],z(t,i));const o=s(e,["config"]);return o!=null&&a(n,["config"],Ly(o,n)),n}function Vy(t,e,n){const i={},o=s(e,["expireTime"]);n!==void 0&&o!=null&&a(n,["expireTime"],o);const r=s(e,["newSessionExpireTime"]);n!==void 0&&r!=null&&a(n,["newSessionExpireTime"],r);const l=s(e,["uses"]);n!==void 0&&l!=null&&a(n,["uses"],l);const u=s(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&a(n,["bidiGenerateContentSetup"],Uy(t,u));const d=s(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&a(n,["fieldMask"],d),i}function $y(t,e){const n={},i=s(e,["config"]);return i!=null&&a(n,["config"],Vy(t,i,n)),n}function By(t){const e={},n=s(t,["name"]);return n!=null&&a(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oy(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(r=>`${n}.${r}`);e.push(...o)}else e.push(n)}return e.join(",")}function Gy(t,e){let n=null;const i=t.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(t.bidiGenerateContentSetup=r,n=r):delete t.bidiGenerateContentSetup}else i!==void 0&&delete t.bidiGenerateContentSetup;const o=t.fieldMask;if(n){const r=Oy(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?t.fieldMask=r:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];o.length>0&&(u=o.map(c=>l.includes(c)?`generationConfig.${c}`:c));const d=[];r&&d.push(r),u.length>0&&d.push(...u),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?t.fieldMask=o.join(","):delete t.fieldMask;return t}class qy extends dt{constructor(e){super(),this.apiClient=e}async create(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=$y(this.apiClient,e);r=F("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=Gy(u,e.config);return o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),o.then(c=>By(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jy(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Hy(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);e!==void 0&&o!=null&&a(e,["_query","pageToken"],o);const r=s(t,["filter"]);return e!==void 0&&r!=null&&a(e,["_query","filter"],r),n}function Wy(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],Hy(n,e)),e}function Ky(t){const e={},n=s(t,["textInput"]);n!=null&&a(e,["textInput"],n);const i=s(t,["output"]);return i!=null&&a(e,["output"],i),e}function Yy(t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Ky(o))),a(e,["examples","examples"],i)}return e}function Zy(t,e){const n={};if(s(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=s(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&a(e,["displayName"],i),s(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=s(t,["epochCount"]);e!==void 0&&o!=null&&a(e,["tuningTask","hyperparameters","epochCount"],o);const r=s(t,["learningRateMultiplier"]);if(r!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],r),s(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(s(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=s(t,["batchSize"]);e!==void 0&&l!=null&&a(e,["tuningTask","hyperparameters","batchSize"],l);const u=s(t,["learningRate"]);return e!==void 0&&u!=null&&a(e,["tuningTask","hyperparameters","learningRate"],u),n}function zy(t){const e={},n=s(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&a(e,["tuningTask","trainingData"],Yy(i));const o=s(t,["config"]);return o!=null&&a(e,["config"],Zy(o,e)),e}function Xy(t){const e={},n=s(t,["name"]);n!=null&&a(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&a(e,["config"],i),e}function Qy(t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const o=s(t,["pageToken"]);e!==void 0&&o!=null&&a(e,["_query","pageToken"],o);const r=s(t,["filter"]);return e!==void 0&&r!=null&&a(e,["_query","filter"],r),n}function jy(t){const e={},n=s(t,["config"]);return n!=null&&a(e,["config"],Qy(n,e)),e}function e_(t,e){const n={},i=s(t,["gcsUri"]);if(e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),s(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function t_(t){const e={},n=s(t,["gcsUri"]);return n!=null&&a(e,["validationDatasetUri"],n),e}function n_(t,e){const n={},i=s(t,["validationDataset"]);e!==void 0&&i!=null&&a(e,["supervisedTuningSpec"],t_(i));const o=s(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&a(e,["tunedModelDisplayName"],o);const r=s(t,["description"]);e!==void 0&&r!=null&&a(e,["description"],r);const l=s(t,["epochCount"]);e!==void 0&&l!=null&&a(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const u=s(t,["learningRateMultiplier"]);e!==void 0&&u!=null&&a(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=s(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&a(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const c=s(t,["adapterSize"]);if(e!==void 0&&c!=null&&a(e,["supervisedTuningSpec","hyperParameters","adapterSize"],c),s(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(s(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function i_(t){const e={},n=s(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],e_(i,e));const o=s(t,["config"]);return o!=null&&a(e,["config"],n_(o,e)),e}function o_(t){const e={},n=s(t,["name"]);n!=null&&a(e,["model"],n);const i=s(t,["name"]);return i!=null&&a(e,["endpoint"],i),e}function rl(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["state"]);i!=null&&a(e,["state"],qa(i));const o=s(t,["createTime"]);o!=null&&a(e,["createTime"],o);const r=s(t,["tuningTask","startTime"]);r!=null&&a(e,["startTime"],r);const l=s(t,["tuningTask","completeTime"]);l!=null&&a(e,["endTime"],l);const u=s(t,["updateTime"]);u!=null&&a(e,["updateTime"],u);const d=s(t,["description"]);d!=null&&a(e,["description"],d);const c=s(t,["baseModel"]);c!=null&&a(e,["baseModel"],c);const f=s(t,["_self"]);f!=null&&a(e,["tunedModel"],o_(f));const h=s(t,["distillationSpec"]);h!=null&&a(e,["distillationSpec"],h);const p=s(t,["experiment"]);p!=null&&a(e,["experiment"],p);const m=s(t,["labels"]);m!=null&&a(e,["labels"],m);const g=s(t,["pipelineJob"]);g!=null&&a(e,["pipelineJob"],g);const y=s(t,["serviceAccount"]);y!=null&&a(e,["serviceAccount"],y);const v=s(t,["tunedModelDisplayName"]);return v!=null&&a(e,["tunedModelDisplayName"],v),e}function s_(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["tunedModels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>rl(r))),a(e,["tuningJobs"],o)}return e}function r_(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=s(t,["done"]);o!=null&&a(e,["done"],o);const r=s(t,["error"]);return r!=null&&a(e,["error"],r),e}function a_(t){const e={},n=s(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const i=s(t,["epoch"]);i!=null&&a(e,["epoch"],i);const o=s(t,["step"]);o!=null&&a(e,["step"],o);const r=s(t,["endpoint"]);return r!=null&&a(e,["endpoint"],r),e}function l_(t){const e={},n=s(t,["model"]);n!=null&&a(e,["model"],n);const i=s(t,["endpoint"]);i!=null&&a(e,["endpoint"],i);const o=s(t,["checkpoints"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>a_(l))),a(e,["checkpoints"],r)}return e}function Ri(t){const e={},n=s(t,["name"]);n!=null&&a(e,["name"],n);const i=s(t,["state"]);i!=null&&a(e,["state"],qa(i));const o=s(t,["createTime"]);o!=null&&a(e,["createTime"],o);const r=s(t,["startTime"]);r!=null&&a(e,["startTime"],r);const l=s(t,["endTime"]);l!=null&&a(e,["endTime"],l);const u=s(t,["updateTime"]);u!=null&&a(e,["updateTime"],u);const d=s(t,["error"]);d!=null&&a(e,["error"],d);const c=s(t,["description"]);c!=null&&a(e,["description"],c);const f=s(t,["baseModel"]);f!=null&&a(e,["baseModel"],f);const h=s(t,["tunedModel"]);h!=null&&a(e,["tunedModel"],l_(h));const p=s(t,["supervisedTuningSpec"]);p!=null&&a(e,["supervisedTuningSpec"],p);const m=s(t,["tuningDataStats"]);m!=null&&a(e,["tuningDataStats"],m);const g=s(t,["encryptionSpec"]);g!=null&&a(e,["encryptionSpec"],g);const y=s(t,["partnerModelTuningSpec"]);y!=null&&a(e,["partnerModelTuningSpec"],y);const v=s(t,["distillationSpec"]);v!=null&&a(e,["distillationSpec"],v);const x=s(t,["experiment"]);x!=null&&a(e,["experiment"],x);const C=s(t,["labels"]);C!=null&&a(e,["labels"],C);const T=s(t,["pipelineJob"]);T!=null&&a(e,["pipelineJob"],T);const w=s(t,["serviceAccount"]);w!=null&&a(e,["serviceAccount"],w);const I=s(t,["tunedModelDisplayName"]);return I!=null&&a(e,["tunedModelDisplayName"],I),e}function u_(t){const e={},n=s(t,["nextPageToken"]);n!=null&&a(e,["nextPageToken"],n);const i=s(t,["tuningJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(r=>Ri(r))),a(e,["tuningJobs"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c_ extends dt{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Un(ut.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const i=await this.tuneMldevInternal(n);let o="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?o=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(o=i.name.split("/operations/")[0]),{name:o,state:Ti.JOB_STATE_QUEUED}}}}async getInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Xy(e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>Ri(f))}else{const c=Jy(e);return u=F("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>rl(f))}}async listInternal(e){var n,i,o,r;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=jy(e);return u=F("tuningJobs",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),l.then(f=>{const h=u_(f),p=new Ds;return Object.assign(p,h),p})}else{const c=Wy(e);return u=F("tunedModels",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const h=s_(f),p=new Ds;return Object.assign(p,h),p})}}async tuneInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI()){const u=i_(e);return r=F("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Ri(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,i;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=zy(e);return r=F("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>r_(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class d_{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const f_=1024*1024*8,h_=3,p_=1e3,m_=2,jn="x-goog-upload-status";async function g_(t,e,n){var i,o,r;let l=0,u=0,d=new wi(new Response),c="upload";for(l=t.size;u<l;){const h=Math.min(f_,l-u),p=t.slice(u,u+h);u+h>=l&&(c+=", finalize");let m=0,g=p_;for(;m<h_&&(d=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(h)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[jn]));)m++,await __(g),g=g*m_;if(u+=h,((o=d==null?void 0:d.headers)===null||o===void 0?void 0:o[jn])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((r=d==null?void 0:d.headers)===null||r===void 0?void 0:r[jn])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function y_(t){return{size:t.size,type:t.type}}function __(t){return new Promise(e=>setTimeout(e,t))}class v_{async upload(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await g_(e,n,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await y_(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class C_{create(e,n,i){return new T_(e,n,i)}}class T_{constructor(e,n,i){this.url=e,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rr="x-goog-api-key";class w_{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(rr)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(rr,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const S_="gl-node/";class A_{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const i=Tc(e,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new w_(this.apiKey);this.apiClient=new Vg({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:S_+"web",uploader:new v_,downloader:new d_}),this.models=new ny(this.apiClient),this.live=new Xg(this.apiClient,o,new C_),this.chats=new Yd(this.models,this.apiClient),this.caches=new Hd(this.apiClient),this.files=new lf(this.apiClient),this.operations=new hy(this.apiClient),this.authTokens=new qy(this.apiClient),this.tunings=new c_(this.apiClient)}}let Pi=null;const ht=async()=>(Pi??(Pi=await Nt.getActiveApiKey("google")),Pi),Q_=async()=>{Pi=await Nt.getActiveApiKey("google"),cn=null};let cn=null;const On=async()=>{const t=await ht();return!cn&&t&&(cn=new A_({apiKey:t})),cn},x_=t=>{const e=Array.isArray(t.text)?t.text.join(`
`):t.text;switch(t.sender){case"character":return{role:"model",parts:[{text:e}]};case"user":default:return{role:"user",parts:[{text:e}]}}},al=t=>{const e=[];let n;if(t.characterInitialPrompt&&(n=t.characterInitialPrompt),t.characterInitialMessage&&t.characterInitialMessage.length>0&&e.push({role:"model",parts:[{text:t.characterInitialMessage.join(`
`)}]}),t.messages&&t.messages.length>0&&t.messages.forEach(i=>{e.push(x_(i))}),e.length>0&&e[e.length-1].role==="model"){let i=-1;for(let o=e.length-1;o>=0;o--)if(e[o].role==="user"){i=o;break}i>=0?e.splice(i+1):e.length===1&&e[0].role==="model"&&e.push({role:"user",parts:[{text:"Hello"}]})}return e.length===0&&e.push({role:"user",parts:[{text:"Hello"}]}),{messages:e,systemInstruction:n}},E_=async(t,e="gemini-2.5-flash",n=1e3)=>{var i,o,r,l,u;try{if(!await ht())throw new Error("Google AI API key is not configured. Please configure your API key in the application settings.");const c=await On();if(!c)throw new Error("Failed to initialize Google AI client");const{messages:f,systemInstruction:h}=al(t),p=parseFloat(t.temperature)||.7,m=f.map(x=>({role:x.role,parts:x.parts})),g={model:e,contents:m,generationConfig:{temperature:p,maxOutputTokens:n}};h&&(g.systemInstruction={parts:[{text:h}]});const v=(u=(l=(r=(o=(i=(await c.models.generateContent(g)).candidates)==null?void 0:i[0])==null?void 0:o.content)==null?void 0:r.parts)==null?void 0:l[0])==null?void 0:u.text;if(!v)throw new Error("No response received from Google AI");return v}catch(d){throw console.error("Error getting chat completion:",d),d}},I_=async(t,e="gemini-2.5-flash",n=1e3,i)=>{var o,r,l,u,d;try{if(!await ht())throw new Error("Google AI API key is not configured. Please configure your API key in the application settings.");const f=await On();if(!f)throw new Error("Failed to initialize Google AI client");const{messages:h,systemInstruction:p}=al(t),m=parseFloat(t.temperature)||.7,g=h.map(C=>({role:C.role,parts:C.parts})),y={model:e,contents:g,generationConfig:{temperature:m,maxOutputTokens:n}};p&&(y.systemInstruction={parts:[{text:p}]});const v=await f.models.generateContentStream(y);let x="";for await(const C of v){const T=(d=(u=(l=(r=(o=C.candidates)==null?void 0:o[0])==null?void 0:r.content)==null?void 0:l.parts)==null?void 0:u[0])==null?void 0:d.text;T&&(x+=T,i==null||i(T))}return x}catch(c){throw console.error("Error getting streaming chat completion:",c),c}},M_=(t,e="character")=>({id:`msg_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,sender:e,text:[t]}),R_=async()=>{var t,e,n,i,o;try{if(!await ht())return!1;const l=await On();return l?!!((o=(i=(n=(e=(t=(await l.models.generateContent({model:"gemini-1.5-flash",contents:[{role:"user",parts:[{text:"Hello"}]}]})).candidates)==null?void 0:t[0])==null?void 0:e.content)==null?void 0:n.parts)==null?void 0:i[0])!=null&&o.text):!1}catch(r){return console.error("Invalid Google AI API key:",r),!1}},P_=async()=>!!await ht(),k_=async()=>{try{if(!await ht())throw new Error("Google AI API key not configured");const e=await On();if(!e)throw new Error("Failed to initialize Google AI client");const n=await e.models.list(),i=[];for await(const r of n)i.push(r);return i.filter(r=>{var l;return((l=r.supportedActions)==null?void 0:l.includes("generateContent"))&&!r.name.includes("embedding")&&!r.name.includes("tts")&&!r.name.includes("image")&&!r.name.includes("aqa")&&!r.name.includes("gemma")}).map(r=>r.name.replace("models/","")).sort((r,l)=>{const u=!r.includes("exp")&&!r.includes("preview"),d=!l.includes("exp")&&!l.includes("preview");return u&&!d?-1:!u&&d?1:r.localeCompare(l)})}catch(t){return console.error("Error fetching available models:",t),["gemini-2.5-pro","gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-pro","gemini-1.5-flash","gemini-1.5-flash-8b"]}},N_=t=>({"gemini-2.5-pro":{name:"Gemini 2.5 Pro",tier:"premium",description:"Most powerful thinking model with maximum response accuracy"},"gemini-2.5-flash":{name:"Gemini 2.5 Flash",tier:"pro",description:"Best model for price-performance with thinking capabilities"},"gemini-2.5-flash-lite-preview-06-17":{name:"Gemini 2.5 Flash Lite",tier:"free",description:"Most cost-efficient model optimized for high throughput"},"gemini-2.0-flash":{name:"Gemini 2.0 Flash",tier:"pro",description:"Next generation model with speed and realtime streaming"},"gemini-2.0-flash-lite":{name:"Gemini 2.0 Flash Lite",tier:"free",description:"Cost-efficient and low latency version of 2.0 Flash"},"gemini-1.5-flash":{name:"Gemini 1.5 Flash",tier:"free",description:"Fast and versatile model for most tasks"},"gemini-1.5-flash-8b":{name:"Gemini 1.5 Flash 8B",tier:"free",description:"Smaller, faster version of Flash for high volume tasks"},"gemini-1.5-pro":{name:"Gemini 1.5 Pro",tier:"pro",description:"Complex reasoning tasks requiring more intelligence"},"gemini-1.0-pro":{name:"Gemini 1.0 Pro",tier:"pro",description:"Previous generation pro model (legacy)"}})[t]||{name:t,tier:"pro",description:"Unknown model"};class b_{constructor(e="openai"){oo(this,"provider");this.provider=e}async getChatCompletion(e,n){const{model:i,maxTokens:o=1e3}=n;switch(this.provider){case"openai":return Du(e,i,o);case"google-ai":return E_(e,i,o);default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async getStreamingChatCompletion(e,n,i){const{model:o,maxTokens:r=1e3}=i;switch(this.provider){case"openai":return Fu(e,o,r,n);case"google-ai":return I_(e,o,r,n);default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async validateApiKey(){switch(this.provider){case"openai":return Uu();case"google-ai":return R_();default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async hasApiKey(){switch(this.provider){case"openai":return Vu();case"google-ai":return P_();default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}async getAvailableModels(){switch(this.provider){case"openai":return $u();case"google-ai":return k_();default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}createMessageFromResponse(e,n="character"){switch(this.provider){case"openai":return Lu(e,n);case"google-ai":return M_(e,n);default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}getProvider(){return this.provider}setProvider(e){this.provider=e}getDefaultModel(){switch(this.provider){case"openai":return"gpt-3.5-turbo";case"google-ai":return"gemini-1.5-flash";default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}getModelInfo(e){switch(this.provider){case"openai":{const n=e.includes("gpt-4");return{name:e,tier:n?"premium":"pro",description:n?"Advanced GPT-4 model":"Standard GPT model",provider:"openai"}}case"google-ai":return{...N_(e),provider:"google-ai"};default:throw new Error(`Unsupported AI provider: ${this.provider}`)}}getProviderDisplayName(){switch(this.provider){case"openai":return"OpenAI";case"google-ai":return"Google AI (Gemini)";default:return this.provider}}}const D_=(t="openai")=>{const[e,n]=H.useState(!1),[i,o]=H.useState(null),[r]=H.useState(()=>new b_(t)),l=H.useCallback(()=>{o(null)},[]),u=H.useCallback(async(y,v={})=>{try{n(!0),o(null);const{model:x=r.getDefaultModel(),maxTokens:C=1e3}=v,T=await r.getChatCompletion(y,{model:x,maxTokens:C});return r.createMessageFromResponse(T)}catch(x){const C=x instanceof Error?x.message:"Unknown error occurred";return o(C),null}finally{n(!1)}},[r]),d=H.useCallback(async(y,v,x={})=>{try{n(!0),o(null);const{model:C=r.getDefaultModel(),maxTokens:T=1e3}=x,w=await r.getStreamingChatCompletion(y,v,{model:C,maxTokens:T});return r.createMessageFromResponse(w)}catch(C){const T=C instanceof Error?C.message:"Unknown error occurred";return o(T),null}finally{n(!1)}},[r]),c=H.useCallback(async()=>{try{return o(null),await r.validateApiKey()}catch(y){const v=y instanceof Error?y.message:"Connection validation failed";return o(v),!1}},[r]),f=H.useCallback(async()=>{try{return o(null),await r.getAvailableModels()}catch(y){const v=y instanceof Error?y.message:"Failed to fetch models";return o(v),[]}},[r]),h=H.useCallback(y=>{r.setProvider(y),l()},[r,l]),p=H.useCallback(()=>r.getProviderDisplayName(),[r]),m=H.useCallback(async()=>{try{return await r.hasApiKey()}catch{return!1}},[r]),g=H.useCallback(()=>r.getDefaultModel(),[r]);return{isLoading:e,error:i,currentProvider:r.getProvider(),generateResponse:u,generateStreamingResponse:d,validateConnection:c,getAvailableModels:f,switchProvider:h,getProviderDisplayName:p,getDefaultModel:g,clearError:l,hasApiKey:m}},F_=H.lazy(()=>In(()=>import("./CharacterSelect-D46iSs8w.js"),__vite__mapDeps([4,1,2]))),L_=H.lazy(()=>In(()=>import("./AlertModal-B6nFR2oo.js"),__vite__mapDeps([5,1,2])));function U_(){const[t,e]=H.useState(()=>yl()),[n,i]=H.useState(()=>_l(t)),o=H.useRef(null),[r,l]=H.useState(!1),[u,d]=H.useState(!1),[c,f]=H.useState(null),{chats:h,currentChat:p,currentChatId:m,streamingResponse:g,setCurrentChat:y,addMessage:v,createChat:x,setStreamingResponse:C,clearStreamingResponse:T}=ur(),{isLoading:w,error:I,generateResponse:D,generateStreamingResponse:A,validateConnection:U,clearError:R,switchProvider:N,hasApiKey:G}=D_(t),ie=Z=>{f(Z),d(!0)},ke=()=>{d(!1),f(null)},fe=Z=>{e(Z),N(Z),i(Z==="openai"?"gpt-3.5-turbo":"gemini-1.5-flash")},Ne=Z=>{i(Z)};H.useEffect(()=>{const Z=()=>{const ae=vl();y(ae),setTimeout(()=>{l(!0)},50)};return Z(),window.addEventListener("hashchange",Z),()=>{window.removeEventListener("hashchange",Z)}},[y,h]),H.useEffect(()=>{var Z;(Z=o.current)==null||Z.setActiveTab(0)},[m]);const ll=async()=>{if(!p){ie("No chat selected");return}if(!await G()){ie(q.jsxs("div",{children:[q.jsx("p",{className:"font-semibold",children:"API Key Required"}),q.jsxs("p",{children:["No API key found for"," ",t==="openai"?"OpenAI":"Google AI","."]}),q.jsx("p",{children:"Please configure your API key in the Configuration tab to use this service."})]}));return}const ae=await D(p,{model:n,maxTokens:1e3});ae&&m&&v(m,ae)},ul=async()=>{if(!p||!m){ie("No chat selected");return}if(!await G()){ie(q.jsxs("div",{children:[q.jsx("p",{className:"font-semibold",children:"API Key Required"}),q.jsxs("p",{children:["No API key found for"," ",t==="openai"?"OpenAI":"Google AI","."]}),q.jsx("p",{children:"Please configure your API key in the Configuration tab to use this service."})]}));return}T(m);const ae=await A(p,Bt=>{C(m,Bt)},{model:n,maxTokens:1e3});ae&&m&&(v(m,ae),T(m))},cl=async()=>{const Z=t==="openai"?"OpenAI":"Google AI";try{if(!await Nt.hasApiKey(t)){ie(`No ${Z} API key found! Please configure your API key in the Configuration tab before testing the connection.`);return}}catch(Bt){console.error("Error checking API key:",Bt),ie(`Error checking ${Z} API key configuration.`);return}const ae=await U();ie(ae?`${Z} connection is valid!`:`${Z} connection failed! Please check your API key and try again.`)},dl=()=>{const Z=prompt("Enter your message:");Z&&m&&v(m,{sender:"user",text:[Z]})},fl=Z=>{if(Z.trim()&&m){const ae={sender:"user",text:[Z.trim()]};v(m,ae)}};return q.jsxs("div",{className:"flex-1 w-full flex flex-col items-center justify-center bg-gray-200 dark:bg-gray-900",children:[q.jsx(H.Suspense,{fallback:q.jsx("div",{children:"Loading..."}),children:q.jsx(L_,{show:u,onClose:ke,okText:"OK",children:c})}),r?q.jsx("div",{className:"w-full flex-1 flex flex-col bg-fixed md:bg-cover md:bg-center bg-no-repeat",style:{backgroundImage:p!=null&&p.backgroundImage?`url(${p.backgroundImage})`:void 0},children:m&&p?q.jsx(xl,{currentChat:p,streamingResponse:g,isLoading:w,error:I,clearError:R,onModelChange:Ne,onProviderChange:fe,selectedModel:n,selectedProvider:t,addUserMessage:dl,handleGenerateResponse:ll,handleStreamingResponse:ul,handleValidateConnection:cl,onSendMessage:fl,tabsRef:o}):q.jsxs("div",{className:"p-6",children:[q.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-200 mb-4 mt-6",children:"Select a Character to Start a New Chat"}),q.jsx(H.Suspense,{fallback:q.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading character selection..."}),children:q.jsx(F_,{onSelect:async Z=>{const ae=await x(Z);window.location.hash=`#${ae}`}})})]})}):q.jsx("div",{className:"flex m-auto items-center justify-center h-full",children:q.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})})]})}const j_=Object.freeze(Object.defineProperty({__proto__:null,default:U_},Symbol.toStringTag,{value:"Module"}));export{B_ as B,j_ as M,Q_ as a,X_ as r,D_ as u};
