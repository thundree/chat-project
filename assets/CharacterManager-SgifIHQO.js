import{e as p,d as k,r as g,j as a,Q as x,a1 as i}from"./index-B-U-4uMl.js";import{T as d,a as I}from"./Textarea-R8THUowr.js";function y({currentChat:c}){var m;const{t:s}=p(),{updateChat:u}=k(),[r,o]=g.useState({characterName:c.characterName??"",characterConversationBase:c.characterConversationBase??"",characterInitialMessage:((m=c.characterInitialMessage)==null?void 0:m.join(`

`))??"",characterImage:c.characterImage??"",backgroundImage:c.backgroundImage??""}),[h,l]=g.useState(!1);g.useEffect(()=>{var t;const e={characterName:c.characterName??"",characterConversationBase:c.characterConversationBase??"",characterInitialMessage:((t=c.characterInitialMessage)==null?void 0:t.join(`

`))??"",characterImage:c.characterImage??"",backgroundImage:c.backgroundImage??""};o(e),l(!1)},[c]);const n=(e,t)=>{o(b=>({...b,[e]:t})),l(!0)},v=async()=>{const e={characterName:r.characterName,characterConversationBase:r.characterConversationBase,characterInitialMessage:r.characterInitialMessage?r.characterInitialMessage.split(`

`).map(t=>t.trim()).filter(Boolean):void 0,characterImage:r.characterImage,backgroundImage:r.backgroundImage};await u(c.id,e),l(!1)},j=()=>{var e;o({characterName:c.characterName??"",characterConversationBase:c.characterConversationBase??"",characterInitialMessage:((e=c.characterInitialMessage)==null?void 0:e.join(`

`))??"",characterImage:c.characterImage??"",backgroundImage:c.backgroundImage??""}),l(!1)};return a.jsxs("div",{className:"space-y-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("characterManager.title")}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(x,{onClick:v,disabled:!h,children:s("common.save")}),h&&a.jsx(x,{variant:"gray",onClick:j,children:s("common.discard")})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(i,{htmlFor:"characterName",children:s("characterManager.characterName")}),a.jsx(d,{id:"characterName",type:"text",value:r.characterName,onChange:e=>n("characterName",e.target.value),placeholder:s("characterManager.characterNamePlaceholder")})]}),a.jsxs("div",{children:[a.jsx(i,{htmlFor:"backgroundImage",children:s("characterManager.backgroundImage")}),a.jsx(d,{id:"backgroundImage",type:"url",value:r.backgroundImage,onChange:e=>n("backgroundImage",e.target.value),placeholder:s("characterManager.backgroundImagePlaceholder")})]}),a.jsxs("div",{children:[a.jsx(i,{htmlFor:"characterImage",children:s("characterManager.characterImage")}),a.jsx(d,{id:"characterImage",type:"url",value:r.characterImage,onChange:e=>n("characterImage",e.target.value),placeholder:s("characterManager.characterImagePlaceholder")})]}),(r.backgroundImage||r.characterImage)&&a.jsxs("div",{className:"w-full relative p-4 rounded-lg overflow-hidden min-h-[140px] flex items-center justify-center",children:[r.backgroundImage&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute inset-0 rounded-lg",style:{backgroundImage:`url(${r.backgroundImage})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),a.jsx("div",{className:"absolute inset-0 bg-white opacity-90 dark:hidden rounded-lg"}),a.jsx("div",{className:"absolute inset-0 bg-gray-800 opacity-90 hidden dark:block rounded-lg"})]}),a.jsxs("div",{className:"relative z-10 text-center",children:[r.characterImage&&a.jsx("img",{src:r.characterImage,alt:r.characterName||"",className:"mx-auto object-cover w-16 h-16 mb-2 rounded-lg",onError:e=>{e.target.style.display="none"}}),a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.characterName||""}),a.jsx("p",{className:"mt-2 text-xs text-gray-600 dark:text-gray-300",children:s("characterManager.backgroundPreview")})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(i,{htmlFor:"characterConversationBase",children:s("characterManager.initialPrompt")}),a.jsx(I,{id:"characterConversationBase",value:r.characterConversationBase,onChange:e=>n("characterConversationBase",e.target.value),placeholder:s("characterManager.initialPromptPlaceholder"),rows:7})]}),a.jsxs("div",{children:[a.jsx(i,{htmlFor:"characterInitialMessage",children:s("characterManager.initialMessage")}),a.jsx(I,{id:"characterInitialMessage",value:r.characterInitialMessage,onChange:e=>n("characterInitialMessage",e.target.value),placeholder:s("characterManager.initialMessagePlaceholder"),rows:7})]})]})]})]})}export{y as default};
