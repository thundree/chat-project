import{e as E,r as h,j as e,C as x,L as l}from"./index-C-IvzFry.js";import{T as n,a as c}from"./Textarea-DU5D7JwE.js";const v={name:"",description:"",roleInstruction:"",reminderMessage:"",characterInitialMessage:[""],avatarUrl:"",modelName:"good",maxTokensPerMessage:"400",fitMessagesInContextMethod:"summarizeOld",textEmbeddingModelName:"text-embedding-ada-002",autoGenerateMemories:"v1",avatarSize:"1",avatarShape:"square",sceneBackgroundUrl:"",sceneMusicUrl:"",userCharacterName:"User",userCharacterAvatarUrl:"",loreBookUrlsText:"",customCode:""};function M({character:s,onSave:j,onCancel:p,isEditing:b=!1,chatTitle:d}){var u;const{t:a}=E(),[t,m]=h.useState(()=>({...v,...s})),[g,o]=h.useState(d||(s?`Chat with ${s.name}`:""));h.useEffect(()=>{s&&m({...v,...s}),d!==void 0?o(d):s&&o(`Chat with ${s.name}`)},[s,d]);const i=(r,y)=>{m(C=>({...C,[r]:y}))},f=()=>{if(!t.name.trim())return;const r={...t,isOriginal:!1};j(r,g.trim()||void 0)},k=t.name.trim().length>0;return e.jsxs("div",{className:"space-y-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a(b?"characterEditor.editTitle":"characterEditor.createTitle")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{onClick:f,disabled:!k,children:a("common.save")}),e.jsx(x,{variant:"gray",onClick:p,children:a("common.cancel")})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-600 pb-4",children:e.jsxs("div",{children:[e.jsx(l,{htmlFor:"chatTitle",children:a("characterEditor.chatTitle")}),e.jsx(n,{id:"chatTitle",type:"text",value:g,onChange:r=>o(r.target.value),placeholder:a("characterEditor.chatTitlePlaceholder"),maxLength:128}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a("characterEditor.chatTitleDescription")})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:a("characterEditor.name")}),e.jsx(n,{id:"name",type:"text",value:t.name,onChange:r=>i("name",r.target.value),placeholder:a("characterEditor.namePlaceholder"),required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"description",children:a("characterEditor.description")}),e.jsx(c,{id:"description",value:t.description,onChange:r=>i("description",r.target.value),placeholder:a("characterEditor.descriptionPlaceholder"),rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"avatarUrl",children:a("characterEditor.avatarUrl")}),e.jsx(n,{id:"avatarUrl",type:"url",value:t.avatarUrl,onChange:r=>i("avatarUrl",r.target.value),placeholder:a("characterEditor.avatarUrlPlaceholder")})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sceneBackgroundUrl",children:a("characterEditor.backgroundUrl")}),e.jsx(n,{id:"sceneBackgroundUrl",type:"url",value:t.sceneBackgroundUrl,onChange:r=>i("sceneBackgroundUrl",r.target.value),placeholder:a("characterEditor.backgroundUrlPlaceholder")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"roleInstruction",children:a("characterEditor.roleInstruction")}),e.jsx(c,{id:"roleInstruction",value:t.roleInstruction,onChange:r=>i("roleInstruction",r.target.value),placeholder:a("characterEditor.roleInstructionPlaceholder"),rows:6})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"reminderMessage",children:a("characterEditor.reminderMessage")}),e.jsx(c,{id:"reminderMessage",value:t.reminderMessage,onChange:r=>i("reminderMessage",r.target.value),placeholder:a("characterEditor.reminderMessagePlaceholder"),rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"initialMessage",children:a("characterEditor.initialMessage")}),e.jsx(c,{id:"initialMessage",value:((u=t.characterInitialMessage)==null?void 0:u[0])??"",onChange:r=>i("characterInitialMessage",[r.target.value]),placeholder:a("characterEditor.initialMessagePlaceholder"),rows:4})]})]})]}),e.jsx("div",{className:"flex w-full gap-6",children:e.jsxs("div",{className:"w-full relative p-4 rounded-lg overflow-hidden min-h-[140px] flex items-center justify-center",children:[t.sceneBackgroundUrl&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 rounded-lg",style:{backgroundImage:`url(${t.sceneBackgroundUrl})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),e.jsx("div",{className:"absolute inset-0 bg-white opacity-90 dark:hidden rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-gray-800 opacity-90 hidden dark:block rounded-lg"})]}),e.jsxs("div",{className:"relative z-10 text-center",children:[t.avatarUrl&&e.jsx("img",{src:t.avatarUrl,alt:t.name||"Character preview",className:`mx-auto object-cover w-16 h-16 mb-2 ${t.avatarShape==="square"?"rounded-lg":"rounded-full"}`,onError:r=>{r.target.style.display="none"}}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.name||"Character Name"}),e.jsx("p",{className:"mt-2 text-xs text-gray-600 dark:text-gray-300",children:a("characterEditor.backgroundPreview")})]})]})})]})}export{M as default};
