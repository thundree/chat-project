import{G as xe,r as l,e as he,k as f,X as W,Y as fe,Z as v,$ as Z,j as e,O as pe,i as ge,m as be,Q as ye,a0 as ve}from"./index-B-U-4uMl.js";import{u as Ne,B as je}from"./MainContent-BsyEbUd9.js";function ke(a){return xe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"},child:[]},{tag:"path",attr:{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"},child:[]},{tag:"path",attr:{d:"M12 9l0 3"},child:[]},{tag:"path",attr:{d:"M12 15l.01 0"},child:[]}]})(a)}function Ee({currentChat:a,isLoading:o,error:M,clearError:$,onModelChange:m,onProviderChange:q,selectedModel:n,selectedProvider:r,onUserNameChange:K,onTitleChange:F,onTemperatureChange:_,onTestApiConnection:H}){const[N,U]=l.useState(!1),[p,d]=l.useState([]),[J,c]=l.useState(!1),[g,D]=l.useState(a.userName??"User"),[j,O]=l.useState(!1),[V,C]=l.useState(!1),[u,L]=l.useState(a.title),[k,X]=l.useState(!1),[P,Y]=l.useState(!1),[b,B]=l.useState(a.temperature),[w,G]=l.useState(!1),[ee,R]=l.useState(!1),{getAvailableModels:S,switchProvider:se,getProviderDisplayName:te,hasApiKey:x}=Ne(r),{t}=he(),ae=s=>({})[s]||s,z=s=>s.includes("gpt-4")?"premium":s.includes("gpt")?"pro":s.includes("gemini-2.5-flash")?"free":s.includes("gemini")?"pro":s.includes("llama")||s.includes("mistral")||s.includes("codellama")||s.includes("phi")||s.includes("gemma")?"free":"pro",re=s=>{m(s),v(s,r)},Q=l.useCallback(async()=>{try{if(r!==f&&!await x()){d([]),c(!1);return}const{models:s,timestamp:i}=W(r,void 0,!0);if(!fe(i,24)&&s.length>0){if(d(s),c(!0),!n||!s.includes(n)){const h=s[0];m(h),v(h,r)}return}const y=await S();if(y.length>0&&(d(y),Z(y,r),c(!1),!n||!y.includes(n))){const h=y[0];m(h),v(h,r)}}catch{if(r===f||await x()){const{models:i}=W(r,void 0,!0);if(i.length>0){if(d(i),c(!0),!n||!i.includes(n)){const A=i[0];m(A),v(A,r)}}else d([])}else d([])}},[r,x,S,n,m]),le=async s=>{q(s),se(s),ve(s),d([]),c(!1)},ie=async()=>{try{if(r!==f&&!await x()){d([]);return}U(!0);const s=await S();if(s.length>0&&(d(s),Z(s,r),c(!1),!s.includes(n))){const i=s[0];m(i),v(i,r)}}catch(s){console.error("Failed to refresh models:",s)}finally{U(!1)}},ne=s=>{D(s.target.value),C(!1)},oe=async()=>{const s=g.trim();if(!(!s||g===a.userName)){O(!0);try{K&&K(s),C(!0)}finally{O(!1)}}};let E=t("common.save");j?E=t("common.saving"):V&&(E=t("common.saved"));const de=s=>{L(s.target.value),Y(!1)},ce=async()=>{if(!(!u.trim()||u===a.title)){X(!0);try{F&&F(u.trim()),Y(!0)}finally{X(!1)}}};let T=t("common.save");k?T=t("common.saving"):P&&(T=t("common.saved"));const me=s=>{B(parseFloat(s.target.value)),R(!1)},ue=async()=>{if(b!==a.temperature){G(!0);try{_&&_(b),R(!0)}finally{G(!1)}}};let I=t("common.save");return w?I=t("common.saving"):ee&&(I=t("common.saved")),l.useEffect(()=>{Q()},[Q]),l.useEffect(()=>{(async()=>{r!==f&&(await x()||(d([]),c(!1)))})()},[r,x]),l.useEffect(()=>{D(a.userName??"User")},[a.userName]),l.useEffect(()=>{B(a.temperature),L(a.title)},[a.temperature,a.title]),e.jsxs("div",{className:"w-full flex flex-col gap-3 bg-white/90 dark:bg-black/80 p-2 rounded-md",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("h2",{className:"text-gray-800 dark:text-gray-200",children:[t("chat.title"),": ",e.jsx("b",{children:a.title})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[t("chat.temperature"),": ",e.jsx("b",{children:a.temperature})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"user-name-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:t("chat.userName")}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{id:"user-name-input",name:"user-name",type:"text",value:g,onChange:ne,className:"flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border-gray-300",disabled:o||j,placeholder:t("chat.userNamePlaceholder"),maxLength:64}),e.jsx("button",{onClick:oe,disabled:o||j||!g.trim()||g===a.userName,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:E})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"chat-title-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:t("chat.title")}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{id:"chat-title-input",name:"chat-title",type:"text",value:u,onChange:de,className:"flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border-gray-300",disabled:o||k,placeholder:t("chat.titlePlaceholder"),maxLength:128}),e.jsx("button",{onClick:ce,disabled:o||k||!u.trim()||u===a.title,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:T})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{htmlFor:"temperature-slider",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 -mb-1 pt-1",children:[t("chat.temperature"),": ",b]}),e.jsxs("div",{className:"flex flex-row gap-0 items-center",children:[e.jsx("input",{id:"temperature-slider",name:"temperature",type:"range",min:"0",max:"1",step:"0.01",value:b,onChange:me,className:"flex-1 max-w-xs h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 slider",disabled:o||w}),e.jsx("button",{onClick:ue,disabled:o||w||b===a.temperature,className:"px-3 h-[34px] ml-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:I})]}),e.jsxs("div",{className:"flex max-w-xs justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsxs("span",{children:["0 (",t("chat.temperatureLabels.focused"),")"]}),e.jsxs("span",{children:["0.5 (",t("chat.temperatureLabels.balanced"),")"]}),e.jsxs("span",{children:["1 (",t("chat.temperatureLabels.creative"),")"]})]})]})]}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 pt-3",children:e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:t("apiKeys.title")})," ",t("settings.apiKeysNote")]}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300 mt-1",children:t("settings.apiKeysInstructions")})]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-start gap-2 mb-2",children:e.jsx("label",{htmlFor:"provider-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:t("providers.title")})}),e.jsxs("select",{id:"provider-select",value:r,onChange:s=>le(s.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:o,children:[e.jsx("option",{value:pe,children:t("providers.ollama")}),e.jsx("option",{value:f,children:t("providers.openrouter")}),e.jsx("option",{value:ge,children:t("providers.openai")}),e.jsx("option",{value:be,children:t("providers.google")})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[t("providers.current"),": ",te()]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 mb-2",children:[e.jsx("label",{htmlFor:"model-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:t("models.title")}),z(n)==="premium"&&e.jsx("span",{title:t("models.tierTooltips.premium"),className:"cursor-help text-amber-600 dark:text-amber-400",children:t("models.tiers.premium")}),z(n)==="free"&&e.jsx("span",{title:t("models.tierTooltips.free"),className:"cursor-help text-green-600 dark:text-green-400",children:t("models.tiers.free")})]}),e.jsx("select",{id:"model-select",value:n,onChange:s=>re(s.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:o||p.length===0,children:p.length===0?e.jsx("option",{value:"",children:t("models.noModels")}):p.map(s=>e.jsx("option",{value:s,children:ae(s)},s))}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex gap-2 mt-3",children:e.jsxs("div",{className:"flex flex-row items-start gap-5",children:[p.length>0?e.jsxs("button",{onClick:()=>{N||ie()},disabled:o||N,className:"flex items-center justify-center gap-1 cursor-pointer text-xs text-blue-600 dark:text-blue-400 hover:underline disabled:opacity-50",title:t("models.refreshTooltip"),children:[e.jsx(ke,{size:16}),e.jsx("span",{children:t(N?"models.refreshing":"models.refreshList")})]}):e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t(r===f?"models.loadingModels":"models.configureApiKey")}),J&&p.length>0&&e.jsxs("span",{title:t("models.cachedTooltip"),className:"cursor-help flex items-center justify-center gap-1 text-blue-600 dark:text-blue-400",children:[e.jsx(je,{size:16})," ",t("models.cachedModels")]})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(ye,{onClick:H,disabled:o,children:t("chat.testConnection")})}),M&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[e.jsxs("p",{className:"font-bold",children:[t("common.error"),":"]}),e.jsx("p",{children:M}),e.jsx("button",{onClick:$,className:"cursor-pointer mt-2 text-sm hover:underline no-underline",children:t("common.close")})]})]})}export{Ee as default};
