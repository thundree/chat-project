import{e as b,d as N,r as o,j as a,C as I,L as n}from"./index-C-IvzFry.js";import{T as d,a as x}from"./Textarea-DU5D7JwE.js";function y({currentChat:c}){var m;const{t}=b(),{updateChat:p}=N(),[r,g]=o.useState({characterName:c.characterName??"",characterInitialPrompt:c.characterInitialPrompt??"",characterInitialMessage:((m=c.characterInitialMessage)==null?void 0:m.join(`

`))??"",characterImage:c.characterImage??"",backgroundImage:c.backgroundImage??""}),[h,l]=o.useState(!1);o.useEffect(()=>{var s;const e={characterName:c.characterName??"",characterInitialPrompt:c.characterInitialPrompt??"",characterInitialMessage:((s=c.characterInitialMessage)==null?void 0:s.join(`

`))??"",characterImage:c.characterImage??"",backgroundImage:c.backgroundImage??""};g(e),l(!1)},[c]);const i=(e,s)=>{g(v=>({...v,[e]:s})),l(!0)},u=async()=>{const e={characterName:r.characterName,characterInitialPrompt:r.characterInitialPrompt,characterInitialMessage:r.characterInitialMessage?r.characterInitialMessage.split(`

`).map(s=>s.trim()).filter(Boolean):void 0,characterImage:r.characterImage,backgroundImage:r.backgroundImage};await p(c.id,e),l(!1)},j=()=>{var e;g({characterName:c.characterName??"",characterInitialPrompt:c.characterInitialPrompt??"",characterInitialMessage:((e=c.characterInitialMessage)==null?void 0:e.join(`

`))??"",characterImage:c.characterImage??"",backgroundImage:c.backgroundImage??""}),l(!1)};return a.jsxs("div",{className:"space-y-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("characterManager.title")}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(I,{onClick:u,disabled:!h,children:t("common.save")}),h&&a.jsx(I,{variant:"gray",onClick:j,children:t("common.discard")})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterName",children:t("characterManager.characterName")}),a.jsx(d,{id:"characterName",type:"text",value:r.characterName,onChange:e=>i("characterName",e.target.value),placeholder:t("characterManager.characterNamePlaceholder")})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"backgroundImage",children:t("characterManager.backgroundImage")}),a.jsx(d,{id:"backgroundImage",type:"url",value:r.backgroundImage,onChange:e=>i("backgroundImage",e.target.value),placeholder:t("characterManager.backgroundImagePlaceholder")})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterImage",children:t("characterManager.characterImage")}),a.jsx(d,{id:"characterImage",type:"url",value:r.characterImage,onChange:e=>i("characterImage",e.target.value),placeholder:t("characterManager.characterImagePlaceholder")})]}),(r.backgroundImage||r.characterImage)&&a.jsxs("div",{className:"w-full relative p-4 rounded-lg overflow-hidden min-h-[140px] flex items-center justify-center",children:[r.backgroundImage&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute inset-0 rounded-lg",style:{backgroundImage:`url(${r.backgroundImage})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),a.jsx("div",{className:"absolute inset-0 bg-white opacity-90 dark:hidden rounded-lg"}),a.jsx("div",{className:"absolute inset-0 bg-gray-800 opacity-90 hidden dark:block rounded-lg"})]}),a.jsxs("div",{className:"relative z-10 text-center",children:[r.characterImage&&a.jsx("img",{src:r.characterImage,alt:r.characterName||"Character preview",className:"mx-auto object-cover w-16 h-16 mb-2 rounded-lg",onError:e=>{e.target.style.display="none"}}),a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.characterName||"Character Name"}),a.jsx("p",{className:"mt-2 text-xs text-gray-600 dark:text-gray-300",children:t("characterManager.backgroundPreview")})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterInitialPrompt",children:t("characterManager.initialPrompt")}),a.jsx(x,{id:"characterInitialPrompt",value:r.characterInitialPrompt,onChange:e=>i("characterInitialPrompt",e.target.value),placeholder:t("characterManager.initialPromptPlaceholder"),rows:7})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"characterInitialMessage",children:t("characterManager.initialMessage")}),a.jsx(x,{id:"characterInitialMessage",value:r.characterInitialMessage,onChange:e=>i("characterInitialMessage",e.target.value),placeholder:t("characterManager.initialMessagePlaceholder"),rows:7})]})]})]})]})}export{y as default};
