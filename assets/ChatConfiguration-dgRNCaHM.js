import{G as Me,r,n as T,j as e,O as p,e as y,C as Ce,s as te,o as Pe,p as ae,D as u,q as Te}from"./index-C4eufKiv.js";import{u as Ge,B as Fe,r as re,a as se}from"./MainContent-fdOx_0qz.js";const G=a=>!a||typeof a!="string"?!1:a.startsWith("sk-")&&a.length>=40,F=a=>!a||typeof a!="string"?!1:a.startsWith("AI")&&a.length>=35;function Oe(a){return Me({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"},child:[]},{tag:"path",attr:{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"},child:[]},{tag:"path",attr:{d:"M12 9l0 3"},child:[]},{tag:"path",attr:{d:"M12 15l.01 0"},child:[]}]})(a)}function Re({currentChat:a,isLoading:l,error:O,clearError:le,onModelChange:_,onProviderChange:ne,selectedModel:b,selectedProvider:n,onUserNameChange:D,onTitleChange:U,onTemperatureChange:R,onTestApiConnection:ie}){const[v,B]=r.useState(!1),[oe,h]=r.useState(()=>{const{models:t}=T(n);return t}),[de,k]=r.useState(!1),[i,$]=r.useState(""),[o,W]=r.useState(""),[ce,N]=r.useState(!1),[xe,j]=r.useState(!1),[d,c]=r.useState(!1),[g,Y]=r.useState(a.userName??"User"),[S,z]=r.useState(!1),[me,H]=r.useState(!1),[x,X]=r.useState(a.title),[w,q]=r.useState(!1),[ue,J]=r.useState(!1),[f,Q]=r.useState(a.temperature),[A,V]=r.useState(!1),[ge,Z]=r.useState(!1),{getAvailableModels:I,switchProvider:fe,getProviderDisplayName:pe,getDefaultModel:he}=Ge(n),ye=t=>({})[t]||t,L=t=>t.includes("gpt-4")?"premium":t.includes("gpt")?"pro":t.includes("gemini-1.5-flash")?"free":(t.includes("gemini"),"pro"),be=t=>{_(t),te(t,n)},ve=t=>{ne(t),fe(t),Pe(t);const{models:s}=T(t);h(s);const m=he();_(m),te(m,t)},K=async()=>{try{B(!0);const t=await I();t.length>0&&(h(t),ae(t,n),k(!1))}catch(t){console.error("Failed to refresh models:",t)}finally{B(!1)}},ke=async()=>{try{const[t,s]=await Promise.all([u.hasApiKey(p),u.hasApiKey(y)]);N(t),j(s)}catch(t){console.error("Error checking API keys:",t)}},Ne=async()=>{if(i.trim()){if(!G(i.trim())){alert("Invalid OpenAI API key format. Keys should start with 'sk-' and be at least 40 characters long.");return}c(!0);try{await u.saveApiKey(p,i.trim()),await re(),$(""),N(!0),await K()}catch(t){console.error("Error saving OpenAI key:",t),alert("Error saving OpenAI API key. Please try again.")}finally{c(!1)}}},je=async()=>{if(o.trim()){if(!F(o.trim())){alert("Invalid Google AI API key format. Keys should start with 'AI' and be at least 35 characters long.");return}c(!0);try{await u.saveApiKey(y,o.trim()),await se(),W(""),j(!0),await K()}catch(t){console.error("Error saving Google AI key:",t),alert("Error saving Google AI API key. Please try again.")}finally{c(!1)}}},ee=async t=>{c(!0);try{const s=await u.getAllApiKeys(t);for(const m of s)await u.deleteApiKey(m.id);t===p?(await re(),N(!1)):(await se(),j(!1))}catch(s){console.error(`Error removing ${t} key:`,s)}finally{c(!1)}},Se=t=>{Y(t.target.value),H(!1)},we=async()=>{const t=g.trim();if(!(!t||g===a.userName)){z(!0);try{D&&D(t),H(!0)}finally{z(!1)}}};let E="Save";S?E="Saving...":me&&(E="Saved");const Ae=t=>{X(t.target.value),J(!1)},Ie=async()=>{if(!(!x.trim()||x===a.title)){q(!0);try{U&&U(x.trim()),J(!0)}finally{q(!1)}}};let M="Save";w?M="Saving...":ue&&(M="Saved");const Ke=t=>{Q(parseFloat(t.target.value)),Z(!1)},Ee=async()=>{if(f!==a.temperature){V(!0);try{R&&R(f),Z(!0)}finally{V(!1)}}};let C="Save";return A?C="Saving...":ge&&(C="Saved"),r.useEffect(()=>{(async()=>{try{const{models:s,timestamp:m}=T(n);if(!Te(m,24)&&s.length>0){h(s),k(!0);return}const P=await I();P.length>0&&(h(P),ae(P,n),k(!1))}catch(s){console.log("Could not fetch models, using cached/defaults:",s)}})()},[n,I]),r.useEffect(()=>{ke()},[]),r.useEffect(()=>{Y(a.userName??"User")},[a.userName]),r.useEffect(()=>{Q(a.temperature),X(a.title)},[a.temperature,a.title]),e.jsxs("div",{className:"w-full flex flex-col gap-3 bg-black/80 p-2 rounded-md",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("h2",{className:"text-gray-800 dark:text-gray-200",children:["Chat: ",e.jsx("b",{children:a.title})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Temperature: ",e.jsx("b",{children:a.temperature})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"user-name-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Your Name"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{id:"user-name-input",type:"text",value:g,onChange:Se,className:"flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border-gray-300",disabled:l||S,placeholder:"Enter your name",maxLength:64}),e.jsx("button",{onClick:we,disabled:l||S||!g.trim()||g===a.userName,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:E})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"chat-title-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Chat Title"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{id:"chat-title-input",type:"text",value:x,onChange:Ae,className:"flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border-gray-300",disabled:l||w,placeholder:"Enter a title for your chat",maxLength:128}),e.jsx("button",{onClick:Ie,disabled:l||w||!x.trim()||x===a.title,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:M})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{htmlFor:"temperature-slider",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 -mb-1 pt-1",children:["Temperature: ",f]}),e.jsxs("div",{className:"flex flex-row gap-0 items-center",children:[e.jsx("input",{id:"temperature-slider",type:"range",min:"0",max:"1",step:"0.01",value:f,onChange:Ke,className:"flex-1 max-w-xs h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 slider",disabled:l||A}),e.jsx("button",{onClick:Ee,disabled:l||A||f===a.temperature,className:"px-3 h-[34px] ml-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:C})]}),e.jsxs("div",{className:"flex max-w-xs justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("span",{children:"0 (Focused)"}),e.jsx("span",{children:".5 (Balanced)"}),e.jsx("span",{children:"1 (Creative)"})]})]})]}),e.jsxs("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 pt-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"API Key Configuration"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"OpenAI API Key"}),ce?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"âœ“ Configured"}),e.jsx("button",{onClick:()=>ee(p),disabled:d,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"openai-key-input",type:"password",value:i,onChange:t=>$(t.target.value),placeholder:"sk-...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${i&&!G(i)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:d}),e.jsx("button",{onClick:Ne,disabled:d||!i.trim()||!G(i),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:d?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"OpenAI Platform"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Google AI API Key"}),xe?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"âœ“ Configured"}),e.jsx("button",{onClick:()=>ee(y),disabled:d,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"google-key-input",type:"password",value:o,onChange:t=>W(t.target.value),placeholder:"AI...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${o&&!F(o)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:d}),e.jsx("button",{onClick:je,disabled:d||!o.trim()||!F(o),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:d?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Google AI Studio"})]})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-start gap-2 mb-2",children:e.jsx("label",{htmlFor:"provider-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI Provider"})}),e.jsxs("select",{id:"provider-select",value:n,onChange:t=>ve(t.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:l,children:[e.jsx("option",{value:p,children:"OpenAI (GPT Models)"}),e.jsx("option",{value:y,children:"Google AI (Gemini Models)"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Current: ",pe()]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 mb-2",children:[e.jsx("label",{htmlFor:"model-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Model"}),L(b)==="premium"&&e.jsx("span",{title:"Premium models may be more expensive",className:"cursor-help text-amber-600 dark:text-amber-400",children:"âš¡ Premium"}),L(b)==="free"&&e.jsx("span",{title:"Free tier model",className:"cursor-help text-green-600 dark:text-green-400",children:"ðŸ†“ Free"})]}),e.jsx("select",{id:"model-select",value:b,onChange:t=>be(t.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:l,children:oe.map(t=>e.jsx("option",{value:t,children:ye(t)},t))}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex gap-2 mt-3",children:e.jsxs("div",{className:"flex flex-row items-start gap-5",children:[e.jsxs("button",{onClick:()=>{v||K()},disabled:l||v,className:"flex items-center justify-center gap-1 cursor-pointer text-xs text-blue-600 dark:text-blue-400 hover:underline disabled:opacity-50",title:"Refresh available models",children:[e.jsx(Oe,{size:16}),e.jsx("span",{children:v?"Refreshing...":"Refresh list"})]}),de&&e.jsxs("span",{title:"Models list loaded from cache, might be outdated",className:"cursor-help flex items-center justify-center gap-1 text-blue-600 dark:text-blue-400",children:[e.jsx(Fe,{size:16})," Cached models"]})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Ce,{onClick:ie,className:"bg-yellow-500 hover:bg-yellow-600 text-white",disabled:l,children:"Test API Connection"})}),O&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:O}),e.jsx("button",{onClick:le,className:"cursor-pointer mt-2 text-sm hover:underline no-underline",children:"Clear Error"})]})]})}export{Re as default};
