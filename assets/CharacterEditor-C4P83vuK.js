import{e as S,r as o,j as e,Q as k,a1 as i}from"./index-B-U-4uMl.js";import{T as c,a as x}from"./Textarea-R8THUowr.js";const U={name:"",description:"",roleInstruction:"",reminderMessage:"",characterInitialMessage:[""],avatarUrl:"",modelName:"good",maxTokensPerMessage:"400",fitMessagesInContextMethod:"summarizeOld",textEmbeddingModelName:"text-embedding-ada-002",autoGenerateMemories:"v1",avatarSize:"1",avatarShape:"square",sceneBackgroundUrl:"",sceneMusicUrl:"",userCharacterName:"Username",userCharacterAvatarUrl:"",loreBookUrlsText:"",customCode:""};function z({character:s,onSave:E,onCancel:w,isEditing:g=!1,chatTitle:m,currentChat:l,onUserNameChange:v,onTemperatureChange:j}){var y;const{t:a}=S(),[t,b]=o.useState(()=>({...U,...s})),[N,u]=o.useState(m||(s?`Chat with ${s.name}`:"")),[h,p]=o.useState((l==null?void 0:l.userName)??(s==null?void 0:s.userCharacterName)??"Username"),[n,f]=o.useState((l==null?void 0:l.temperature)??.7);o.useEffect(()=>{s&&(b({...U,...s}),p((s==null?void 0:s.userCharacterName)??"Username")),m!==void 0?u(m):s&&u(`Chat with ${s.name}`),l&&(p(l.userName??"Username"),f(l.temperature))},[s,m,l]);const d=(r,P)=>{b(C=>({...C,[r]:P}))},M=()=>{if(!t.name.trim())return;const r={...t,userCharacterName:h,isOriginal:!1};E(r,N.trim()||void 0,n),v&&h!==((l==null?void 0:l.userName)??(s==null?void 0:s.userCharacterName))&&v(h),j&&n!==(l==null?void 0:l.temperature)&&j(n)},I=r=>{p(r.target.value)},T=r=>{f(parseFloat(r.target.value))},F=t.name.trim().length>0;return e.jsxs("div",{className:"space-y-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a(g?"characterEditor.editTitle":"characterEditor.createTitle")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{onClick:M,disabled:!F,children:a("common.save")}),e.jsx(k,{variant:"gray",onClick:w,children:a("common.cancel")})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-600 pb-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"chatTitle",children:a("characterEditor.chatTitle")}),e.jsx(c,{id:"chatTitle",type:"text",value:N,onChange:r=>u(r.target.value),placeholder:a("characterEditor.chatTitlePlaceholder"),maxLength:128}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a("characterEditor.chatTitleDescription")})]})}),e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-600 pb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Chat Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g&&e.jsxs("div",{className:"",children:[e.jsx(i,{htmlFor:"user-name-input",children:a("chat.userName")}),e.jsx(c,{id:"user-name-input",name:"user-name",type:"text",value:h,onChange:I,placeholder:a("chat.userNamePlaceholder"),maxLength:64})]}),e.jsxs("div",{className:g?"":"md:col-span-2",children:[e.jsxs(i,{htmlFor:"temperature-slider",children:[a("chat.temperature"),": ",n]}),e.jsx("input",{id:"temperature-slider",name:"temperature",type:"range",min:"0",max:"1",step:"0.01",value:n,onChange:T,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 mt-1"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsxs("span",{children:["0 (",a("chat.temperatureLabels.focused"),")"]}),e.jsxs("span",{children:["0.5 (",a("chat.temperatureLabels.balanced"),")"]}),e.jsxs("span",{children:["1 (",a("chat.temperatureLabels.creative"),")"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:a("characterEditor.name")}),e.jsx(c,{id:"name",type:"text",value:t.name,onChange:r=>d("name",r.target.value),placeholder:a("characterEditor.namePlaceholder"),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"description",children:a("characterEditor.description")}),e.jsx(x,{id:"description",value:t.description,onChange:r=>d("description",r.target.value),placeholder:a("characterEditor.descriptionPlaceholder"),rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"avatarUrl",children:a("characterEditor.avatarUrl")}),e.jsx(c,{id:"avatarUrl",type:"url",value:t.avatarUrl,onChange:r=>d("avatarUrl",r.target.value),placeholder:a("characterEditor.avatarUrlPlaceholder")})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"sceneBackgroundUrl",children:a("characterEditor.backgroundUrl")}),e.jsx(c,{id:"sceneBackgroundUrl",type:"url",value:t.sceneBackgroundUrl,onChange:r=>d("sceneBackgroundUrl",r.target.value),placeholder:a("characterEditor.backgroundUrlPlaceholder")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"roleInstruction",children:a("characterEditor.roleInstruction")}),e.jsx(x,{id:"roleInstruction",value:t.roleInstruction,onChange:r=>d("roleInstruction",r.target.value),placeholder:a("characterEditor.roleInstructionPlaceholder"),rows:6})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"reminderMessage",children:a("characterEditor.reminderMessage")}),e.jsx(x,{id:"reminderMessage",value:t.reminderMessage,onChange:r=>d("reminderMessage",r.target.value),placeholder:a("characterEditor.reminderMessagePlaceholder"),rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"initialMessage",children:a("characterEditor.initialMessage")}),e.jsx(x,{id:"initialMessage",value:((y=t.characterInitialMessage)==null?void 0:y[0])??"",onChange:r=>d("characterInitialMessage",[r.target.value]),placeholder:a("characterEditor.initialMessagePlaceholder"),rows:4})]})]})]}),e.jsx("div",{className:"flex w-full gap-6",children:e.jsxs("div",{className:"w-full relative p-4 rounded-lg overflow-hidden min-h-[140px] flex items-center justify-center",children:[t.sceneBackgroundUrl&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 rounded-lg",style:{backgroundImage:`url(${t.sceneBackgroundUrl})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),e.jsx("div",{className:"absolute inset-0 bg-white opacity-90 dark:hidden rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-gray-800 opacity-90 hidden dark:block rounded-lg"})]}),e.jsxs("div",{className:"relative z-10 text-center",children:[t.avatarUrl&&e.jsx("img",{src:t.avatarUrl,alt:t.name||"Character preview",className:`mx-auto object-cover w-16 h-16 mb-2 ${t.avatarShape==="square"?"rounded-lg":"rounded-full"}`,onError:r=>{r.target.style.display="none"}}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.name||""}),e.jsx("p",{className:"mt-2 text-xs text-gray-600 dark:text-gray-300",children:a("characterEditor.backgroundPreview")})]})]})})]})}export{z as default};
