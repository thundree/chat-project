import{G as ze,r as t,h as u,p as ye,q as qe,s as K,v as be,j as e,f as E,O,e as C,C as We,w as Je,D as m}from"./index-BJyMdEvk.js";import{u as Qe,v as H,a as X,b as z,c as q,B as Ve,r as ve,d as ke,e as Ne}from"./MainContent-BxmhuBsV.js";function Ze(r){return ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"},child:[]},{tag:"path",attr:{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"},child:[]},{tag:"path",attr:{d:"M12 9l0 3"},child:[]},{tag:"path",attr:{d:"M12 15l.01 0"},child:[]}]})(r)}function ta({currentChat:r,isLoading:o,error:W,clearError:je,onModelChange:v,onProviderChange:we,selectedModel:n,selectedProvider:s,onUserNameChange:J,onTitleChange:Q,onTemperatureChange:V,onTestApiConnection:Ae}){const[P,Z]=t.useState(!1),[w,d]=t.useState([]),[Se,f]=t.useState(!1),[h,ee]=t.useState(""),[g,ae]=t.useState(""),[c,Ie]=t.useState("http://localhost:11434"),[p,te]=t.useState(""),[re,M]=t.useState(!1),[se,U]=t.useState(!1),[le,T]=t.useState(!1),[ie,G]=t.useState(!1),[i,x]=t.useState(!1),[A,ne]=t.useState(r.userName??"User"),[_,oe]=t.useState(!1),[Ke,de]=t.useState(!1),[k,ce]=t.useState(r.title),[F,xe]=t.useState(!1),[Ee,ue]=t.useState(!1),[S,me]=t.useState(r.temperature),[D,he]=t.useState(!1),[Oe,ge]=t.useState(!1),{getAvailableModels:L,switchProvider:Ce,getProviderDisplayName:Re,hasApiKey:N}=Qe(s),Pe=a=>({})[a]||a,pe=a=>a.includes("gpt-4")?"premium":a.includes("gpt")?"pro":a.includes("gemini-2.5-flash")?"free":a.includes("gemini")?"pro":a.includes("llama")||a.includes("mistral")||a.includes("codellama")||a.includes("phi")||a.includes("gemma")?"free":"pro",Me=a=>{v(a),K(a,s)},fe=t.useCallback(async()=>{try{if(s!==u&&!await N()){d([]),f(!1);return}const{models:a,timestamp:l}=ye(s,void 0,!0);if(!qe(l,24)&&a.length>0){if(d(a),f(!0),!n||!a.includes(n)){const j=a[0];v(j),K(j,s)}return}const b=await L();if(b.length>0&&(d(b),be(b,s),f(!1),!n||!b.includes(n))){const j=b[0];v(j),K(j,s)}}catch{if(s===u||await N()){const{models:l}=ye(s,void 0,!0);if(l.length>0){if(d(l),f(!0),!n||!l.includes(n)){const y=l[0];v(y),K(y,s)}}else d([])}else d([])}},[s,N,L,n,v]),Ue=async a=>{we(a),Ce(a),Je(a),d([]),f(!1)},I=async()=>{try{if(s!==u&&!await N()){d([]);return}Z(!0);const a=await L();if(a.length>0&&(d(a),be(a,s),f(!1),!a.includes(n))){const l=a[0];v(l),K(l,s)}}catch(a){console.error("Failed to refresh models:",a)}finally{Z(!1)}},Te=async()=>{try{const[a,l,y,b]=await Promise.all([m.hasApiKey(O),m.hasApiKey(C),m.hasApiKey(E),m.hasApiKey(u)]);M(a),U(l),T(y),G(b)}catch(a){console.error("Error checking API keys:",a)}},Ge=async()=>{if(h.trim()){if(!H(h.trim())){alert("Invalid OpenAI API key format. Keys should start with 'sk-' and be at least 40 characters long.");return}x(!0);try{await m.saveApiKey(O,h.trim()),await ve(),ee(""),M(!0),await I()}catch(a){console.error("Error saving OpenAI key:",a),alert("Error saving OpenAI API key. Please try again.")}finally{x(!1)}}},_e=async()=>{if(g.trim()){if(!X(g.trim())){alert("Invalid Google AI API key format. Keys should start with 'AI' and be at least 35 characters long.");return}x(!0);try{await m.saveApiKey(C,g.trim()),await ke(),ae(""),U(!0),await I()}catch(a){console.error("Error saving Google AI key:",a),alert("Error saving Google AI API key. Please try again.")}finally{x(!1)}}},Fe=async()=>{if(c.trim()){if(!q(c.trim())){alert("Invalid Ollama URL format. Please enter a valid URL (e.g., http://localhost:11434).");return}x(!0);try{await m.saveApiKey(E,c.trim()),T(!0),await I()}catch(a){console.error("Error saving Ollama URL:",a),alert("Error saving Ollama URL. Please try again.")}finally{x(!1)}}},De=async()=>{if(p.trim()){if(!z(p.trim())){alert("Invalid OpenRouter API key format. Keys should start with 'sk-or-' and be at least 40 characters long.");return}x(!0);try{await m.saveApiKey(u,p.trim()),await Ne(),te(""),G(!0),await I()}catch(a){console.error("Error saving OpenRouter key:",a),alert("Error saving OpenRouter API key. Please try again.")}finally{x(!1)}}},R=async a=>{x(!0);try{const l=await m.getAllApiKeys(a);for(const y of l)await m.deleteApiKey(y.id);a===O?(await ve(),M(!1)):a===C?(await ke(),U(!1)):a===E?T(!1):a===u&&(await Ne(),G(!1))}catch(l){console.error(`Error removing ${a} key:`,l)}finally{x(!1)}},Le=a=>{ne(a.target.value),de(!1)},$e=async()=>{const a=A.trim();if(!(!a||A===r.userName)){oe(!0);try{J&&J(a),de(!0)}finally{oe(!1)}}};let $="Save";_?$="Saving...":Ke&&($="Saved");const Be=a=>{ce(a.target.value),ue(!1)},Ye=async()=>{if(!(!k.trim()||k===r.title)){xe(!0);try{Q&&Q(k.trim()),ue(!0)}finally{xe(!1)}}};let B="Save";F?B="Saving...":Ee&&(B="Saved");const He=a=>{me(parseFloat(a.target.value)),ge(!1)},Xe=async()=>{if(S!==r.temperature){he(!0);try{V&&V(S),ge(!0)}finally{he(!1)}}};let Y="Save";return D?Y="Saving...":Oe&&(Y="Saved"),t.useEffect(()=>{fe()},[fe]),t.useEffect(()=>{Te()},[]),t.useEffect(()=>{(async()=>{s!==u&&(await N()||(d([]),f(!1)))})()},[re,se,le,ie,s,N]),t.useEffect(()=>{ne(r.userName??"User")},[r.userName]),t.useEffect(()=>{me(r.temperature),ce(r.title)},[r.temperature,r.title]),e.jsxs("div",{className:"w-full flex flex-col gap-3 bg-black/80 p-2 rounded-md",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("h2",{className:"text-gray-800 dark:text-gray-200",children:["Chat: ",e.jsx("b",{children:r.title})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Temperature: ",e.jsx("b",{children:r.temperature})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"user-name-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Your Name"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{id:"user-name-input",type:"text",value:A,onChange:Le,className:"flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border-gray-300",disabled:o||_,placeholder:"Enter your name",maxLength:64}),e.jsx("button",{onClick:$e,disabled:o||_||!A.trim()||A===r.userName,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:$})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"chat-title-input",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Chat Title"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{id:"chat-title-input",type:"text",value:k,onChange:Be,className:"flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border-gray-300",disabled:o||F,placeholder:"Enter a title for your chat",maxLength:128}),e.jsx("button",{onClick:Ye,disabled:o||F||!k.trim()||k===r.title,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:B})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{htmlFor:"temperature-slider",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 -mb-1 pt-1",children:["Temperature: ",S]}),e.jsxs("div",{className:"flex flex-row gap-0 items-center",children:[e.jsx("input",{id:"temperature-slider",type:"range",min:"0",max:"1",step:"0.01",value:S,onChange:He,className:"flex-1 max-w-xs h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 slider",disabled:o||D}),e.jsx("button",{onClick:Xe,disabled:o||D||S===r.temperature,className:"px-3 h-[34px] ml-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:Y})]}),e.jsxs("div",{className:"flex max-w-xs justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("span",{children:"0 (Focused)"}),e.jsx("span",{children:".5 (Balanced)"}),e.jsx("span",{children:"1 (Creative)"})]})]})]}),e.jsxs("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 pt-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"API Key Configuration"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"OpenAI API Key"}),re?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"✓ Configured"}),e.jsx("button",{onClick:()=>R(O),disabled:i,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"openai-key-input",type:"password",value:h,onChange:a=>ee(a.target.value),placeholder:"sk-...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${h&&!H(h)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:i}),e.jsx("button",{onClick:Ge,disabled:i||!h.trim()||!H(h),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:i?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"OpenAI Platform"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Google AI API Key"}),se?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"✓ Configured"}),e.jsx("button",{onClick:()=>R(C),disabled:i,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"google-key-input",type:"password",value:g,onChange:a=>ae(a.target.value),placeholder:"AI...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${g&&!X(g)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:i}),e.jsx("button",{onClick:_e,disabled:i||!g.trim()||!X(g),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:i?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Google AI Studio"})]})]}),e.jsxs("div",{className:"mt-4 mb-2",children:[e.jsx("span",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"OpenRouter API Key"}),ie?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"✓ Configured"}),e.jsx("button",{onClick:()=>R(u),disabled:i,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Remove"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"openrouter-key-input",type:"password",value:p,onChange:a=>te(a.target.value),placeholder:"sk-or-...",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${p&&!z(p)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:i}),e.jsx("button",{onClick:De,disabled:i||!p.trim()||!z(p),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:i?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Get your key from"," ",e.jsx("a",{href:"https://openrouter.ai/keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"OpenRouter"}),". ","Access hundreds of AI models through one API."]})]}),e.jsxs("div",{className:"mt-4 mb-2",children:[e.jsxs("p",{className:"flex gap-2 text-xs font-medium text-gray-600 dark:text-gray-400 my-1",children:["Ollama Server URL"," ",e.jsx("a",{href:c.trim(),target:"_blank",rel:"noopener noreferrer",className:"block mb-2 text-xs underline text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400",children:e.jsx("i",{children:c.trim()})})]}),le?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:"✓ Configured"}),e.jsx("button",{onClick:()=>R(E),disabled:i,className:"text-xs text-red-600 dark:text-red-400 hover:underline disabled:opacity-50",children:"Edit"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"ollama-url-input",type:"url",value:c,onChange:a=>Ie(a.target.value),placeholder:"http://localhost:11434",className:`flex-1 max-w-xs text-xs p-2 border rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 ${c&&!q(c)?"border-red-300 dark:border-red-500":"border-gray-300"}`,disabled:i}),e.jsx("button",{onClick:Fe,disabled:i||!c.trim()||!q(c),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 w-16 cursor-pointer",children:i?"...":"Save"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Local Ollama server URL. Install Ollama from"," ",e.jsx("a",{href:"https://ollama.ai",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"ollama.ai"})]})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-start gap-2 mb-2",children:e.jsx("label",{htmlFor:"provider-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI Provider"})}),e.jsxs("select",{id:"provider-select",value:s,onChange:a=>Ue(a.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:o,children:[e.jsx("option",{value:E,children:"Ollama (Local Models)"}),e.jsx("option",{value:u,children:"OpenRouter (Multiple Providers)"}),e.jsx("option",{value:O,children:"OpenAI (GPT Models)"}),e.jsx("option",{value:C,children:"Google AI (Gemini Models)"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Current: ",Re()]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 mb-2",children:[e.jsx("label",{htmlFor:"model-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Model"}),pe(n)==="premium"&&e.jsx("span",{title:"Premium models may be more expensive",className:"cursor-help text-amber-600 dark:text-amber-400",children:"⚡ Premium"}),pe(n)==="free"&&e.jsx("span",{title:"Free tier model",className:"cursor-help text-green-600 dark:text-green-400",children:"🆓 Free"})]}),e.jsx("select",{id:"model-select",value:n,onChange:a=>Me(a.target.value),className:"w-full max-w-xs p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",disabled:o||w.length===0,children:w.length===0?e.jsx("option",{value:"",children:"No models available - Configure API key first"}):w.map(a=>e.jsx("option",{value:a,children:Pe(a)},a))}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex gap-2 mt-3",children:e.jsxs("div",{className:"flex flex-row items-start gap-5",children:[w.length>0?e.jsxs("button",{onClick:()=>{P||I()},disabled:o||P,className:"flex items-center justify-center gap-1 cursor-pointer text-xs text-blue-600 dark:text-blue-400 hover:underline disabled:opacity-50",title:"Refresh available models",children:[e.jsx(Ze,{size:16}),e.jsx("span",{children:P?"Refreshing...":"Refresh list"})]}):e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s===u?"Models are loading...":"Configure an API key above to load models"}),Se&&w.length>0&&e.jsxs("span",{title:"Models list loaded from cache, might be outdated",className:"cursor-help flex items-center justify-center gap-1 text-blue-600 dark:text-blue-400",children:[e.jsx(Ve,{size:16})," Cached models"]})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(We,{onClick:Ae,className:"bg-yellow-500 hover:bg-yellow-600 text-white",disabled:o,children:"Test API Connection"})}),W&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:W}),e.jsx("button",{onClick:je,className:"cursor-pointer mt-2 text-sm hover:underline no-underline",children:"Clear Error"})]})]})}export{ta as default};
